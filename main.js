/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => HabitTrackerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/habitView.ts
var import_obsidian = require("obsidian");
var VIEW_TYPE_HABIT_TRACKER = "habit-tracker-view";
var HabitTrackerView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.selectedHabit = null;
    // Default to today view so the UI opens on the Today's overview by default
    this.viewType = "today";
    this.selectedMonth = /* @__PURE__ */ new Date();
    this.selectedYear = (/* @__PURE__ */ new Date()).getFullYear();
    // months the user has "unlocked" (clicked) in the Year Overview so they become active
    this.unlockedMonths = /* @__PURE__ */ new Set();
    this.plugin = plugin;
    this.selectedMonth.setDate(1);
  }
  getViewType() {
    return VIEW_TYPE_HABIT_TRACKER;
  }
  getDisplayText() {
    return "Habit Tracker";
  }
  getIcon() {
    return "calendar-check";
  }
  async onOpen() {
    await this.render();
  }
  async render() {
    console.log("RENDER START: selectedHabit =", this.selectedHabit, "Type:", typeof this.selectedHabit);
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("habit-tracker-container");
    const controlsEl = this.renderControls(container);
    const contentWrapper = container.createEl("div", { cls: "habit-content" });
    const applyOffset = () => {
      try {
        const h = controlsEl.getBoundingClientRect().height || 0;
        const offset = Math.max(4, Math.ceil(h * 0.4));
        contentWrapper.style.marginTop = `${offset}px`;
        contentWrapper.style.transition = "margin-top 120ms ease";
      } catch (e) {
      }
    };
    requestAnimationFrame(applyOffset);
    window.addEventListener("resize", applyOffset);
    const habits = this.plugin.dataStore.getHabits();
    console.log("RENDER: Habits from store =", habits);
    if (habits.length === 0) {
      container.createEl("div", {
        text: 'No habits yet. Click "Add New Habit" to get started!',
        cls: "no-habits-message"
      });
      console.log("RENDER: No habits, exiting.");
      return;
    }
    if (!this.selectedHabit || !habits.includes(this.selectedHabit)) {
      if (habits.length > 0) {
        this.selectedHabit = habits[0];
      } else {
        this.selectedHabit = null;
        container.createEl("div", {
          text: 'No habits yet. Click "Add New Habit" to get started!',
          cls: "no-habits-message"
        });
        return;
      }
    }
    if (this.viewType === "year") {
      this.renderYearView(contentWrapper);
    } else if (this.viewType === "month") {
      this.renderMonthView(contentWrapper);
    } else if (this.viewType === "today") {
      this.renderTodayView(contentWrapper);
    } else if (this.viewType === "year-overview") {
      this.renderYearOverview(contentWrapper, this.selectedHabit || (this.plugin.dataStore.getHabits()[0] || ""));
    }
  }
  renderTodayView(container) {
    const habits = this.plugin.dataStore.getHabits();
    if (!habits || habits.length === 0)
      return;
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    const dayOfWeek = (today.getDay() + 6) % 7;
    const monday = new Date(today);
    monday.setDate(today.getDate() - dayOfWeek);
    const weekDates = [];
    for (let i = 0; i < 7; i++) {
      const d = new Date(monday);
      d.setDate(monday.getDate() + i);
      weekDates.push(d);
    }
    const todayStr = this.formatDate(today);
    const todaySection = container.createEl("div", { cls: "today-overview" });
    const header = todaySection.createEl("h2", { text: "Today", cls: "today-title" });
    const cardsContainer = todaySection.createEl("div", { cls: "today-cards-container" });
    habits.forEach((habit) => {
      let weekCount = 0;
      weekDates.forEach((d) => {
        if (this.plugin.dataStore.isHabitCompleted(habit, this.formatDate(d)))
          weekCount++;
      });
      const card = cardsContainer.createEl("div", { cls: "today-card habit-section" });
      const left = card.createEl("div", { cls: "today-card-left" });
      left.createEl("div", { text: String(weekCount), cls: "today-count-number" });
      left.createEl("div", { text: weekCount === 1 ? "DAY" : "DAYS", cls: "today-count-label" });
      const right = card.createEl("div", { cls: "today-card-right" });
      const checkBtn = right.createEl("button", { cls: "today-check-button" });
      const isTodayCompleted = this.plugin.dataStore.isHabitCompleted(habit, todayStr);
      checkBtn.createEl("span", { text: isTodayCompleted ? "\u2713" : "", cls: "today-check-mark" });
      if (isTodayCompleted)
        checkBtn.addClass("active");
      const habitColor = this.plugin.dataStore.getHabitColor(habit);
      if (habitColor) {
        if (isTodayCompleted) {
          card.addClass("active-today");
          card.style.background = this.hexToRgba(habitColor, 0.12);
          card.style.color = this.getContrastColor(habitColor);
          checkBtn.style.backgroundColor = habitColor;
          checkBtn.classList.add("active");
          checkBtn.style.boxShadow = `0 8px 20px ${this.hexToRgba(habitColor, 0.18)}`;
        }
      } else {
        if (isTodayCompleted) {
          card.addClass("active-today");
        }
      }
      checkBtn.addEventListener("click", async () => {
        this.plugin.dataStore.toggleHabit(habit, todayStr);
        await this.render();
      });
      const middle = card.createEl("div", { cls: "today-card-middle" });
      middle.createEl("div", { text: habit, cls: "today-habit-name" });
      const weekRow = middle.createEl("div", { cls: "today-week-row" });
      const dayLabels = ["M", "T", "W", "T", "F", "S", "S"];
      weekDates.forEach((d, idx) => {
        const dStr = this.formatDate(d);
        const sq = weekRow.createEl("div", { cls: "today-week-square" });
        const label = dayLabels[idx] || "";
        sq.createEl("span", { text: label, cls: "today-week-initial" });
        const completed = this.plugin.dataStore.isHabitCompleted(habit, dStr);
        if (completed) {
          sq.addClass("completed");
          if (habitColor) {
            sq.style.backgroundColor = habitColor;
            sq.style.boxShadow = `0 6px 14px ${this.hexToRgba(habitColor, 0.14)}`;
          }
        }
        if (this.isSameDay(d, today)) {
          sq.addClass("today");
          if (!completed && habitColor) {
            sq.style.backgroundColor = this.hexToRgba(habitColor, 0.12);
            sq.style.outline = `2px solid ${this.hexToRgba(habitColor, 0.18)}`;
          }
        }
      });
      middle.createEl("div", { text: `${weekCount}/7`, cls: "today-week-count" });
    });
  }
  renderControls(container) {
    const controlsSection = container.createEl("div", { cls: "habit-controls" });
    const addButton = controlsSection.createEl("button", {
      text: "Add",
      cls: "habit-control-button"
    });
    addButton.addEventListener("click", () => {
      new AddHabitModal(this.app, this.plugin, async () => {
        await this.render();
      }).open();
    });
    const habits = this.plugin.dataStore.getHabits();
    if (habits.length > 0) {
      const selectorContainer = controlsSection.createEl("div", { cls: "habit-selector-container" });
      const customDropdown = selectorContainer.createEl("div", { cls: "custom-habit-dropdown" });
      const dropdownButton = customDropdown.createEl("button", { cls: "habit-dropdown-button" });
      dropdownButton.createEl("span", { text: this.selectedHabit || "Select Habit", cls: "habit-dropdown-text" });
      dropdownButton.createEl("span", { text: "\u25BC", cls: "habit-dropdown-arrow" });
      const dropdownMenu = customDropdown.createEl("div", { cls: "habit-dropdown-menu" });
      habits.forEach((habit) => {
        const item = dropdownMenu.createEl("div", { cls: "habit-dropdown-item" });
        if (habit === this.selectedHabit) {
          item.addClass("active");
        }
        const habitText = item.createEl("span", { text: habit, cls: "habit-item-text" });
        item.addEventListener("click", async (e) => {
          e.stopPropagation();
          this.selectedHabit = habit;
          dropdownMenu.removeClass("show");
          await this.render();
        });
        habitText.style.pointerEvents = "none";
      });
      dropdownButton.addEventListener("click", (e) => {
        e.stopPropagation();
        const isShown = dropdownMenu.hasClass("show");
        if (isShown) {
          dropdownMenu.removeClass("show");
        } else {
          dropdownMenu.addClass("show");
        }
      });
      this.registerDomEvent(document, "click", (e) => {
        if (!customDropdown.contains(e.target)) {
          dropdownMenu.removeClass("show");
        }
      });
      console.log("Rendering Edit Button. selectedHabit:", this.selectedHabit, "Type:", typeof this.selectedHabit);
      const editButton = controlsSection.createEl("button", {
        text: "Edit",
        cls: "habit-control-button"
      });
      editButton.disabled = !this.selectedHabit;
      editButton.addEventListener("click", () => {
        if (this.selectedHabit) {
          new EditHabitModal(this.app, this.plugin, this.selectedHabit, async (newName) => {
            this.selectedHabit = newName;
            await this.render();
          }).open();
        }
      });
      const deleteButton = controlsSection.createEl("button", {
        text: "Delete",
        cls: "habit-control-button"
      });
      deleteButton.disabled = !this.selectedHabit;
      deleteButton.addEventListener("click", () => {
        if (this.selectedHabit) {
          new DeleteHabitModal(this.app, this.plugin, this.selectedHabit, async () => {
            this.selectedHabit = null;
            await this.render();
          }).open();
        }
      });
      const viewControlsContainer = controlsSection.createEl("div", { cls: "view-controls-container" });
      const radioGroup = viewControlsContainer.createEl("div", { cls: "view-radio-group" });
      const viewOptions = [
        { value: "today", text: "Today", title: "Today's habits overview" },
        { value: "month", text: "Month", title: "Traditional monthly calendar" },
        { value: "year-overview", text: "Year", title: "All 12 months at a glance" },
        { value: "year", text: "All", title: "GitHub-style contribution grid" }
      ];
      viewOptions.forEach((option) => {
        const radioLabel = radioGroup.createEl("label", { cls: "view-radio-label" });
        if (option.value === "year-overview") {
          radioLabel.addClass("view-radio-year-overview");
        }
        const radioInput = radioLabel.createEl("input", {
          type: "radio",
          attr: {
            name: "view-type",
            value: option.value
          },
          cls: "view-radio-input"
        });
        if (option.value === this.viewType) {
          radioInput.checked = true;
        }
        radioInput.addEventListener("change", async () => {
          if (radioInput.checked) {
            this.viewType = option.value;
            await this.render();
          }
        });
        radioLabel.createEl("span", { text: option.text, cls: "view-radio-text" });
        radioLabel.setAttribute("title", option.title);
      });
    }
    const controlsRight = controlsSection.createEl("div", { cls: "controls-right" });
    controlsRight.style.marginLeft = "auto";
    const settingsBtn = controlsRight.createEl("button", {
      cls: "habit-settings-button",
      attr: { type: "button", title: "Settings" }
    });
    settingsBtn.setAttr("aria-label", "Settings");
    try {
      (0, import_obsidian.setIcon)(settingsBtn, "settings");
    } catch (e) {
      settingsBtn.setText("\u2699");
    }
    const settingsMenu = controlsSection.createEl("div", { cls: "settings-menu" });
    settingsMenu.createEl("div", { text: "Export Data", cls: "settings-menu-item" });
    settingsMenu.createEl("div", { text: "Import Data", cls: "settings-menu-item" });
    settingsMenu.createEl("div", { text: "Preferences", cls: "settings-menu-item" });
    settingsMenu.createEl("div", { text: "About", cls: "settings-menu-item" });
    settingsMenu.addClass("hidden");
    settingsBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      if (settingsMenu.hasClass("hidden")) {
        settingsMenu.removeClass("hidden");
        settingsMenu.addClass("show");
      } else {
        settingsMenu.addClass("hidden");
        settingsMenu.removeClass("show");
      }
    });
    this.registerDomEvent(document, "click", (e) => {
      if (!controlsSection.contains(e.target)) {
        settingsMenu.addClass("hidden");
        settingsMenu.removeClass("show");
      }
    });
    Array.from(settingsMenu.children).forEach((child) => {
      child.addEventListener("click", async (e) => {
        e.stopPropagation();
        const txt = child.innerText.trim();
        settingsMenu.addClass("hidden");
        settingsMenu.removeClass("show");
        if (txt === "Export Data") {
          if (this.plugin && typeof this.plugin.exportData === "function") {
            this.plugin.exportData();
          } else {
            console.log("Export Data clicked");
          }
        } else if (txt === "Import Data") {
          if (this.plugin && typeof this.plugin.importData === "function") {
            this.plugin.importData();
          } else {
            console.log("Import Data clicked");
          }
        } else if (txt === "Preferences") {
          try {
            const appAny = this.app;
            const pluginId = this.plugin && this.plugin.manifest && this.plugin.manifest.id ? this.plugin.manifest.id : void 0;
            if (appAny && typeof appAny.openSettingTab === "function") {
              if (pluginId) {
                try {
                  appAny.openSettingTab(pluginId);
                } catch (e2) {
                  appAny.openSettingTab();
                }
              } else {
                appAny.openSettingTab();
              }
            } else {
              console.log("Preferences clicked - openSettingTab not available");
            }
          } catch (e2) {
            console.log("Error opening preferences", e2);
          }
        } else if (txt === "About") {
          new import_obsidian.Modal(this.app).open();
        }
      });
    });
    return controlsSection;
  }
  renderYearView(container, habitName) {
    const habitsToRender = habitName ? [habitName] : this.plugin.dataStore.getHabits();
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    habitsToRender.forEach((habit) => {
      const section = container.createEl("div", { cls: "habit-section github-style" });
      const header = section.createEl("div", { cls: "github-header" });
      header.createEl("div", { text: habit, cls: "habit-name" });
      const headerYearSelector = header.createEl("div", { cls: "github-year-selector" });
      const yearContainer = section.createEl("div", { cls: "github-year-container" });
      const graphContainer = yearContainer.createEl("div", { cls: "github-graph-container" });
      const grid = graphContainer.createEl("div", { cls: "github-square-grid" });
      const startDate = new Date(this.selectedYear, 0, 1);
      const today = /* @__PURE__ */ new Date();
      today.setHours(0, 0, 0, 0);
      const buildGrid = () => {
        grid.empty();
        const CELL_PX = 12;
        const GAP_PX = 3;
        const containerWidth = Math.max(0, graphContainer.getBoundingClientRect().width || 0);
        let cols = containerWidth > 0 ? Math.floor((containerWidth + GAP_PX) / (CELL_PX + GAP_PX)) : 30;
        cols = Math.min(Math.max(cols, 7), 60);
        const daysInYear = (new Date(this.selectedYear + 1, 0, 1).getTime() - new Date(this.selectedYear, 0, 1).getTime()) / (24 * 60 * 60 * 1e3);
        const rows = Math.max(1, Math.ceil(daysInYear / cols));
        grid.style.gridTemplateColumns = `repeat(${cols}, ${CELL_PX}px)`;
        grid.style.gridTemplateRows = `repeat(${rows}, ${CELL_PX}px)`;
        grid.style.gap = `${GAP_PX}px`;
        grid.style.justifyContent = "start";
        grid.style.alignContent = "start";
        const totalCells = rows * cols;
        for (let i = 0; i < totalCells; i++) {
          const currentDate = new Date(startDate);
          currentDate.setDate(startDate.getDate() + i);
          const dateStr = this.formatDate(currentDate);
          const cell = grid.createEl("div", { cls: "github-cell" });
          const row = Math.floor(i / cols) + 1;
          const col = i % cols + 1;
          cell.style.gridColumn = `${col}`;
          cell.style.gridRow = `${row}`;
          if (currentDate.getFullYear() !== this.selectedYear) {
            cell.addClass("outside-year");
          } else {
            const isCompleted = this.plugin.dataStore.isHabitCompleted(habit, dateStr);
            const habitColor = this.plugin.dataStore.getHabitColor(habit);
            if (isCompleted) {
              cell.addClass("completed");
              if (habitColor) {
                cell.style.backgroundColor = habitColor;
              }
            }
            if (this.isSameDay(currentDate, today)) {
              cell.addClass("today");
              if (!isCompleted && habitColor) {
                cell.style.backgroundColor = this.hexToRgba(habitColor, 0.12);
                cell.style.outline = `2px solid ${this.hexToRgba(habitColor, 0.18)}`;
              }
            }
            cell.setAttribute("data-date", dateStr);
            cell.setAttribute("title", `${habit} - ${dateStr}`);
            cell.addEventListener("click", () => {
              const newState = this.plugin.dataStore.toggleHabit(habit, dateStr);
              if (newState) {
                cell.addClass("completed");
                if (habitColor)
                  cell.style.backgroundColor = habitColor;
              } else {
                cell.removeClass("completed");
                cell.style.backgroundColor = "";
                cell.style.outline = "";
              }
            });
          }
        }
      };
      requestAnimationFrame(buildGrid);
      this.registerDomEvent(window, "resize", () => requestAnimationFrame(buildGrid));
      try {
        const prevRO = graphContainer.__yearGridRO;
        if (prevRO && typeof prevRO.disconnect === "function") {
          try {
            prevRO.disconnect();
          } catch (e) {
          }
        }
        const ro = new ResizeObserver(() => {
          requestAnimationFrame(buildGrid);
        });
        ro.observe(graphContainer);
        graphContainer.__yearGridRO = ro;
      } catch (e) {
      }
      const earliestYear = this.getEarliestYearWithData(habit);
      const startYear = Math.min(earliestYear, currentYear);
      for (let year = startYear; year <= currentYear; year++) {
        const yearButton = headerYearSelector.createEl("button", {
          text: year.toString(),
          cls: "github-year-button"
        });
        if (year === this.selectedYear) {
          yearButton.addClass("active");
        }
        if (year === currentYear) {
          yearButton.addClass("current-year");
        }
        yearButton.addEventListener("click", async () => {
          this.selectedYear = year;
          await this.render();
        });
      }
    });
  }
  renderMonthView(container, habitName) {
    const habitsToRender = habitName ? [habitName] : this.plugin.dataStore.getHabits();
    if (!("habitMonths" in this)) {
      this.habitMonths = /* @__PURE__ */ new Map();
    }
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    habitsToRender.forEach((habit) => {
      const section = container.createEl("div", { cls: "habit-section calendar-view" });
      const habitMonths = this.habitMonths;
      if (!habitMonths.has(habit)) {
        habitMonths.set(habit, new Date(this.selectedMonth));
      }
      const habitMonth = new Date(habitMonths.get(habit));
      const headerRow = section.createEl("div", { cls: "calendar-header" });
      const headerLeft = headerRow.createEl("div", { cls: "calendar-header-left" });
      headerLeft.createEl("div", { text: habit, cls: "habit-name calendar-habit-name" });
      const monthNavInline = headerRow.createEl("div", { cls: "calendar-header-title month-nav-inline" });
      const prevBtn = monthNavInline.createEl("button", { text: "\u25C0", cls: "month-nav-button" });
      const monthLabel = monthNavInline.createEl("div", { text: habitMonth.toLocaleDateString("en-US", { month: "long", year: "numeric" }), cls: "calendar-month-title" });
      const nextBtn = monthNavInline.createEl("button", { text: "\u25B6", cls: "month-nav-button" });
      prevBtn.addEventListener("click", async () => {
        const m = new Date(habitMonth);
        m.setMonth(m.getMonth() - 1);
        habitMonths.set(habit, m);
        await this.render();
      });
      nextBtn.addEventListener("click", async () => {
        const m = new Date(habitMonth);
        m.setMonth(m.getMonth() + 1);
        habitMonths.set(habit, m);
        await this.render();
      });
      const calendar = section.createEl("div", { cls: "calendar-month" });
      const weekDays = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
      const weekDayHeader = calendar.createEl("div", { cls: "calendar-weekdays" });
      weekDays.forEach((day) => {
        weekDayHeader.createEl("div", { text: day, cls: "calendar-weekday" });
      });
      const daysGrid = calendar.createEl("div", { cls: "calendar-days-grid" });
      const year = habitMonth.getFullYear();
      const month = habitMonth.getMonth();
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const startingDayOfWeek = (firstDay.getDay() + 6) % 7;
      for (let i = 0; i < startingDayOfWeek; i++) {
        daysGrid.createEl("div", { cls: "calendar-day empty" });
      }
      for (let day = 1; day <= lastDay.getDate(); day++) {
        const currentDate = new Date(year, month, day);
        const dateStr = this.formatDate(currentDate);
        const dayCell = daysGrid.createEl("div", { cls: "calendar-day" });
        dayCell.createEl("div", { text: day.toString(), cls: "calendar-day-number" });
        const isCompleted = this.plugin.dataStore.isHabitCompleted(habit, dateStr);
        const habitColor = this.plugin.dataStore.getHabitColor(habit);
        if (isCompleted) {
          dayCell.addClass("completed");
          if (habitColor) {
            dayCell.style.backgroundColor = habitColor;
            const num = dayCell.querySelector(".calendar-day-number");
            if (num)
              num.style.color = this.getContrastColor(habitColor);
          }
        }
        if (this.isSameDay(currentDate, today)) {
          dayCell.addClass("today");
          if (!isCompleted && habitColor) {
            dayCell.style.backgroundColor = this.hexToRgba(habitColor, 0.12);
            dayCell.style.outline = `2px solid ${this.hexToRgba(habitColor, 0.18)}`;
            const num = dayCell.querySelector(".calendar-day-number");
            if (num)
              num.style.color = this.getContrastColor(habitColor);
          }
        }
        dayCell.setAttribute("data-date", dateStr);
        dayCell.setAttribute("title", `${habit} - ${dateStr}`);
        dayCell.addEventListener("click", () => {
          const newState = this.plugin.dataStore.toggleHabit(habit, dateStr);
          if (newState) {
            dayCell.addClass("completed");
            if (habitColor) {
              dayCell.style.backgroundColor = habitColor;
              const num = dayCell.querySelector(".calendar-day-number");
              if (num)
                num.style.color = this.getContrastColor(habitColor);
            }
          } else {
            dayCell.removeClass("completed");
            dayCell.style.backgroundColor = "";
            dayCell.style.outline = "";
            const num = dayCell.querySelector(".calendar-day-number");
            if (num)
              num.style.color = "";
          }
        });
      }
    });
  }
  renderYearOverview(container, habitName) {
    const section = container.createEl("div", { cls: "habit-section year-overview" });
    const header = section.createEl("div", { cls: "year-overview-header" });
    const headerLeft = header.createEl("div", { cls: "year-overview-header-left" });
    headerLeft.createEl("div", { text: habitName, cls: "habit-name" });
    const habitNav = headerLeft.createEl("div", { cls: "habit-year-nav" });
    const habits = this.plugin.dataStore.getHabits();
    const currentIndex = habits.indexOf(habitName);
    const prevHabitBtn = habitNav.createEl("button", { text: "\u25C0", cls: "habit-nav-button" });
    prevHabitBtn.disabled = currentIndex <= 0;
    prevHabitBtn.addEventListener("click", async () => {
      if (currentIndex > 0) {
        this.selectedHabit = habits[currentIndex - 1];
        await this.render();
      }
    });
    const nextHabitBtn = habitNav.createEl("button", { text: "\u25B6", cls: "habit-nav-button" });
    nextHabitBtn.disabled = currentIndex === -1 || currentIndex >= habits.length - 1;
    nextHabitBtn.addEventListener("click", async () => {
      if (currentIndex === -1)
        return;
      if (currentIndex < habits.length - 1) {
        this.selectedHabit = habits[currentIndex + 1];
        await this.render();
      }
    });
    header.createEl("div", { text: String(this.selectedYear), cls: "year-overview-year-label" });
    const yearContainer = section.createEl("div", { cls: "year-overview-container" });
    const yearGrid = yearContainer.createEl("div", { cls: "year-overview-grid" });
    const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    const currentMonth = (/* @__PURE__ */ new Date()).getMonth();
    const isCurrentYear = this.selectedYear === currentYear;
    const lastMonth = isCurrentYear ? currentMonth : 11;
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    const todayDate = today.getDate();
    for (let month = 0; month < 12; month++) {
      const monthContainer = yearGrid.createEl("div", { cls: "year-overview-month" });
      monthContainer.createEl("div", { text: monthNames[month], cls: "year-overview-month-name" });
      const monthDays = monthContainer.createEl("div", { cls: "year-overview-days" });
      const daysInMonth = new Date(this.selectedYear, month + 1, 0).getDate();
      const isCurrentMonth = isCurrentYear && month === currentMonth;
      const lastDay = isCurrentMonth ? todayDate : daysInMonth;
      const firstOfMonth = new Date(this.selectedYear, month, 1);
      const startingDayOfWeek = (firstOfMonth.getDay() + 6) % 7;
      for (let day = 1; day <= lastDay; day++) {
        const currentDate = new Date(this.selectedYear, month, day);
        const dateStr = this.formatDate(currentDate);
        const dayCell = monthDays.createEl("div", { cls: "year-overview-day" });
        const offset = startingDayOfWeek + (day - 1);
        const col = offset % 7 + 1;
        const row = Math.floor(offset / 7) + 1;
        dayCell.style.gridColumn = `${col}`;
        dayCell.style.gridRow = `${row}`;
        const isCompleted = this.plugin.dataStore.isHabitCompleted(habitName, dateStr);
        const habitColor = this.plugin.dataStore.getHabitColor(habitName);
        if (isCompleted) {
          dayCell.addClass("completed");
          if (habitColor) {
            dayCell.style.backgroundColor = habitColor;
          }
        }
        if (this.isSameDay(currentDate, today)) {
          dayCell.addClass("today");
          if (!isCompleted && habitColor) {
            dayCell.style.backgroundColor = this.hexToRgba(habitColor, 0.12);
            dayCell.style.outline = `2px solid ${this.hexToRgba(habitColor, 0.18)}`;
          }
        }
        dayCell.setAttribute("data-date", dateStr);
        dayCell.setAttribute("title", `${habitName} - ${dateStr}`);
        dayCell.addEventListener("click", () => {
          const newState = this.plugin.dataStore.toggleHabit(habitName, dateStr);
          if (newState) {
            dayCell.addClass("completed");
            if (habitColor)
              dayCell.style.backgroundColor = habitColor;
          } else {
            dayCell.removeClass("completed");
            dayCell.style.backgroundColor = "";
            dayCell.style.outline = "";
          }
        });
      }
    }
    for (let m = 0; m < 12; m++) {
      const mc = yearGrid.children[m];
      if (!mc)
        continue;
      const isFuture = isCurrentYear && m > currentMonth;
      if (isFuture && !this.unlockedMonths.has(m)) {
        mc.addClass("upcoming");
      }
      mc.addEventListener("click", async (e) => {
        if (isCurrentYear && m > currentMonth) {
          this.unlockedMonths.add(m);
        }
        this.selectedMonth.setMonth(m);
        this.selectedYear = this.selectedYear;
        await this.render();
      });
    }
  }
  formatDate(date) {
    return date.toISOString().split("T")[0];
  }
  hexToRgb(hex) {
    const clean = hex.replace("#", "").trim();
    if (clean.length === 3) {
      const r = parseInt(clean[0] + clean[0], 16);
      const g = parseInt(clean[1] + clean[1], 16);
      const b = parseInt(clean[2] + clean[2], 16);
      return { r, g, b };
    }
    if (clean.length === 6) {
      const r = parseInt(clean.slice(0, 2), 16);
      const g = parseInt(clean.slice(2, 4), 16);
      const b = parseInt(clean.slice(4, 6), 16);
      return { r, g, b };
    }
    return null;
  }
  hexToRgba(hex, alpha = 1) {
    const rgb = this.hexToRgb(hex);
    if (!rgb)
      return hex;
    return `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${alpha})`;
  }
  getContrastColor(hex) {
    const rgb = this.hexToRgb(hex);
    if (!rgb)
      return "#fff";
    const r = rgb.r / 255;
    const g = rgb.g / 255;
    const b = rgb.b / 255;
    const l = 0.2126 * r + 0.7152 * g + 0.0722 * b;
    return l > 0.6 ? "#000" : "#fff";
  }
  isSameDay(date1, date2) {
    return date1.getFullYear() === date2.getFullYear() && date1.getMonth() === date2.getMonth() && date1.getDate() === date2.getDate();
  }
  getEarliestYearWithData(habitName) {
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    const habitData = this.plugin.dataStore.getData()[habitName];
    if (!habitData || typeof habitData !== "object" || Array.isArray(habitData)) {
      return currentYear;
    }
    const dates = Object.keys(habitData);
    if (dates.length === 0) {
      return currentYear;
    }
    let earliestYear = currentYear;
    dates.forEach((dateStr) => {
      const year = parseInt(dateStr.split("-")[0]);
      if (year < earliestYear) {
        earliestYear = year;
      }
    });
    return earliestYear;
  }
  async onClose() {
  }
};
var AddHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Add" });
    let habitName = "";
    const COLORS = ["#0A84FF", "#26A641", "#FF3B30", "#FF9F0A", "#AF52DE", "#5AC8FA", "#FF2D55"];
    let selectedColor = COLORS[0];
    new import_obsidian.Setting(contentEl).setName("Habit Name").setDesc("Enter the name of your new habit").addText((text) => {
      text.setPlaceholder("e.g., Exercise, Read, Meditate").onChange((value) => {
        habitName = value;
      });
      text.inputEl.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          this.submit(habitName);
        }
      });
      setTimeout(() => text.inputEl.focus(), 10);
    });
    const colorSetting = new import_obsidian.Setting(contentEl).setName("Color").setDesc("Pick a color for this habit").addButton(() => {
    });
    const swatchContainer = contentEl.createEl("div", { cls: "habit-color-swatches" });
    COLORS.forEach((c) => {
      const sw = swatchContainer.createEl("button", { cls: "color-swatch" });
      sw.setAttr("type", "button");
      sw.style.backgroundColor = c;
      if (c === selectedColor)
        sw.addClass("selected");
      sw.addEventListener("click", () => {
        selectedColor = c;
        swatchContainer.querySelectorAll(".color-swatch").forEach((s) => s.classList.remove("selected"));
        sw.classList.add("selected");
      });
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Add").setCta().onClick(() => {
      this.submit(habitName, selectedColor);
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  async submit(habitName, color) {
    const trimmedName = habitName ? habitName.trim() : "";
    if (!trimmedName) {
      return;
    }
    const success = this.plugin.dataStore.addHabit(trimmedName);
    if (success) {
      if (color) {
        this.plugin.dataStore.setHabitColor(trimmedName, color);
      }
      this.close();
      await this.onSubmit();
    } else {
      const errorEl = this.contentEl.createEl("div", {
        text: "This habit already exists or the name is invalid!",
        cls: "habit-error-message"
      });
      setTimeout(() => errorEl.remove(), 3e3);
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var EditHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, oldName, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.oldName = oldName;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Edit Habit" });
    let habitName = this.oldName;
    new import_obsidian.Setting(contentEl).setName("Habit Name").setDesc("Enter the new name for your habit").addText((text) => {
      text.setValue(this.oldName).setPlaceholder("e.g., Exercise, Read, Meditate").onChange((value) => {
        habitName = value;
      });
      text.inputEl.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          this.submit(habitName);
        }
      });
      setTimeout(() => {
        text.inputEl.focus();
        text.inputEl.select();
      }, 10);
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Save").setCta().onClick(() => {
      this.submit(habitName);
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  async submit(habitName) {
    if (!habitName.trim() || habitName === this.oldName) {
      this.close();
      return;
    }
    const success = this.plugin.dataStore.renameHabit(this.oldName, habitName);
    if (success) {
      this.close();
      await this.onSubmit(habitName);
    } else {
      const errorEl = this.contentEl.createEl("div", {
        text: "This habit name already exists or is invalid!",
        cls: "habit-error-message"
      });
      setTimeout(() => errorEl.remove(), 3e3);
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var DeleteHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, habitName, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.habitName = habitName;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Delete Habit" });
    contentEl.createEl("p", {
      text: `Are you sure you want to delete "${this.habitName}"? This will remove all progress data for this habit.`
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Delete").setWarning().onClick(async () => {
      this.plugin.dataStore.removeHabit(this.habitName);
      this.close();
      await this.onSubmit();
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings.ts
var import_obsidian2 = require("obsidian");
var HabitTrackerSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Habit Tracker Settings" });
    new import_obsidian2.Setting(containerEl).setName("Habits File Path").setDesc("Path to the markdown file containing your list of habits (e.g., habits.md)").addText((text) => text.setPlaceholder("habits.md").setValue(this.plugin.settings.habitsFilePath).onChange(async (value) => {
      this.plugin.settings.habitsFilePath = value;
      await this.plugin.saveSettings();
      this.plugin.refreshView();
    }));
  }
};

// src/habitParser.ts
var import_obsidian3 = require("obsidian");
var HabitParser = class {
  constructor(app) {
    this.app = app;
  }
  async parseHabitsFromFile(filePath) {
    const file = this.app.vault.getAbstractFileByPath(filePath);
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      console.log(`Habits file not found: ${filePath}`);
      return [];
    }
    try {
      const content = await this.app.vault.read(file);
      const habits = this.extractHabits(content);
      return habits;
    } catch (error) {
      console.error("Error reading habits file:", error);
      return [];
    }
  }
  extractHabits(content) {
    const habits = [];
    const lines = content.split("\n");
    for (const line of lines) {
      const trimmedLine = line.trim();
      const checkboxMatch = trimmedLine.match(/^[-*]\s*\[[ x]\]\s*(.+)$/i);
      const listMatch = trimmedLine.match(/^[-*]\s+(.+)$/);
      const numberedMatch = trimmedLine.match(/^\d+\.\s+(.+)$/);
      if (checkboxMatch) {
        habits.push(checkboxMatch[1].trim());
      } else if (listMatch) {
        habits.push(listMatch[1].trim());
      } else if (numberedMatch) {
        habits.push(numberedMatch[1].trim());
      }
    }
    return habits;
  }
};

// src/dataStore.ts
var HabitDataStore = class {
  constructor(saveCallback) {
    this.data = {};
    this.saveCallback = saveCallback;
  }
  loadData(data) {
    this.data = data || {};
    if (!this.data.habits) {
      this.data.habits = [];
    }
    if (!this.data.colors) {
      this.data.colors = {};
    }
  }
  getData() {
    return this.data;
  }
  getHabits() {
    return this.data.habits || [];
  }
  addHabit(habitName) {
    const trimmedName = habitName.trim();
    if (!trimmedName)
      return false;
    if (!this.data.habits) {
      this.data.habits = [];
    }
    if (this.data.habits.includes(trimmedName)) {
      return false;
    }
    this.data.habits.push(trimmedName);
    this.data[trimmedName] = {};
    this.saveCallback();
    return true;
  }
  removeHabit(habitName) {
    if (!this.data.habits)
      return false;
    const index = this.data.habits.indexOf(habitName);
    if (index === -1)
      return false;
    this.data.habits.splice(index, 1);
    delete this.data[habitName];
    if (this.data.colors && this.data.colors[habitName]) {
      delete this.data.colors[habitName];
    }
    this.saveCallback();
    return true;
  }
  renameHabit(oldName, newName) {
    const trimmedNewName = newName.trim();
    if (!trimmedNewName || !this.data.habits)
      return false;
    const index = this.data.habits.indexOf(oldName);
    if (index === -1)
      return false;
    if (this.data.habits.includes(trimmedNewName)) {
      return false;
    }
    this.data.habits[index] = trimmedNewName;
    if (this.data[oldName]) {
      this.data[trimmedNewName] = this.data[oldName];
      delete this.data[oldName];
    }
    if (this.data.colors && this.data.colors[oldName]) {
      this.data.colors[trimmedNewName] = this.data.colors[oldName];
      delete this.data.colors[oldName];
    }
    this.saveCallback();
    return true;
  }
  toggleHabit(habitName, date) {
    if (!this.data[habitName]) {
      this.data[habitName] = {};
    }
    const habitData = this.data[habitName];
    const currentValue = habitData[date] || false;
    habitData[date] = !currentValue;
    this.saveCallback();
    return habitData[date];
  }
  getHabitColor(habitName) {
    return this.data.colors ? this.data.colors[habitName] : void 0;
  }
  setHabitColor(habitName, color) {
    if (!this.data.colors)
      this.data.colors = {};
    this.data.colors[habitName] = color;
    this.saveCallback();
  }
  isHabitCompleted(habitName, date) {
    const habitData = this.data[habitName];
    if (typeof habitData === "object" && !Array.isArray(habitData)) {
      return habitData[date] || false;
    }
    return false;
  }
  getHabitStreak(habitName) {
    const habitData = this.data[habitName];
    if (!habitData || typeof habitData !== "object" || Array.isArray(habitData))
      return 0;
    let streak = 0;
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    for (let i = 0; i < 365; i++) {
      const checkDate = new Date(today);
      checkDate.setDate(today.getDate() - i);
      const dateStr = this.formatDate(checkDate);
      if (habitData[dateStr]) {
        streak++;
      } else {
        break;
      }
    }
    return streak;
  }
  formatDate(date) {
    return date.toISOString().split("T")[0];
  }
};

// src/types.ts
var DEFAULT_SETTINGS = {
  habitsFilePath: "habits.md"
};

// src/main.ts
var HabitTrackerPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.habitParser = new HabitParser(this.app);
    this.dataStore = new HabitDataStore(async () => {
      await this.saveHabitData();
    });
    const habitData = await this.loadData();
    this.dataStore.loadData(habitData || {});
    this.registerView(
      VIEW_TYPE_HABIT_TRACKER,
      (leaf) => new HabitTrackerView(leaf, this)
    );
    this.addRibbonIcon("calendar-check", "Open Habit Tracker", () => {
      this.activateView();
    });
    this.addCommand({
      id: "open-habit-tracker",
      name: "Open Habit Tracker",
      callback: () => {
        this.activateView();
      }
    });
    this.addSettingTab(new HabitTrackerSettingTab(this.app, this));
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_HABIT_TRACKER)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (rightLeaf) {
        await rightLeaf.setViewState({
          type: VIEW_TYPE_HABIT_TRACKER,
          active: true
        });
        leaf = rightLeaf;
      }
    }
    if (leaf) {
      workspace.revealLeaf(leaf);
    }
  }
  async refreshView() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_HABIT_TRACKER);
    for (const leaf of leaves) {
      const view = leaf.view;
      const currentHabits = this.dataStore.getHabits();
      const selectedHabit = view.selectedHabit;
      if (!selectedHabit || !currentHabits.includes(selectedHabit)) {
        await view.render();
      }
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await super.saveData(this.settings);
  }
  async saveHabitData() {
    await super.saveData(this.dataStore.getData());
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2hhYml0Vmlldy50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2hhYml0UGFyc2VyLnRzIiwgInNyYy9kYXRhU3RvcmUudHMiLCAic3JjL3R5cGVzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBIYWJpdFRyYWNrZXJWaWV3LCBWSUVXX1RZUEVfSEFCSVRfVFJBQ0tFUiB9IGZyb20gJy4vaGFiaXRWaWV3JztcbmltcG9ydCB7IEhhYml0VHJhY2tlclNldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IEhhYml0UGFyc2VyIH0gZnJvbSAnLi9oYWJpdFBhcnNlcic7XG5pbXBvcnQgeyBIYWJpdERhdGFTdG9yZSB9IGZyb20gJy4vZGF0YVN0b3JlJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEhhYml0VHJhY2tlclNldHRpbmdzLCBIYWJpdERhdGEgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGFiaXRUcmFja2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgc2V0dGluZ3M6IEhhYml0VHJhY2tlclNldHRpbmdzO1xuICBoYWJpdFBhcnNlcjogSGFiaXRQYXJzZXI7XG4gIGRhdGFTdG9yZTogSGFiaXREYXRhU3RvcmU7XG5cbiAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICB0aGlzLmhhYml0UGFyc2VyID0gbmV3IEhhYml0UGFyc2VyKHRoaXMuYXBwKTtcbiAgICB0aGlzLmRhdGFTdG9yZSA9IG5ldyBIYWJpdERhdGFTdG9yZShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVIYWJpdERhdGEoKTtcbiAgICB9KTtcblxuICAgIC8vIExvYWQgaGFiaXQgZGF0YVxuICAgIGNvbnN0IGhhYml0RGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSBhcyBIYWJpdERhdGE7XG4gICAgdGhpcy5kYXRhU3RvcmUubG9hZERhdGEoaGFiaXREYXRhIHx8IHt9KTtcblxuICAgIC8vIFJlZ2lzdGVyIHZpZXdcbiAgICB0aGlzLnJlZ2lzdGVyVmlldyhcbiAgICAgIFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSLFxuICAgICAgKGxlYWYpID0+IG5ldyBIYWJpdFRyYWNrZXJWaWV3KGxlYWYsIHRoaXMpXG4gICAgKTtcblxuICAgIC8vIEFkZCByaWJib24gaWNvblxuICAgIHRoaXMuYWRkUmliYm9uSWNvbignY2FsZW5kYXItY2hlY2snLCAnT3BlbiBIYWJpdCBUcmFja2VyJywgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICB9KTtcblxuICAgIC8vIEFkZCBjb21tYW5kIHRvIG9wZW4gdmlld1xuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ29wZW4taGFiaXQtdHJhY2tlcicsXG4gICAgICBuYW1lOiAnT3BlbiBIYWJpdCBUcmFja2VyJyxcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBIYWJpdFRyYWNrZXJTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZVZpZXcoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuXG4gICAgbGV0IGxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSKVswXTtcblxuICAgIGlmICghbGVhZikge1xuICAgICAgY29uc3QgcmlnaHRMZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG4gICAgICBpZiAocmlnaHRMZWFmKSB7XG4gICAgICAgIGF3YWl0IHJpZ2h0TGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgIHR5cGU6IFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSLFxuICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGxlYWYgPSByaWdodExlYWY7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGxlYWYpIHtcbiAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlZnJlc2hWaWV3KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0hBQklUX1RSQUNLRVIpO1xuICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgSGFiaXRUcmFja2VyVmlldztcbiAgICAgIGNvbnN0IGN1cnJlbnRIYWJpdHMgPSB0aGlzLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcbiAgICAgIGNvbnN0IHNlbGVjdGVkSGFiaXQgPSAodmlldyBhcyBhbnkpLnNlbGVjdGVkSGFiaXQ7IC8vIEFjY2VzcyBwcml2YXRlIG1lbWJlciBmb3IgY2hlY2tcblxuICAgICAgLy8gT25seSByZS1yZW5kZXIgaWYgdGhlIHNlbGVjdGVkIGhhYml0IGlzIG5vIGxvbmdlciB2YWxpZFxuICAgICAgLy8gb3IgaWYgbm8gaGFiaXQgaXMgc2VsZWN0ZWQgYW5kIHRoZXJlIGFyZSBoYWJpdHMgYXZhaWxhYmxlLlxuICAgICAgLy8gVGhpcyBwcmV2ZW50cyBjbG9iYmVyaW5nIGEgdmFsaWQgc3RhdGUgZHVlIHRvIGEgYmFja2dyb3VuZCByZWZyZXNoLlxuICAgICAgaWYgKCFzZWxlY3RlZEhhYml0IHx8ICFjdXJyZW50SGFiaXRzLmluY2x1ZGVzKHNlbGVjdGVkSGFiaXQpKSB7XG4gICAgICAgIGF3YWl0IHZpZXcucmVuZGVyKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHN1cGVyLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZUhhYml0RGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBzdXBlci5zYXZlRGF0YSh0aGlzLmRhdGFTdG9yZS5nZXREYXRhKCkpO1xuICB9XG5cbiAgb251bmxvYWQoKTogdm9pZCB7XG4gICAgLy8gQ2xlYW51cFxuICB9XG59XG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE1vZGFsLCBTZXR0aW5nLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgSGFiaXRUcmFja2VyUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfSEFCSVRfVFJBQ0tFUiA9ICdoYWJpdC10cmFja2VyLXZpZXcnO1xuXG50eXBlIFZpZXdUeXBlID0gJ3llYXInIHwgJ21vbnRoJyB8ICd5ZWFyLW92ZXJ2aWV3JyB8ICd0b2RheSc7XG5cbmV4cG9ydCBjbGFzcyBIYWJpdFRyYWNrZXJWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuICBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbjtcbiAgcHJpdmF0ZSBzZWxlY3RlZEhhYml0OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgLy8gRGVmYXVsdCB0byB0b2RheSB2aWV3IHNvIHRoZSBVSSBvcGVucyBvbiB0aGUgVG9kYXkncyBvdmVydmlldyBieSBkZWZhdWx0XG4gIHByaXZhdGUgdmlld1R5cGU6IFZpZXdUeXBlID0gJ3RvZGF5JztcbiAgcHJpdmF0ZSBzZWxlY3RlZE1vbnRoOiBEYXRlID0gbmV3IERhdGUoKTtcbiAgcHJpdmF0ZSBzZWxlY3RlZFllYXI6IG51bWJlciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTtcbiAgLy8gbW9udGhzIHRoZSB1c2VyIGhhcyBcInVubG9ja2VkXCIgKGNsaWNrZWQpIGluIHRoZSBZZWFyIE92ZXJ2aWV3IHNvIHRoZXkgYmVjb21lIGFjdGl2ZVxuICBwcml2YXRlIHVubG9ja2VkTW9udGhzOiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcblxuICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbikge1xuICAgIHN1cGVyKGxlYWYpO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIHRoaXMuc2VsZWN0ZWRNb250aC5zZXREYXRlKDEpO1xuICB9XG5cbiAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gVklFV19UWVBFX0hBQklUX1RSQUNLRVI7XG4gIH1cblxuICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiAnSGFiaXQgVHJhY2tlcic7XG4gIH1cblxuICBnZXRJY29uKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICdjYWxlbmRhci1jaGVjayc7XG4gIH1cblxuICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnUkVOREVSIFNUQVJUOiBzZWxlY3RlZEhhYml0ID0nLCB0aGlzLnNlbGVjdGVkSGFiaXQsICdUeXBlOicsIHR5cGVvZiB0aGlzLnNlbGVjdGVkSGFiaXQpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG4gICAgY29udGFpbmVyLmFkZENsYXNzKCdoYWJpdC10cmFja2VyLWNvbnRhaW5lcicpO1xuXG4gICAgLy8gUmVuZGVyIGNvbnRyb2xzIGFuZCBnZXQgdGhlIGNvbnRyb2xzIGVsZW1lbnQgc28gd2UgY2FuIG1lYXN1cmUgaXRzIGhlaWdodFxuICAgIGNvbnN0IGNvbnRyb2xzRWwgPSB0aGlzLnJlbmRlckNvbnRyb2xzKGNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgYSBjb250ZW50IHdyYXBwZXIgc28gd2UgY2FuIGd1YXJhbnRlZSBhbGwgcmVuZGVyZWQgdmlld3Mgc3RhcnQgYmVsb3cgdGhlIGNvbnRyb2xzLlxuICAgIGNvbnN0IGNvbnRlbnRXcmFwcGVyID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LWNvbnRlbnQnIH0pO1xuXG4gICAgLy8gRW5zdXJlIGNvbnRlbnQgaXMgcHVzaGVkIGJlbG93IGNvbnRyb2xzOiBtZWFzdXJlIGFuZCBhcHBseSBtYXJnaW4tdG9wLiBBbHNvIHVwZGF0ZSBvbiByZXNpemUuXG4gICAgY29uc3QgYXBwbHlPZmZzZXQgPSAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBoID0gKGNvbnRyb2xzRWwgYXMgSFRNTEVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCB8fCAwO1xuICAvLyBSZWR1Y2UgaG93IGZhciBjb250ZW50IGlzIHB1c2hlZCBkb3duOiB1c2UgYSBmcmFjdGlvbiBvZiBjb250cm9scyBoZWlnaHRcbiAgLy8gc28gdGhlIGNvbnRlbnQgYXBwZWFycyBoaWdoZXIgYnV0IHN0aWxsIGJlbG93IHRoZSBjb250cm9scy4gS2VlcCBhIHNtYWxsXG4gIC8vIG1pbmltdW0gZ2FwIHNvIHRoZXkncmUgbm90IHRvdWNoaW5nLlxuICBjb25zdCBvZmZzZXQgPSBNYXRoLm1heCg0LCBNYXRoLmNlaWwoaCAqIDAuNCkpO1xuICAgICAgICBjb250ZW50V3JhcHBlci5zdHlsZS5tYXJnaW5Ub3AgPSBgJHtvZmZzZXR9cHhgO1xuICAgICAgICAvLyBTbW9vdGggc21hbGwgbW92ZXMgd2hlbiByZXNpemluZ1xuICAgICAgICBjb250ZW50V3JhcHBlci5zdHlsZS50cmFuc2l0aW9uID0gJ21hcmdpbi10b3AgMTIwbXMgZWFzZSc7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGlnbm9yZSBtZWFzdXJlbWVudCBlcnJvcnNcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gVXNlIFJBRiBzbyB0aGUgRE9NIGlzIHN0YWJsZSB3aGVuIG1lYXN1cmluZ1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhcHBseU9mZnNldCk7XG4gICAgLy8gVXBkYXRlIG9uIHdpbmRvdyByZXNpemUgdG8gaGFuZGxlIHdyYXBwaW5nIGNvbnRyb2xzXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGFwcGx5T2Zmc2V0KTtcblxuICAgIGNvbnN0IGhhYml0cyA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcbiAgICBjb25zb2xlLmxvZygnUkVOREVSOiBIYWJpdHMgZnJvbSBzdG9yZSA9JywgaGFiaXRzKTtcblxuICAgIGlmIChoYWJpdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgdGV4dDogJ05vIGhhYml0cyB5ZXQuIENsaWNrIFwiQWRkIE5ldyBIYWJpdFwiIHRvIGdldCBzdGFydGVkIScsXG4gICAgICAgIGNsczogJ25vLWhhYml0cy1tZXNzYWdlJ1xuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnUkVOREVSOiBObyBoYWJpdHMsIGV4aXRpbmcuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSWYgYSBoYWJpdCBpcyBzZWxlY3RlZCBidXQgbm8gbG9uZ2VyIGV4aXN0cyAoZS5nLiwgZGVsZXRlZCBmcm9tIGFub3RoZXIgdmlldyksXG4gICAgLy8gb3IgaWYgbm8gaGFiaXQgaXMgc2VsZWN0ZWQgYXQgYWxsLCBkZWZhdWx0IHRvIHRoZSBmaXJzdCBvbmUuXG4gICAgaWYgKCF0aGlzLnNlbGVjdGVkSGFiaXQgfHwgIWhhYml0cy5pbmNsdWRlcyh0aGlzLnNlbGVjdGVkSGFiaXQpKSB7XG4gICAgICBpZiAoaGFiaXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEhhYml0ID0gaGFiaXRzWzBdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTm8gaGFiaXRzIHRvIHNlbGVjdCwgZW5zdXJlIGJ1dHRvbnMgYXJlIGRpc2FibGVkIGFuZCBleGl0LlxuICAgICAgICB0aGlzLnNlbGVjdGVkSGFiaXQgPSBudWxsO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgICB0ZXh0OiAnTm8gaGFiaXRzIHlldC4gQ2xpY2sgXCJBZGQgTmV3IEhhYml0XCIgdG8gZ2V0IHN0YXJ0ZWQhJyxcbiAgICAgICAgICBjbHM6ICduby1oYWJpdHMtbWVzc2FnZSdcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZW5kZXIgYmFzZWQgb24gc2VsZWN0ZWQgdmlldy4gRm9yICd5ZWFyJyB3ZSBub3cgc2hvdyBhbGwgaGFiaXRzIChub3Qgb25seSBzZWxlY3RlZCkuXG4gICAgaWYgKHRoaXMudmlld1R5cGUgPT09ICd5ZWFyJykge1xuICAgICAgLy8gcmVuZGVyWWVhclZpZXcgd2lsbCBpdGVyYXRlIGFsbCBoYWJpdHMgd2hlbiBubyBoYWJpdE5hbWUgaXMgcHJvdmlkZWRcbiAgICAgIHRoaXMucmVuZGVyWWVhclZpZXcoY29udGVudFdyYXBwZXIpO1xuICAgIH0gZWxzZSBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ21vbnRoJykge1xuICAgICAgLy8gTW9udGggdmlldyBzaG93cyBhbGwgaGFiaXRzXG4gICAgICB0aGlzLnJlbmRlck1vbnRoVmlldyhjb250ZW50V3JhcHBlcik7XG4gICAgfSBlbHNlIGlmICh0aGlzLnZpZXdUeXBlID09PSAndG9kYXknKSB7XG4gICAgICB0aGlzLnJlbmRlclRvZGF5Vmlldyhjb250ZW50V3JhcHBlcik7XG4gICAgfSBlbHNlIGlmICh0aGlzLnZpZXdUeXBlID09PSAneWVhci1vdmVydmlldycpIHtcbiAgICAgIC8vIFllYXIgb3ZlcnZpZXcgc3RpbGwgdGFyZ2V0cyB0aGUgc2VsZWN0ZWQgaGFiaXQgaWYgcHJlc2VudFxuICAgICAgdGhpcy5yZW5kZXJZZWFyT3ZlcnZpZXcoY29udGVudFdyYXBwZXIsIHRoaXMuc2VsZWN0ZWRIYWJpdCB8fCAodGhpcy5wbHVnaW4uZGF0YVN0b3JlLmdldEhhYml0cygpWzBdIHx8ICcnKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJUb2RheVZpZXcoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IGhhYml0cyA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcbiAgICBpZiAoIWhhYml0cyB8fCBoYWJpdHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgdG9kYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG5cbiAgICAvLyBEZXRlcm1pbmUgY3VycmVudCB3ZWVrJ3MgTW9uZGF5IGFzIHN0YXJ0XG4gICAgY29uc3QgZGF5T2ZXZWVrID0gKHRvZGF5LmdldERheSgpICsgNikgJSA3OyAvLyAwID0gTW9uZGF5XG4gICAgY29uc3QgbW9uZGF5ID0gbmV3IERhdGUodG9kYXkpO1xuICAgIG1vbmRheS5zZXREYXRlKHRvZGF5LmdldERhdGUoKSAtIGRheU9mV2Vlayk7XG5cbiAgICBjb25zdCB3ZWVrRGF0ZXM6IERhdGVbXSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICBjb25zdCBkID0gbmV3IERhdGUobW9uZGF5KTtcbiAgICAgIGQuc2V0RGF0ZShtb25kYXkuZ2V0RGF0ZSgpICsgaSk7XG4gICAgICB3ZWVrRGF0ZXMucHVzaChkKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2RheVN0ciA9IHRoaXMuZm9ybWF0RGF0ZSh0b2RheSk7XG5cbiAgICBjb25zdCB0b2RheVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAndG9kYXktb3ZlcnZpZXcnIH0pO1xuICAgIGNvbnN0IGhlYWRlciA9IHRvZGF5U2VjdGlvbi5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdUb2RheScsIGNsczogJ3RvZGF5LXRpdGxlJyB9KTtcblxuICAgIGNvbnN0IGNhcmRzQ29udGFpbmVyID0gdG9kYXlTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3RvZGF5LWNhcmRzLWNvbnRhaW5lcicgfSk7XG5cbiAgICBoYWJpdHMuZm9yRWFjaChoYWJpdCA9PiB7XG4gICAgICAvLyBDb3VudCBjb21wbGV0aW9ucyBpbiBjdXJyZW50IHdlZWtcbiAgICAgIGxldCB3ZWVrQ291bnQgPSAwO1xuICAgICAgd2Vla0RhdGVzLmZvckVhY2goZCA9PiB7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5kYXRhU3RvcmUuaXNIYWJpdENvbXBsZXRlZChoYWJpdCwgdGhpcy5mb3JtYXREYXRlKGQpKSkgd2Vla0NvdW50Kys7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY2FyZCA9IGNhcmRzQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3RvZGF5LWNhcmQgaGFiaXQtc2VjdGlvbicgfSk7XG5cbiAgICAgIGNvbnN0IGxlZnQgPSBjYXJkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3RvZGF5LWNhcmQtbGVmdCcgfSk7XG4gICAgICBsZWZ0LmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IFN0cmluZyh3ZWVrQ291bnQpLCBjbHM6ICd0b2RheS1jb3VudC1udW1iZXInIH0pO1xuICAgICAgbGVmdC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiB3ZWVrQ291bnQgPT09IDEgPyAnREFZJyA6ICdEQVlTJywgY2xzOiAndG9kYXktY291bnQtbGFiZWwnIH0pO1xuXG4gICAgICBjb25zdCByaWdodCA9IGNhcmQuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAndG9kYXktY2FyZC1yaWdodCcgfSk7XG4gICAgICBjb25zdCBjaGVja0J0biA9IHJpZ2h0LmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ3RvZGF5LWNoZWNrLWJ1dHRvbicgfSk7XG4gICAgICAvLyBzaG93IHRpY2sgaWYgdG9kYXkgaXMgY29tcGxldGVkIGZvciB0aGlzIGhhYml0XG4gICAgICBjb25zdCBpc1RvZGF5Q29tcGxldGVkID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmlzSGFiaXRDb21wbGV0ZWQoaGFiaXQsIHRvZGF5U3RyKTtcbiAgICAgIGNoZWNrQnRuLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBpc1RvZGF5Q29tcGxldGVkID8gJ1x1MjcxMycgOiAnJyAsIGNsczogJ3RvZGF5LWNoZWNrLW1hcmsnIH0pO1xuICAgICAgaWYgKGlzVG9kYXlDb21wbGV0ZWQpIGNoZWNrQnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgLy8gQXBwbHkgaGFiaXQgY29sb3IgaWYgcHJlc2VudFxuICAgICAgY29uc3QgaGFiaXRDb2xvciA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5nZXRIYWJpdENvbG9yKGhhYml0KTtcbiAgICAgIGlmIChoYWJpdENvbG9yKSB7XG4gICAgICAgIC8vIElmIHRvZGF5IGlzIGNvbXBsZXRlZDogc3R5bGUgdGhlIGNhcmQgYW5kIGNoZWNrIGJ1dHRvbiB3aXRoIGhhYml0IGNvbG9yXG4gICAgICAgIGlmIChpc1RvZGF5Q29tcGxldGVkKSB7XG4gICAgICAgICAgY2FyZC5hZGRDbGFzcygnYWN0aXZlLXRvZGF5Jyk7XG4gICAgICAgICAgLy8gdXNlIGEgbGlnaHRlciAobW9yZSBvcGFxdWUpIHZlcnNpb24gZm9yIHRoZSBjYXJkIGJhY2tncm91bmQgc28gdGhlIGNhcmQgbG9va3Mgc29mdGVyXG4gICAgICAgICAgY2FyZC5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xMik7XG4gICAgICAgICAgLy8gZW5zdXJlIHRleHQgaGFzIGdvb2QgY29udHJhc3RcbiAgICAgICAgICBjYXJkLnN0eWxlLmNvbG9yID0gdGhpcy5nZXRDb250cmFzdENvbG9yKGhhYml0Q29sb3IpO1xuICAgICAgICAgIC8vIGNoZWNrIGJ1dHRvbiBzaG91bGQgdXNlIHRoZSBmdWxsIGludGVuc2UgY29sb3Igd2hlbiBhY3RpdmVcbiAgICAgICAgICBjaGVja0J0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgIGNoZWNrQnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgIC8vIGFkZCBhIHN1YnRsZSBnbG93IHVzaW5nIHRoZSBoYWJpdCBjb2xvclxuICAgICAgICAgIGNoZWNrQnRuLnN0eWxlLmJveFNoYWRvdyA9IGAwIDhweCAyMHB4ICR7dGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xOCl9YDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzVG9kYXlDb21wbGV0ZWQpIHtcbiAgICAgICAgICBjYXJkLmFkZENsYXNzKCdhY3RpdmUtdG9kYXknKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjaGVja0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YVN0b3JlLnRvZ2dsZUhhYml0KGhhYml0LCB0b2RheVN0cik7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSGFiaXQgbmFtZSBhbmQgd2VlayByb3dcbiAgICAgIGNvbnN0IG1pZGRsZSA9IGNhcmQuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAndG9kYXktY2FyZC1taWRkbGUnIH0pO1xuICAgICAgbWlkZGxlLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGhhYml0LCBjbHM6ICd0b2RheS1oYWJpdC1uYW1lJyB9KTtcblxuICAgICAgY29uc3Qgd2Vla1JvdyA9IG1pZGRsZS5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd0b2RheS13ZWVrLXJvdycgfSk7XG4gIC8vIFNpbmdsZS1sZXR0ZXIgd2Vla2RheSBpbml0aWFscyBzdGFydGluZyBmcm9tIE1vbmRheTogTSwgVCwgVywgVCwgRiwgUywgU1xuICBjb25zdCBkYXlMYWJlbHMgPSBbJ00nLCAnVCcsICdXJywgJ1QnLCAnRicsICdTJywgJ1MnXTtcbiAgICAgIHdlZWtEYXRlcy5mb3JFYWNoKChkLCBpZHgpID0+IHtcbiAgICAgICAgY29uc3QgZFN0ciA9IHRoaXMuZm9ybWF0RGF0ZShkKTtcbiAgICAgICAgY29uc3Qgc3EgPSB3ZWVrUm93LmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3RvZGF5LXdlZWstc3F1YXJlJyB9KTtcbiAgICAgICAgLy8gYWRkIHRoZSBkYXkgaW5pdGlhbC9sYWJlbCBpbnNpZGUgdGhlIHNxdWFyZVxuICAgICAgICBjb25zdCBsYWJlbCA9IGRheUxhYmVsc1tpZHhdIHx8ICcnO1xuICAgICAgICBzcS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogbGFiZWwsIGNsczogJ3RvZGF5LXdlZWstaW5pdGlhbCcgfSk7XG5cbiAgICAgICAgY29uc3QgY29tcGxldGVkID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmlzSGFiaXRDb21wbGV0ZWQoaGFiaXQsIGRTdHIpO1xuICAgICAgICBpZiAoY29tcGxldGVkKSB7XG4gICAgICAgICAgc3EuYWRkQ2xhc3MoJ2NvbXBsZXRlZCcpO1xuICAgICAgICAgIGlmIChoYWJpdENvbG9yKSB7XG4gICAgICAgICAgICBzcS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgICAgc3Euc3R5bGUuYm94U2hhZG93ID0gYDAgNnB4IDE0cHggJHt0aGlzLmhleFRvUmdiYShoYWJpdENvbG9yLCAwLjE0KX1gO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc1NhbWVEYXkoZCwgdG9kYXkpKSB7XG4gICAgICAgICAgc3EuYWRkQ2xhc3MoJ3RvZGF5Jyk7XG4gICAgICAgICAgaWYgKCFjb21wbGV0ZWQgJiYgaGFiaXRDb2xvcikge1xuICAgICAgICAgICAgc3Euc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xMik7XG4gICAgICAgICAgICBzcS5zdHlsZS5vdXRsaW5lID0gYDJweCBzb2xpZCAke3RoaXMuaGV4VG9SZ2JhKGhhYml0Q29sb3IsIDAuMTgpfWA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgbWlkZGxlLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGAke3dlZWtDb3VudH0vN2AsIGNsczogJ3RvZGF5LXdlZWstY291bnQnIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJDb250cm9scyhjb250YWluZXI6IEhUTUxFbGVtZW50KTogSFRNTEVsZW1lbnQge1xuICAgIGNvbnN0IGNvbnRyb2xzU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1jb250cm9scycgfSk7XG5cbiAgICBjb25zdCBhZGRCdXR0b24gPSBjb250cm9sc1NlY3Rpb24uY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgIHRleHQ6ICdBZGQnLFxuICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgfSk7XG4gICAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgbmV3IEFkZEhhYml0TW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9KS5vcGVuKCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBoYWJpdHMgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuZ2V0SGFiaXRzKCk7XG5cbiAgICBpZiAoaGFiaXRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHNlbGVjdG9yQ29udGFpbmVyID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXNlbGVjdG9yLWNvbnRhaW5lcicgfSk7XG5cblxuICAgICAgY29uc3QgY3VzdG9tRHJvcGRvd24gPSBzZWxlY3RvckNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjdXN0b20taGFiaXQtZHJvcGRvd24nIH0pO1xuXG4gICAgICBjb25zdCBkcm9wZG93bkJ1dHRvbiA9IGN1c3RvbURyb3Bkb3duLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ2hhYml0LWRyb3Bkb3duLWJ1dHRvbicgfSk7XG4gICAgICBkcm9wZG93bkJ1dHRvbi5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogdGhpcy5zZWxlY3RlZEhhYml0IHx8ICdTZWxlY3QgSGFiaXQnLCBjbHM6ICdoYWJpdC1kcm9wZG93bi10ZXh0JyB9KTtcbiAgICAgIGRyb3Bkb3duQnV0dG9uLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnXHUyNUJDJywgY2xzOiAnaGFiaXQtZHJvcGRvd24tYXJyb3cnIH0pO1xuXG4gICAgICBjb25zdCBkcm9wZG93bk1lbnUgPSBjdXN0b21Ecm9wZG93bi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1kcm9wZG93bi1tZW51JyB9KTtcblxuICAgICAgaGFiaXRzLmZvckVhY2goaGFiaXQgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gZHJvcGRvd25NZW51LmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LWRyb3Bkb3duLWl0ZW0nIH0pO1xuXG4gICAgICAgIGlmIChoYWJpdCA9PT0gdGhpcy5zZWxlY3RlZEhhYml0KSB7XG4gICAgICAgICAgaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBoYWJpdFRleHQgPSBpdGVtLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBoYWJpdCwgY2xzOiAnaGFiaXQtaXRlbS10ZXh0JyB9KTtcbiAgICAgICAgLy8gQXR0YWNoIHRoZSBjbGljayBoYW5kbGVyIHRvIHRoZSBmdWxsIGl0ZW0gc28gdGhlIHdob2xlIHJvdyBpcyBjbGlja2FibGVcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkSGFiaXQgPSBoYWJpdDtcbiAgICAgICAgICBkcm9wZG93bk1lbnUucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gQWxzbyBtYWtlIHRoZSBpbm5lciB0ZXh0IG5vbi1pbnRlcmZlcmluZyBmb3IgY2xpY2tzXG4gICAgICAgIGhhYml0VGV4dC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xuICAgICAgfSk7XG5cbiAgICAgIGRyb3Bkb3duQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgY29uc3QgaXNTaG93biA9IGRyb3Bkb3duTWVudS5oYXNDbGFzcygnc2hvdycpO1xuICAgICAgICBpZiAoaXNTaG93bikge1xuICAgICAgICAgIGRyb3Bkb3duTWVudS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRyb3Bkb3duTWVudS5hZGRDbGFzcygnc2hvdycpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICBpZiAoIWN1c3RvbURyb3Bkb3duLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgICAgICAgZHJvcGRvd25NZW51LnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygnUmVuZGVyaW5nIEVkaXQgQnV0dG9uLiBzZWxlY3RlZEhhYml0OicsIHRoaXMuc2VsZWN0ZWRIYWJpdCwgJ1R5cGU6JywgdHlwZW9mIHRoaXMuc2VsZWN0ZWRIYWJpdCk7XG4gICAgICBjb25zdCBlZGl0QnV0dG9uID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgIHRleHQ6ICdFZGl0JyxcbiAgICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgICB9KTtcbiAgICAgIGVkaXRCdXR0b24uZGlzYWJsZWQgPSAhdGhpcy5zZWxlY3RlZEhhYml0O1xuICAgICAgZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRIYWJpdCkge1xuICAgICAgICAgIG5ldyBFZGl0SGFiaXRNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuc2VsZWN0ZWRIYWJpdCwgYXN5bmMgKG5ld05hbWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IG5ld05hbWU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgIH0pLm9wZW4oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNvbnRyb2xzU2VjdGlvbi5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgICB0ZXh0OiAnRGVsZXRlJyxcbiAgICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgICB9KTtcbiAgICAgIGRlbGV0ZUJ1dHRvbi5kaXNhYmxlZCA9ICF0aGlzLnNlbGVjdGVkSGFiaXQ7XG4gICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSGFiaXQpIHtcbiAgICAgICAgICBuZXcgRGVsZXRlSGFiaXRNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuc2VsZWN0ZWRIYWJpdCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEhhYml0ID0gbnVsbDtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgfSkub3BlbigpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0NvbnRyb2xzQ29udGFpbmVyID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3ZpZXctY29udHJvbHMtY29udGFpbmVyJyB9KTtcblxuXG4gICAgICBjb25zdCByYWRpb0dyb3VwID0gdmlld0NvbnRyb2xzQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3ZpZXctcmFkaW8tZ3JvdXAnIH0pO1xuXG4gICAgICAvLyBPcmRlcjogVG9kYXksIE1vbnRoLCBZZWFyIE92ZXJ2aWV3LCBZZWFyIChzd2FwcGVkIHBlciB1c2VyIHJlcXVlc3QpXG4gICAgICAvLyBMYWJlbCBjaGFuZ2VzOiAneWVhci1vdmVydmlldycgc2hvd3MgJ1llYXInOyAneWVhcicgc2hvd3MgJ0FMTCdcbiAgICAgIGNvbnN0IHZpZXdPcHRpb25zID0gW1xuICAgICAgICB7IHZhbHVlOiAndG9kYXknLCB0ZXh0OiAnVG9kYXknLCB0aXRsZTogXCJUb2RheSdzIGhhYml0cyBvdmVydmlld1wiIH0sXG4gICAgICAgIHsgdmFsdWU6ICdtb250aCcsIHRleHQ6ICdNb250aCcsIHRpdGxlOiAnVHJhZGl0aW9uYWwgbW9udGhseSBjYWxlbmRhcicgfSxcbiAgICAgICAgeyB2YWx1ZTogJ3llYXItb3ZlcnZpZXcnLCB0ZXh0OiAnWWVhcicsIHRpdGxlOiAnQWxsIDEyIG1vbnRocyBhdCBhIGdsYW5jZScgfSxcbiAgICAgICAgeyB2YWx1ZTogJ3llYXInLCB0ZXh0OiAnQWxsJywgdGl0bGU6ICdHaXRIdWItc3R5bGUgY29udHJpYnV0aW9uIGdyaWQnIH1cbiAgICAgIF07XG5cbiAgICAgIHZpZXdPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgY29uc3QgcmFkaW9MYWJlbCA9IHJhZGlvR3JvdXAuY3JlYXRlRWwoJ2xhYmVsJywgeyBjbHM6ICd2aWV3LXJhZGlvLWxhYmVsJyB9KTtcblxuICAgICAgICAvLyBBcHBseSB0aGUgZml4ZWQtd2lkdGggY2xhc3MgdG8gdGhlICd5ZWFyLW92ZXJ2aWV3JyBvcHRpb24gKGRpc3BsYXllZCBhc1xuICAgICAgICAvLyBcIlllYXJcIikgc28gaXQgcmVtYWlucyBjb21wYWN0OyB0aGUgJ3llYXInIG9wdGlvbiAoZGlzcGxheWVkIGFzIFwiQWxsXCIpXG4gICAgICAgIC8vIHNob3VsZCBzaXplIHRvIGl0cyB0ZXh0IGFuZCBub3QgYmUgZm9yY2VkIHRvIDgwcHguXG4gICAgICAgIGlmIChvcHRpb24udmFsdWUgPT09ICd5ZWFyLW92ZXJ2aWV3Jykge1xuICAgICAgICAgIHJhZGlvTGFiZWwuYWRkQ2xhc3MoJ3ZpZXctcmFkaW8teWVhci1vdmVydmlldycpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmFkaW9JbnB1dCA9IHJhZGlvTGFiZWwuY3JlYXRlRWwoJ2lucHV0Jywge1xuICAgICAgICAgIHR5cGU6ICdyYWRpbycsXG4gICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgbmFtZTogJ3ZpZXctdHlwZScsXG4gICAgICAgICAgICB2YWx1ZTogb3B0aW9uLnZhbHVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjbHM6ICd2aWV3LXJhZGlvLWlucHV0J1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAob3B0aW9uLnZhbHVlID09PSB0aGlzLnZpZXdUeXBlKSB7XG4gICAgICAgICAgcmFkaW9JbnB1dC5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJhZGlvSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGlmIChyYWRpb0lucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMudmlld1R5cGUgPSBvcHRpb24udmFsdWUgYXMgVmlld1R5cGU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmFkaW9MYWJlbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogb3B0aW9uLnRleHQsIGNsczogJ3ZpZXctcmFkaW8tdGV4dCcgfSk7XG4gICAgICAgIHJhZGlvTGFiZWwuc2V0QXR0cmlidXRlKCd0aXRsZScsIG9wdGlvbi50aXRsZSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gR2xvYmFsIG1vbnRoIG5hdmlnYXRpb24gcmVtb3ZlZDogcGVyLWhhYml0IG1vbnRoIG5hdiBpcyB1c2VkIGluc3RlYWQuXG4gICAgfVxuXG4gICAgLy8gQWRkIGEgc2V0dGluZ3MgYnV0dG9uIGF0IHRoZSBmYXIgcmlnaHQgb2YgdGhlIGNvbnRyb2xzIGJhci4gSXQgb3BlbnMgYVxuICAgIC8vIHNtYWxsIG1lbnUgd2hlbiBjbGlja2VkLiBXZSBjcmVhdGUgdGhlIG1lbnUgaW5zaWRlIHRoZSBjb250cm9sc1NlY3Rpb25cbiAgICAvLyBhbmQgcG9zaXRpb24gaXQgdG8gdGhlIGZhciByaWdodCB1c2luZyBDU1MgKHNlZSBzdHlsZXMuY3NzKS5cbiAgICBjb25zdCBjb250cm9sc1JpZ2h0ID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NvbnRyb2xzLXJpZ2h0JyB9KTtcbiAgICAvLyBzcGFjZXIgZW5zdXJlcyBwcmV2aW91cyBpdGVtcyByZW1haW4gZ3JvdXBlZCB0byB0aGUgbGVmdFxuICAgIGNvbnRyb2xzUmlnaHQuc3R5bGUubWFyZ2luTGVmdCA9ICdhdXRvJztcblxuICAgIGNvbnN0IHNldHRpbmdzQnRuID0gY29udHJvbHNSaWdodC5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgY2xzOiAnaGFiaXQtc2V0dGluZ3MtYnV0dG9uJyxcbiAgICAgIGF0dHI6IHsgdHlwZTogJ2J1dHRvbicsIHRpdGxlOiAnU2V0dGluZ3MnIH1cbiAgICB9KTtcbiAgICAvLyB1c2UgYSBzdHJva2Utb25seSBnZWFyIFNWRyAoc2ltaWxhciBzdHlsZSB0byBPYnNpZGlhbidzIGdlYXIgaWNvbilcbiAgICBzZXR0aW5nc0J0bi5zZXRBdHRyKCdhcmlhLWxhYmVsJywgJ1NldHRpbmdzJyk7XG4gICAgLy8gVXNlIE9ic2lkaWFuJ3MgbmF0aXZlIHNldHRpbmdzIGljb24gZm9yIGEgcGl4ZWwtcGVyZmVjdCBtYXRjaFxuICAgIHRyeSB7XG4gICAgICBzZXRJY29uKHNldHRpbmdzQnRuLCAnc2V0dGluZ3MnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBGYWxsYmFjazogaWYgc2V0SWNvbiBpc24ndCBhdmFpbGFibGUgZm9yIHNvbWUgcmVhc29uLCBsZWF2ZSB0aGUgYnV0dG9uIHRleHRcbiAgICAgIHNldHRpbmdzQnRuLnNldFRleHQoJ1xcdTI2OTknKTsgLy8gZ2VhciB1bmljb2RlIGFzIGZhbGxiYWNrXG4gICAgfVxuXG4gICAgY29uc3Qgc2V0dGluZ3NNZW51ID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NldHRpbmdzLW1lbnUnIH0pO1xuICAgIHNldHRpbmdzTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnRXhwb3J0IERhdGEnLCBjbHM6ICdzZXR0aW5ncy1tZW51LWl0ZW0nIH0pO1xuICAgIHNldHRpbmdzTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnSW1wb3J0IERhdGEnLCBjbHM6ICdzZXR0aW5ncy1tZW51LWl0ZW0nIH0pO1xuICAgIHNldHRpbmdzTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnUHJlZmVyZW5jZXMnLCBjbHM6ICdzZXR0aW5ncy1tZW51LWl0ZW0nIH0pO1xuICAgIHNldHRpbmdzTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnQWJvdXQnLCBjbHM6ICdzZXR0aW5ncy1tZW51LWl0ZW0nIH0pO1xuXG4gICAgLy8gSGlkZSBpbml0aWFsbHlcbiAgICBzZXR0aW5nc01lbnUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLy8gVG9nZ2xlIG1lbnUgdmlzaWJpbGl0eVxuICAgIHNldHRpbmdzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBpZiAoc2V0dGluZ3NNZW51Lmhhc0NsYXNzKCdoaWRkZW4nKSkge1xuICAgICAgICBzZXR0aW5nc01lbnUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICBzZXR0aW5nc01lbnUuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldHRpbmdzTWVudS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIHNldHRpbmdzTWVudS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGVcbiAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWNvbnRyb2xzU2VjdGlvbi5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuICAgICAgICBzZXR0aW5nc01lbnUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICBzZXR0aW5nc01lbnUucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNpbXBsZSBoYW5kbGVycyBmb3IgbWVudSBpdGVtc1xuICAgIEFycmF5LmZyb20oc2V0dGluZ3NNZW51LmNoaWxkcmVuKS5mb3JFYWNoKChjaGlsZDogRWxlbWVudCkgPT4ge1xuICAgICAgY2hpbGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCB0eHQgPSAoY2hpbGQgYXMgSFRNTEVsZW1lbnQpLmlubmVyVGV4dC50cmltKCk7XG4gICAgICAgIC8vIGNsb3NlIG1lbnVcbiAgICAgICAgc2V0dGluZ3NNZW51LmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgc2V0dGluZ3NNZW51LnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgIC8vIGltcGxlbWVudCBiYXNpYyBhY3Rpb25zOyByZWFsIGltcGxlbWVudGF0aW9ucyBjYW4gYmUgYWRkZWQgbGF0ZXJcbiAgICAgICAgaWYgKHR4dCA9PT0gJ0V4cG9ydCBEYXRhJykge1xuICAgICAgICAgIC8vIHRyaWdnZXIgcGx1Z2luIGV4cG9ydCAoaWYgYXZhaWxhYmxlKVxuICAgICAgICAgIGlmICh0aGlzLnBsdWdpbiAmJiB0eXBlb2YgKHRoaXMucGx1Z2luIGFzIGFueSkuZXhwb3J0RGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgKHRoaXMucGx1Z2luIGFzIGFueSkuZXhwb3J0RGF0YSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRXhwb3J0IERhdGEgY2xpY2tlZCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eHQgPT09ICdJbXBvcnQgRGF0YScpIHtcbiAgICAgICAgICBpZiAodGhpcy5wbHVnaW4gJiYgdHlwZW9mICh0aGlzLnBsdWdpbiBhcyBhbnkpLmltcG9ydERhdGEgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICh0aGlzLnBsdWdpbiBhcyBhbnkpLmltcG9ydERhdGEoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ltcG9ydCBEYXRhIGNsaWNrZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHh0ID09PSAnUHJlZmVyZW5jZXMnKSB7XG4gICAgICAgICAgLy8gT3BlbiB0aGUgcGx1Z2luLXNwZWNpZmljIHNldHRpbmdzIHRhYiBpZiBwb3NzaWJsZS4gVXNlIHRoZSBwbHVnaW5cbiAgICAgICAgICAvLyBtYW5pZmVzdCBpZCBhcyB0aGUgcHJlZmVycmVkIGFyZ3VtZW50IHRvIG9wZW5TZXR0aW5nVGFiLlxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBhcHBBbnkgPSAodGhpcy5hcHAgYXMgYW55KTtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbklkID0gdGhpcy5wbHVnaW4gJiYgKHRoaXMucGx1Z2luIGFzIGFueSkubWFuaWZlc3QgJiYgKHRoaXMucGx1Z2luIGFzIGFueSkubWFuaWZlc3QuaWQgPyAodGhpcy5wbHVnaW4gYXMgYW55KS5tYW5pZmVzdC5pZCA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmIChhcHBBbnkgJiYgdHlwZW9mIGFwcEFueS5vcGVuU2V0dGluZ1RhYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICBpZiAocGx1Z2luSWQpIHtcbiAgICAgICAgICAgICAgICB0cnkgeyBhcHBBbnkub3BlblNldHRpbmdUYWIocGx1Z2luSWQpOyB9IGNhdGNoIChlKSB7IGFwcEFueS5vcGVuU2V0dGluZ1RhYigpOyB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXBwQW55Lm9wZW5TZXR0aW5nVGFiKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcmVmZXJlbmNlcyBjbGlja2VkIC0gb3BlblNldHRpbmdUYWIgbm90IGF2YWlsYWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBvcGVuaW5nIHByZWZlcmVuY2VzJywgZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR4dCA9PT0gJ0Fib3V0Jykge1xuICAgICAgICAgIG5ldyBNb2RhbCh0aGlzLmFwcCkub3BlbigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybiB0aGUgY29udHJvbHMgZWxlbWVudCBzbyBjYWxsZXJzIGNhbiBtZWFzdXJlIGl0IGFuZCBhZGp1c3QgbGF5b3V0XG4gICAgcmV0dXJuIGNvbnRyb2xzU2VjdGlvbjtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyWWVhclZpZXcoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaGFiaXROYW1lPzogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgaGFiaXRzVG9SZW5kZXIgPSBoYWJpdE5hbWUgPyBbaGFiaXROYW1lXSA6IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcblxuICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpO1xuXG4gICAgaGFiaXRzVG9SZW5kZXIuZm9yRWFjaChoYWJpdCA9PiB7XG4gICAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXNlY3Rpb24gZ2l0aHViLXN0eWxlJyB9KTtcblxuICBjb25zdCBoZWFkZXIgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1oZWFkZXInIH0pO1xuICBoZWFkZXIuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogaGFiaXQsIGNsczogJ2hhYml0LW5hbWUnIH0pO1xuXG4gIC8vIFllYXIgc2VsZWN0b3IgcGxhY2VkIGlubGluZSBvbiB0aGUgc2FtZSBoZWFkZXIgcm93ICh0byB0aGUgcmlnaHQpXG4gIGNvbnN0IGhlYWRlclllYXJTZWxlY3RvciA9IGhlYWRlci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdnaXRodWIteWVhci1zZWxlY3RvcicgfSk7XG5cbiAgY29uc3QgeWVhckNvbnRhaW5lciA9IHNlY3Rpb24uY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLXllYXItY29udGFpbmVyJyB9KTtcbiAgY29uc3QgZ3JhcGhDb250YWluZXIgPSB5ZWFyQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1ncmFwaC1jb250YWluZXInIH0pO1xuXG4gICAgICAvLyBSZXNwb25zaXZlIHNxdWFyZSBncmlkOiBjb2x1bW5zIGFkYXB0IHRvIGF2YWlsYWJsZSB3aWR0aCBzbyB3aWRlciBwYW5lc1xuICAgICAgLy8gc2hvdyBtb3JlIGNvbHVtbnMgKGZld2VyIHJvd3MpIGFuZCBuYXJyb3cgcGFuZXMgc2hvdyBmZXdlciBjb2x1bW5zIChtb3JlIHJvd3MpLlxuICAgICAgLy8gV2UgYnVpbGQgdGhlIGdyaWQgZHluYW1pY2FsbHkgYW5kIHJlYnVpbGQgb24gcmVzaXplLlxuICAgICAgY29uc3QgZ3JpZCA9IGdyYXBoQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1zcXVhcmUtZ3JpZCcgfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHRoaXMuc2VsZWN0ZWRZZWFyLCAwLCAxKTtcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgIHRvZGF5LnNldEhvdXJzKDAsIDAsIDAsIDApO1xuXG4gICAgICBjb25zdCBidWlsZEdyaWQgPSAoKSA9PiB7XG4gICAgICAgIC8vIGNsZWFyIGFueSBleGlzdGluZyBjZWxsc1xuICAgICAgICBncmlkLmVtcHR5KCk7XG5cbiAgICAgICAgY29uc3QgQ0VMTF9QWCA9IDEyOyAvLyBjZWxsIHNpemUgaW4gcHggKGtlZXAgaW4gc3luYyB3aXRoIENTUylcbiAgICAgICAgY29uc3QgR0FQX1BYID0gMzsgLy8gZ3JpZCBnYXAgaW4gcHggKGtlZXAgaW4gc3luYyB3aXRoIENTUylcblxuICAgICAgICAvLyBtZWFzdXJlIGNvbnRhaW5lciB3aWR0aDsgaWYgemVybyBmYWxsIGJhY2sgdG8gYSBkZWZhdWx0IGNvbHVtbnMgY291bnRcbiAgICAgICAgY29uc3QgY29udGFpbmVyV2lkdGggPSBNYXRoLm1heCgwLCBncmFwaENvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCB8fCAwKTtcblxuICAgICAgICAvLyBjb21wdXRlIGNvbHVtbnMgdGhhdCBmaXQ6ICh3aWR0aCArIGdhcCkgLyAoY2VsbCArIGdhcClcbiAgICAgICAgbGV0IGNvbHMgPSBjb250YWluZXJXaWR0aCA+IDAgPyBNYXRoLmZsb29yKChjb250YWluZXJXaWR0aCArIEdBUF9QWCkgLyAoQ0VMTF9QWCArIEdBUF9QWCkpIDogMzA7XG4gICAgICAgIC8vIHJlYXNvbmFibGUgY2xhbXBzOiBuZXZlciBmZXdlciB0aGFuIDcsIG5ldmVyIG1vcmUgdGhhbiA2MFxuICAgICAgICBjb2xzID0gTWF0aC5taW4oTWF0aC5tYXgoY29scywgNyksIDYwKTtcblxuICAgICAgICAvLyBkYXlzIGluIHNlbGVjdGVkIHllYXIgKGhhbmRsZXMgbGVhcCB5ZWFycylcbiAgICAgICAgY29uc3QgZGF5c0luWWVhciA9IChuZXcgRGF0ZSh0aGlzLnNlbGVjdGVkWWVhciArIDEsIDAsIDEpLmdldFRpbWUoKSAtIG5ldyBEYXRlKHRoaXMuc2VsZWN0ZWRZZWFyLCAwLCAxKS5nZXRUaW1lKCkpIC8gKDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG4gICAgICAgIGNvbnN0IHJvd3MgPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwoZGF5c0luWWVhciAvIGNvbHMpKTtcblxuICAgICAgICAvLyBzZXQgZXhwbGljaXQgaW5saW5lIGdyaWQgc2l6aW5nIHRvIGVuc3VyZSBtZWFzdXJlZCBsYXlvdXRcbiAgICAgICAgZ3JpZC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke2NvbHN9LCAke0NFTExfUFh9cHgpYDtcbiAgICAgICAgZ3JpZC5zdHlsZS5ncmlkVGVtcGxhdGVSb3dzID0gYHJlcGVhdCgke3Jvd3N9LCAke0NFTExfUFh9cHgpYDtcbiAgICAgICAgZ3JpZC5zdHlsZS5nYXAgPSBgJHtHQVBfUFh9cHhgO1xuICAgICAgICBncmlkLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3N0YXJ0JztcbiAgICAgICAgZ3JpZC5zdHlsZS5hbGlnbkNvbnRlbnQgPSAnc3RhcnQnO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsQ2VsbHMgPSByb3dzICogY29scztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsQ2VsbHM7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlKTtcbiAgICAgICAgICBjdXJyZW50RGF0ZS5zZXREYXRlKHN0YXJ0RGF0ZS5nZXREYXRlKCkgKyBpKTtcbiAgICAgICAgICBjb25zdCBkYXRlU3RyID0gdGhpcy5mb3JtYXREYXRlKGN1cnJlbnREYXRlKTtcblxuICAgICAgICAgIGNvbnN0IGNlbGwgPSBncmlkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1jZWxsJyB9KTtcbiAgICAgICAgICBjb25zdCByb3cgPSBNYXRoLmZsb29yKGkgLyBjb2xzKSArIDE7XG4gICAgICAgICAgY29uc3QgY29sID0gKGkgJSBjb2xzKSArIDE7XG4gICAgICAgICAgY2VsbC5zdHlsZS5ncmlkQ29sdW1uID0gYCR7Y29sfWA7XG4gICAgICAgICAgY2VsbC5zdHlsZS5ncmlkUm93ID0gYCR7cm93fWA7XG5cbiAgICAgICAgICBpZiAoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSAhPT0gdGhpcy5zZWxlY3RlZFllYXIpIHtcbiAgICAgICAgICAgIGNlbGwuYWRkQ2xhc3MoJ291dHNpZGUteWVhcicpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBpc0NvbXBsZXRlZCA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5pc0hhYml0Q29tcGxldGVkKGhhYml0LCBkYXRlU3RyKTtcbiAgICAgICAgICAgIGNvbnN0IGhhYml0Q29sb3IgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuZ2V0SGFiaXRDb2xvcihoYWJpdCk7XG4gICAgICAgICAgICBpZiAoaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgY2VsbC5hZGRDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgICAgIGlmIChoYWJpdENvbG9yKSB7XG4gICAgICAgICAgICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2FtZURheShjdXJyZW50RGF0ZSwgdG9kYXkpKSB7XG4gICAgICAgICAgICAgIGNlbGwuYWRkQ2xhc3MoJ3RvZGF5Jyk7XG4gICAgICAgICAgICAgIGlmICghaXNDb21wbGV0ZWQgJiYgaGFiaXRDb2xvcikge1xuICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xMik7XG4gICAgICAgICAgICAgICAgY2VsbC5zdHlsZS5vdXRsaW5lID0gYDJweCBzb2xpZCAke3RoaXMuaGV4VG9SZ2JhKGhhYml0Q29sb3IsIDAuMTgpfWA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGF0ZScsIGRhdGVTdHIpO1xuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgYCR7aGFiaXR9IC0gJHtkYXRlU3RyfWApO1xuXG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBuZXdTdGF0ZSA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS50b2dnbGVIYWJpdChoYWJpdCwgZGF0ZVN0cik7XG4gICAgICAgICAgICAgIGlmIChuZXdTdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNlbGwuYWRkQ2xhc3MoJ2NvbXBsZXRlZCcpO1xuICAgICAgICAgICAgICAgIGlmIChoYWJpdENvbG9yKSBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGhhYml0Q29sb3I7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2VsbC5yZW1vdmVDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgICAgICAgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnJztcbiAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLm91dGxpbmUgPSAnJztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvLyBpbml0aWFsIGJ1aWxkIG9uY2UgRE9NIGxheW91dCBpcyBzdGFibGVcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShidWlsZEdyaWQpO1xuXG4gICAgICAvLyBSZWJ1aWxkIG9uIHdpbmRvdyByZXNpemUgYXMgYSBmYWxsYmFja1xuICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KHdpbmRvdywgJ3Jlc2l6ZScsICgpID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShidWlsZEdyaWQpKTtcblxuICAgICAgLy8gQWxzbyBvYnNlcnZlIHNpemUgY2hhbmdlcyBvZiB0aGUgZ3JhcGggY29udGFpbmVyIGl0c2VsZi4gVGhpcyBjYXRjaGVzXG4gICAgICAvLyBsYXlvdXQgY2hhbmdlcyBjYXVzZWQgYnkgZXhwYW5kaW5nL2NvbGxhcHNpbmcgdGhlIGNvbnRyb2xzIGJhciBvciBvdGhlclxuICAgICAgLy8gcGFuZWwgYWRqdXN0bWVudHMgdGhhdCBkb24ndCB0cmlnZ2VyIGEgd2luZG93IHJlc2l6ZS5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIElmIHRoaXMgc3BlY2lmaWMgZ3JhcGhDb250YWluZXIgYWxyZWFkeSBoYXMgYW4gb2JzZXJ2ZXIsIGRpc2Nvbm5lY3QgaXRcbiAgICAgICAgY29uc3QgcHJldlJPID0gKGdyYXBoQ29udGFpbmVyIGFzIGFueSkuX195ZWFyR3JpZFJPO1xuICAgICAgICBpZiAocHJldlJPICYmIHR5cGVvZiBwcmV2Uk8uZGlzY29ubmVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHRyeSB7IHByZXZSTy5kaXNjb25uZWN0KCk7IH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBybyA9IG5ldyBSZXNpemVPYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGJ1aWxkR3JpZCk7XG4gICAgICAgIH0pO1xuICAgICAgICByby5vYnNlcnZlKGdyYXBoQ29udGFpbmVyKTtcbiAgICAgICAgLy8gc3RvcmUgb2JzZXJ2ZXIgb24gdGhlIHNwZWNpZmljIGNvbnRhaW5lciBzbyBlYWNoIGhhYml0J3MgZ3JpZCBpcyBvYnNlcnZlZFxuICAgICAgICAoZ3JhcGhDb250YWluZXIgYXMgYW55KS5fX3llYXJHcmlkUk8gPSBybztcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gUmVzaXplT2JzZXJ2ZXIgbWF5IG5vdCBiZSBhdmFpbGFibGUgaW4gc29tZSBlbnZpcm9ubWVudHM7IGlnbm9yZS5cbiAgICAgIH1cblxuICAgICAgY29uc3QgZWFybGllc3RZZWFyID0gdGhpcy5nZXRFYXJsaWVzdFllYXJXaXRoRGF0YShoYWJpdCk7XG4gICAgICBjb25zdCBzdGFydFllYXIgPSBNYXRoLm1pbihlYXJsaWVzdFllYXIsIGN1cnJlbnRZZWFyKTtcblxuICAgICAgZm9yIChsZXQgeWVhciA9IHN0YXJ0WWVhcjsgeWVhciA8PSBjdXJyZW50WWVhcjsgeWVhcisrKSB7XG4gICAgICAgIGNvbnN0IHllYXJCdXR0b24gPSBoZWFkZXJZZWFyU2VsZWN0b3IuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICB0ZXh0OiB5ZWFyLnRvU3RyaW5nKCksXG4gICAgICAgICAgY2xzOiAnZ2l0aHViLXllYXItYnV0dG9uJ1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoeWVhciA9PT0gdGhpcy5zZWxlY3RlZFllYXIpIHtcbiAgICAgICAgICB5ZWFyQnV0dG9uLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh5ZWFyID09PSBjdXJyZW50WWVhcikge1xuICAgICAgICAgIHllYXJCdXR0b24uYWRkQ2xhc3MoJ2N1cnJlbnQteWVhcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgeWVhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkWWVhciA9IHllYXI7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vbnRoVmlldyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBoYWJpdE5hbWU/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBoYWJpdHNUb1JlbmRlciA9IGhhYml0TmFtZSA/IFtoYWJpdE5hbWVdIDogdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmdldEhhYml0cygpO1xuXG4gICAgLy8gUGVyLWhhYml0IG1vbnRoIHN0YXRlOiBhbGxvdyBlYWNoIGhhYml0IHRvIHRyYWNrIGl0cyBvd24gZGlzcGxheWVkIG1vbnRoLlxuICAgIC8vIGB0aGlzLmhhYml0TW9udGhzYCB3aWxsIGJlIGEgbWFwIGZyb20gaGFiaXQgbmFtZSAtPiBEYXRlLiBJbml0aWFsaXplIGxhemlseS5cbiAgICBpZiAoISgnaGFiaXRNb250aHMnIGluIHRoaXMpKSB7XG4gICAgICAvLyBAdHMtaWdub3JlIC0gYWRkIGEgcnVudGltZSBtYXAgd2l0aG91dCBjaGFuZ2luZyB0aGUgY2xhc3Mgc2lnbmF0dXJlIGVsc2V3aGVyZVxuICAgICAgKHRoaXMgYXMgYW55KS5oYWJpdE1vbnRocyA9IG5ldyBNYXA8c3RyaW5nLCBEYXRlPigpO1xuICAgIH1cblxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcblxuICAgIC8vIFJlbmRlciBhIGNhbGVuZGFyIHNlY3Rpb24gZm9yIGVhY2ggaGFiaXQuIEVhY2ggaGFiaXQgdXNlcyBpdHMgb3duIG1vbnRoIHN0YXRlLlxuICAgIGhhYml0c1RvUmVuZGVyLmZvckVhY2goaGFiaXQgPT4ge1xuICAgICAgY29uc3Qgc2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1zZWN0aW9uIGNhbGVuZGFyLXZpZXcnIH0pO1xuXG4gICAgICAvLyBFbnN1cmUgd2UgaGF2ZSBhIERhdGUgaW5zdGFuY2UgZm9yIHRoaXMgaGFiaXQncyBjdXJyZW50bHktZGlzcGxheWVkIG1vbnRoXG4gICAgICAvLyBDbG9uZSB0aGUgZ2xvYmFsIHNlbGVjdGVkTW9udGggYXMgYSBzdGFydGluZyBwb2ludCB3aGVuIGFic2VudC5cbiAgICAgIC8vIFVzZSBhIGxvY2FsIHZhcmlhYmxlIGBoYWJpdE1vbnRoYCBmb3IgYWxsIG1vbnRoLXNwZWNpZmljIGNhbGN1bGF0aW9ucyBiZWxvdy5cbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGhhYml0TW9udGhzOiBNYXA8c3RyaW5nLCBEYXRlPiA9ICh0aGlzIGFzIGFueSkuaGFiaXRNb250aHM7XG4gICAgICBpZiAoIWhhYml0TW9udGhzLmhhcyhoYWJpdCkpIHtcbiAgICAgICAgaGFiaXRNb250aHMuc2V0KGhhYml0LCBuZXcgRGF0ZSh0aGlzLnNlbGVjdGVkTW9udGgpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGhhYml0TW9udGggPSBuZXcgRGF0ZShoYWJpdE1vbnRocy5nZXQoaGFiaXQpIGFzIERhdGUpO1xuXG4gIC8vIEhlYWRlcjogaGFiaXQgbmFtZSAobGVmdCkgYW5kIG1vbnRoL3llYXIgbmF2aWdhdGlvbiAoY2VudGVyL3JpZ2h0KVxuICBjb25zdCBoZWFkZXJSb3cgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NhbGVuZGFyLWhlYWRlcicgfSk7XG4gIGNvbnN0IGhlYWRlckxlZnQgPSBoZWFkZXJSb3cuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnY2FsZW5kYXItaGVhZGVyLWxlZnQnIH0pO1xuICBoZWFkZXJMZWZ0LmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGhhYml0LCBjbHM6ICdoYWJpdC1uYW1lIGNhbGVuZGFyLWhhYml0LW5hbWUnIH0pO1xuXG4gICAgICAvLyBQZXItaGFiaXQgbW9udGggbmF2aWdhdGlvbjogc2hvdyBwcmV2L25leHQgYXJyb3dzIGFuZCBtb250aCBsYWJlbCBhYm92ZSBlYWNoIGhhYml0XG4gICAgICBjb25zdCBtb250aE5hdklubGluZSA9IGhlYWRlclJvdy5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYWxlbmRhci1oZWFkZXItdGl0bGUgbW9udGgtbmF2LWlubGluZScgfSk7XG4gICAgICBjb25zdCBwcmV2QnRuID0gbW9udGhOYXZJbmxpbmUuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1x1MjVDMCcsIGNsczogJ21vbnRoLW5hdi1idXR0b24nIH0pO1xuICAgICAgY29uc3QgbW9udGhMYWJlbCA9IG1vbnRoTmF2SW5saW5lLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGhhYml0TW9udGgudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi1VUycsIHsgbW9udGg6ICdsb25nJywgeWVhcjogJ251bWVyaWMnIH0pLCBjbHM6ICdjYWxlbmRhci1tb250aC10aXRsZScgfSk7XG4gICAgICBjb25zdCBuZXh0QnRuID0gbW9udGhOYXZJbmxpbmUuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1x1MjVCNicsIGNsczogJ21vbnRoLW5hdi1idXR0b24nIH0pO1xuXG4gICAgICBwcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBzaGlmdCBvbmx5IHRoaXMgaGFiaXQncyBkaXNwbGF5ZWQgbW9udGggYmFjayBvbmVcbiAgICAgICAgY29uc3QgbSA9IG5ldyBEYXRlKGhhYml0TW9udGgpO1xuICAgICAgICBtLnNldE1vbnRoKG0uZ2V0TW9udGgoKSAtIDEpO1xuICAgICAgICBoYWJpdE1vbnRocy5zZXQoaGFiaXQsIG0pO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSk7XG5cbiAgICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIHNoaWZ0IG9ubHkgdGhpcyBoYWJpdCdzIGRpc3BsYXllZCBtb250aCBmb3J3YXJkIG9uZVxuICAgICAgICBjb25zdCBtID0gbmV3IERhdGUoaGFiaXRNb250aCk7XG4gICAgICAgIG0uc2V0TW9udGgobS5nZXRNb250aCgpICsgMSk7XG4gICAgICAgIGhhYml0TW9udGhzLnNldChoYWJpdCwgbSk7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY2FsZW5kYXIgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NhbGVuZGFyLW1vbnRoJyB9KTtcblxuICAgICAgLy8gV2Vla2RheSBsYWJlbHMgc3RhcnRpbmcgb24gTW9uZGF5IHRvIG1hdGNoIHRoZSBpUGhvbmUgbGF5b3V0XG4gICAgICBjb25zdCB3ZWVrRGF5cyA9IFsnTW9uJywgJ1R1ZScsICdXZWQnLCAnVGh1JywgJ0ZyaScsICdTYXQnLCAnU3VuJ107XG4gICAgICBjb25zdCB3ZWVrRGF5SGVhZGVyID0gY2FsZW5kYXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnY2FsZW5kYXItd2Vla2RheXMnIH0pO1xuICAgICAgd2Vla0RheXMuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgICB3ZWVrRGF5SGVhZGVyLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRheSwgY2xzOiAnY2FsZW5kYXItd2Vla2RheScgfSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZGF5c0dyaWQgPSBjYWxlbmRhci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYWxlbmRhci1kYXlzLWdyaWQnIH0pO1xuXG4gICAgICAvLyBDb21wdXRlIG1vbnRoLXNwZWNpZmljIGRhdGUgaW5mbyBmcm9tIGhhYml0TW9udGhcbiAgICAgIGNvbnN0IHllYXIgPSBoYWJpdE1vbnRoLmdldEZ1bGxZZWFyKCk7XG4gICAgICBjb25zdCBtb250aCA9IGhhYml0TW9udGguZ2V0TW9udGgoKTtcbiAgICAgIGNvbnN0IGZpcnN0RGF5ID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDEpO1xuICAgICAgY29uc3QgbGFzdERheSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoICsgMSwgMCk7XG4gICAgICAvLyBTaGlmdCBzbyB3ZWVrIHN0YXJ0cyBvbiBNb25kYXkgKDAgPSBNb25kYXksIDYgPSBTdW5kYXkpXG4gICAgICBjb25zdCBzdGFydGluZ0RheU9mV2VlayA9IChmaXJzdERheS5nZXREYXkoKSArIDYpICUgNztcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGFydGluZ0RheU9mV2VlazsgaSsrKSB7XG4gICAgICAgIGRheXNHcmlkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NhbGVuZGFyLWRheSBlbXB0eScgfSk7XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGRheSA9IDE7IGRheSA8PSBsYXN0RGF5LmdldERhdGUoKTsgZGF5KyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5KTtcbiAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHRoaXMuZm9ybWF0RGF0ZShjdXJyZW50RGF0ZSk7XG5cbiAgICAgICAgY29uc3QgZGF5Q2VsbCA9IGRheXNHcmlkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NhbGVuZGFyLWRheScgfSk7XG4gICAgICAgIGRheUNlbGwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogZGF5LnRvU3RyaW5nKCksIGNsczogJ2NhbGVuZGFyLWRheS1udW1iZXInIH0pO1xuXG4gICAgICAgIGNvbnN0IGlzQ29tcGxldGVkID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmlzSGFiaXRDb21wbGV0ZWQoaGFiaXQsIGRhdGVTdHIpO1xuICAgICAgICBjb25zdCBoYWJpdENvbG9yID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmdldEhhYml0Q29sb3IoaGFiaXQpO1xuICAgICAgICBpZiAoaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICBkYXlDZWxsLmFkZENsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICBpZiAoaGFiaXRDb2xvcikge1xuICAgICAgICAgICAgZGF5Q2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgICAgY29uc3QgbnVtID0gZGF5Q2VsbC5xdWVyeVNlbGVjdG9yKCcuY2FsZW5kYXItZGF5LW51bWJlcicpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKG51bSkgbnVtLnN0eWxlLmNvbG9yID0gdGhpcy5nZXRDb250cmFzdENvbG9yKGhhYml0Q29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzU2FtZURheShjdXJyZW50RGF0ZSwgdG9kYXkpKSB7XG4gICAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygndG9kYXknKTtcbiAgICAgICAgICBpZiAoIWlzQ29tcGxldGVkICYmIGhhYml0Q29sb3IpIHtcbiAgICAgICAgICAgIGRheUNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xMik7XG4gICAgICAgICAgICBkYXlDZWxsLnN0eWxlLm91dGxpbmUgPSBgMnB4IHNvbGlkICR7dGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xOCl9YDtcbiAgICAgICAgICAgIGNvbnN0IG51bSA9IGRheUNlbGwucXVlcnlTZWxlY3RvcignLmNhbGVuZGFyLWRheS1udW1iZXInKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChudW0pIG51bS5zdHlsZS5jb2xvciA9IHRoaXMuZ2V0Q29udHJhc3RDb2xvcihoYWJpdENvbG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBkYXlDZWxsLnNldEF0dHJpYnV0ZSgnZGF0YS1kYXRlJywgZGF0ZVN0cik7XG4gICAgICAgIGRheUNlbGwuc2V0QXR0cmlidXRlKCd0aXRsZScsIGAke2hhYml0fSAtICR7ZGF0ZVN0cn1gKTtcblxuICAgICAgICBkYXlDZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld1N0YXRlID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLnRvZ2dsZUhhYml0KGhhYml0LCBkYXRlU3RyKTtcbiAgICAgICAgICBpZiAobmV3U3RhdGUpIHtcbiAgICAgICAgICAgIGRheUNlbGwuYWRkQ2xhc3MoJ2NvbXBsZXRlZCcpO1xuICAgICAgICAgICAgaWYgKGhhYml0Q29sb3IpIHtcbiAgICAgICAgICAgICAgZGF5Q2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgICAgICBjb25zdCBudW0gPSBkYXlDZWxsLnF1ZXJ5U2VsZWN0b3IoJy5jYWxlbmRhci1kYXktbnVtYmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgIGlmIChudW0pIG51bS5zdHlsZS5jb2xvciA9IHRoaXMuZ2V0Q29udHJhc3RDb2xvcihoYWJpdENvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGF5Q2VsbC5yZW1vdmVDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgICBkYXlDZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgZGF5Q2VsbC5zdHlsZS5vdXRsaW5lID0gJyc7XG4gICAgICAgICAgICBjb25zdCBudW0gPSBkYXlDZWxsLnF1ZXJ5U2VsZWN0b3IoJy5jYWxlbmRhci1kYXktbnVtYmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAobnVtKSBudW0uc3R5bGUuY29sb3IgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJZZWFyT3ZlcnZpZXcoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaGFiaXROYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXNlY3Rpb24geWVhci1vdmVydmlldycgfSk7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctaGVhZGVyJyB9KTtcblxuICAgIC8vIExlZnQgYXJlYTogaGFiaXQgbmFtZSArIHBlci1oYWJpdCBuYXZpZ2F0aW9uIChwcmV2IC8gbmV4dClcbiAgICBjb25zdCBoZWFkZXJMZWZ0ID0gaGVhZGVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctaGVhZGVyLWxlZnQnIH0pO1xuICAgIGhlYWRlckxlZnQuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogaGFiaXROYW1lLCBjbHM6ICdoYWJpdC1uYW1lJyB9KTtcblxuICAgIC8vIEFkZCBzbWFsbCBwcmV2L25leHQgYXJyb3dzIGJldHdlZW4gdGhlIGhhYml0IG5hbWUgYW5kIHRoZSB5ZWFyIGxhYmVsIHNvIHRoZVxuICAgIC8vIHVzZXIgY2FuIGN5Y2xlIGhhYml0cyB3aGlsZSBrZWVwaW5nIHRoZSB5ZWFyIG92ZXJ2aWV3IHZpc2libGUuXG4gICAgY29uc3QgaGFiaXROYXYgPSBoZWFkZXJMZWZ0LmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXllYXItbmF2JyB9KTtcblxuICAgIGNvbnN0IGhhYml0cyA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSBoYWJpdHMuaW5kZXhPZihoYWJpdE5hbWUpO1xuXG4gICAgY29uc3QgcHJldkhhYml0QnRuID0gaGFiaXROYXYuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1x1MjVDMCcsIGNsczogJ2hhYml0LW5hdi1idXR0b24nIH0pO1xuICAgIHByZXZIYWJpdEJ0bi5kaXNhYmxlZCA9IGN1cnJlbnRJbmRleCA8PSAwO1xuICAgIHByZXZIYWJpdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmIChjdXJyZW50SW5kZXggPiAwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IGhhYml0c1tjdXJyZW50SW5kZXggLSAxXTtcbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IG5leHRIYWJpdEJ0biA9IGhhYml0TmF2LmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdcdTI1QjYnLCBjbHM6ICdoYWJpdC1uYXYtYnV0dG9uJyB9KTtcbiAgICBuZXh0SGFiaXRCdG4uZGlzYWJsZWQgPSBjdXJyZW50SW5kZXggPT09IC0xIHx8IGN1cnJlbnRJbmRleCA+PSBoYWJpdHMubGVuZ3RoIC0gMTtcbiAgICBuZXh0SGFiaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoY3VycmVudEluZGV4ID09PSAtMSkgcmV0dXJuO1xuICAgICAgaWYgKGN1cnJlbnRJbmRleCA8IGhhYml0cy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IGhhYml0c1tjdXJyZW50SW5kZXggKyAxXTtcbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFJpZ2h0IGFyZWE6IHllYXIgbGFiZWxcbiAgICBoZWFkZXIuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogU3RyaW5nKHRoaXMuc2VsZWN0ZWRZZWFyKSwgY2xzOiAneWVhci1vdmVydmlldy15ZWFyLWxhYmVsJyB9KTtcblxuICAgIGNvbnN0IHllYXJDb250YWluZXIgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctY29udGFpbmVyJyB9KTtcblxuICBjb25zdCB5ZWFyR3JpZCA9IHllYXJDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAneWVhci1vdmVydmlldy1ncmlkJyB9KTtcblxuICBjb25zdCBtb250aE5hbWVzID0gWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPY3QnLCAnTm92JywgJ0RlYyddO1xuXG4gICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XG4gICAgY29uc3QgY3VycmVudE1vbnRoID0gbmV3IERhdGUoKS5nZXRNb250aCgpO1xuICAgIGNvbnN0IGlzQ3VycmVudFllYXIgPSB0aGlzLnNlbGVjdGVkWWVhciA9PT0gY3VycmVudFllYXI7XG4gIGNvbnN0IGxhc3RNb250aCA9IGlzQ3VycmVudFllYXIgPyBjdXJyZW50TW9udGggOiAxMTtcblxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICBjb25zdCB0b2RheURhdGUgPSB0b2RheS5nZXREYXRlKCk7XG5cbiAgICAvLyBzaG93IGFsbCAxMiBtb250aHMgYnV0IGRpbSBmdXR1cmUgb25lczsgdGhleSBjYW4gYmUgdW5sb2NrZWQgaW5kaXZpZHVhbGx5XG4gICAgZm9yIChsZXQgbW9udGggPSAwOyBtb250aCA8IDEyOyBtb250aCsrKSB7XG4gICAgICBjb25zdCBtb250aENvbnRhaW5lciA9IHllYXJHcmlkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctbW9udGgnIH0pO1xuXG4gICAgICBtb250aENvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBtb250aE5hbWVzW21vbnRoXSwgY2xzOiAneWVhci1vdmVydmlldy1tb250aC1uYW1lJyB9KTtcblxuICAgICAgY29uc3QgbW9udGhEYXlzID0gbW9udGhDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAneWVhci1vdmVydmlldy1kYXlzJyB9KTtcblxuICAgICAgY29uc3QgZGF5c0luTW9udGggPSBuZXcgRGF0ZSh0aGlzLnNlbGVjdGVkWWVhciwgbW9udGggKyAxLCAwKS5nZXREYXRlKCk7XG4gICAgICBjb25zdCBpc0N1cnJlbnRNb250aCA9IGlzQ3VycmVudFllYXIgJiYgbW9udGggPT09IGN1cnJlbnRNb250aDtcbiAgICAgIGNvbnN0IGxhc3REYXkgPSBpc0N1cnJlbnRNb250aCA/IHRvZGF5RGF0ZSA6IGRheXNJbk1vbnRoO1xuXG4gICAgICAvLyBDb21wdXRlIHRoZSB3ZWVrZGF5IHRoZSBtb250aCBzdGFydHMgb24gKDAgPSBNb25kYXksIDYgPSBTdW5kYXkpXG4gICAgICBjb25zdCBmaXJzdE9mTW9udGggPSBuZXcgRGF0ZSh0aGlzLnNlbGVjdGVkWWVhciwgbW9udGgsIDEpO1xuICAgICAgY29uc3Qgc3RhcnRpbmdEYXlPZldlZWsgPSAoZmlyc3RPZk1vbnRoLmdldERheSgpICsgNikgJSA3O1xuXG4gICAgICAvLyBQbGFjZSBlYWNoIGRheSBpbnRvIHRoZSBtb250aCdzIDctY29sdW1uIGdyaWQgYnkgY29tcHV0aW5nIGl0cyB3ZWVrZGF5IGFuZCB3ZWVrIGluZGV4XG4gIGZvciAobGV0IGRheSA9IDE7IGRheSA8PSBsYXN0RGF5OyBkYXkrKykge1xuICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKHRoaXMuc2VsZWN0ZWRZZWFyLCBtb250aCwgZGF5KTtcbiAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHRoaXMuZm9ybWF0RGF0ZShjdXJyZW50RGF0ZSk7XG4gICAgICAgIGNvbnN0IGRheUNlbGwgPSBtb250aERheXMuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAneWVhci1vdmVydmlldy1kYXknIH0pO1xuICAgICAgICAvLyBjb21wdXRlIG9mZnNldCBmcm9tIHRoZSBmaXJzdCB3ZWVrZGF5IHRvIGRldGVybWluZSByb3cvY29sdW1uXG4gICAgICAgIGNvbnN0IG9mZnNldCA9IHN0YXJ0aW5nRGF5T2ZXZWVrICsgKGRheSAtIDEpO1xuICAgICAgICBjb25zdCBjb2wgPSAob2Zmc2V0ICUgNykgKyAxOyAvLyAxLWJhc2VkIGNvbHVtbiAoTW9uPTEpXG4gICAgICAgIGNvbnN0IHJvdyA9IE1hdGguZmxvb3Iob2Zmc2V0IC8gNykgKyAxOyAvLyB3ZWVrIGluZGV4ICgxLWJhc2VkKVxuICAgICAgICAvLyBwbGFjZSB0aGUgY2VsbCBleHBsaWNpdGx5IGluIHRoZSBncmlkIHNvIG1vbnRocyBzdGFydCBvbiB0aGUgY29ycmVjdCB3ZWVrZGF5XG4gICAgICAgIGRheUNlbGwuc3R5bGUuZ3JpZENvbHVtbiA9IGAke2NvbH1gO1xuICAgICAgICBkYXlDZWxsLnN0eWxlLmdyaWRSb3cgPSBgJHtyb3d9YDtcbiAgICAgICAgICAvLyBSZW1vdmVkIHRoZSBpbm5lciBzcGFuIHdpdGggdGhlIGRheSBudW1iZXJcblxuICAgICAgICBjb25zdCBpc0NvbXBsZXRlZCA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5pc0hhYml0Q29tcGxldGVkKGhhYml0TmFtZSwgZGF0ZVN0cik7XG4gICAgICAgIGNvbnN0IGhhYml0Q29sb3IgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuZ2V0SGFiaXRDb2xvcihoYWJpdE5hbWUpO1xuICAgICAgICBpZiAoaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICBkYXlDZWxsLmFkZENsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICBpZiAoaGFiaXRDb2xvcikge1xuICAgICAgICAgICAgZGF5Q2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzU2FtZURheShjdXJyZW50RGF0ZSwgdG9kYXkpKSB7XG4gICAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygndG9kYXknKTtcbiAgICAgICAgICBpZiAoIWlzQ29tcGxldGVkICYmIGhhYml0Q29sb3IpIHtcbiAgICAgICAgICAgIGRheUNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xMik7XG4gICAgICAgICAgICBkYXlDZWxsLnN0eWxlLm91dGxpbmUgPSBgMnB4IHNvbGlkICR7dGhpcy5oZXhUb1JnYmEoaGFiaXRDb2xvciwgMC4xOCl9YDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBkYXlDZWxsLnNldEF0dHJpYnV0ZSgnZGF0YS1kYXRlJywgZGF0ZVN0cik7XG4gICAgICAgIGRheUNlbGwuc2V0QXR0cmlidXRlKCd0aXRsZScsIGAke2hhYml0TmFtZX0gLSAke2RhdGVTdHJ9YCk7XG5cbiAgICAgICAgZGF5Q2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdTdGF0ZSA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS50b2dnbGVIYWJpdChoYWJpdE5hbWUsIGRhdGVTdHIpO1xuICAgICAgICAgIGlmIChuZXdTdGF0ZSkge1xuICAgICAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgICBpZiAoaGFiaXRDb2xvcikgZGF5Q2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoYWJpdENvbG9yO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXlDZWxsLnJlbW92ZUNsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICAgIGRheUNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICBkYXlDZWxsLnN0eWxlLm91dGxpbmUgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFmdGVyIGNyZWF0aW5nIG1vbnRocywgbWFyayBmdXR1cmUgbW9udGhzIGFzICd1cGNvbWluZycgdW5sZXNzIHVubG9ja2VkXG4gICAgZm9yIChsZXQgbSA9IDA7IG0gPCAxMjsgbSsrKSB7XG4gICAgICBjb25zdCBtYyA9IHllYXJHcmlkLmNoaWxkcmVuW21dIGFzIEhUTUxFbGVtZW50O1xuICAgICAgaWYgKCFtYykgY29udGludWU7XG4gICAgICBjb25zdCBpc0Z1dHVyZSA9IGlzQ3VycmVudFllYXIgJiYgbSA+IGN1cnJlbnRNb250aDtcbiAgICAgIGlmIChpc0Z1dHVyZSAmJiAhdGhpcy51bmxvY2tlZE1vbnRocy5oYXMobSkpIHtcbiAgICAgICAgbWMuYWRkQ2xhc3MoJ3VwY29taW5nJyk7XG4gICAgICB9XG4gICAgICAvLyBtYWtlIG1vbnRocyBjbGlja2FibGU6IHVubG9jayB0aGF0IHNwZWNpZmljIG1vbnRoIHdoZW4gY2xpY2tlZCBhbmQgc2VsZWN0IGl0XG4gICAgICBtYy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG4gICAgICAgIC8vIGlmIGl0IHdhcyB1cGNvbWluZywgdW5sb2NrIG9ubHkgdGhpcyBtb250aFxuICAgICAgICBpZiAoaXNDdXJyZW50WWVhciAmJiBtID4gY3VycmVudE1vbnRoKSB7XG4gICAgICAgICAgdGhpcy51bmxvY2tlZE1vbnRocy5hZGQobSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0IHNlbGVjdGVkTW9udGggdG8gdGhlIGNsaWNrZWQgbW9udGggc28gb3RoZXIgdmlld3MgY2FuIHVzZSBpdFxuICAgICAgICB0aGlzLnNlbGVjdGVkTW9udGguc2V0TW9udGgobSk7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRZZWFyID0gdGhpcy5zZWxlY3RlZFllYXI7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBZZWFyIHNlbGVjdG9yIHJlbW92ZWQgdG8gbWF4aW1pemUgdmVydGljYWwgc3BhY2UgaW4gWWVhciBPdmVydmlld1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXREYXRlKGRhdGU6IERhdGUpOiBzdHJpbmcge1xuICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgfVxuXG4gIHByaXZhdGUgaGV4VG9SZ2IoaGV4OiBzdHJpbmcpOiB7IHI6IG51bWJlcjsgZzogbnVtYmVyOyBiOiBudW1iZXIgfSB8IG51bGwge1xuICAgIC8vIHN1cHBvcnQgI3JyZ2diYiBvciAjcmdiXG4gICAgY29uc3QgY2xlYW4gPSBoZXgucmVwbGFjZSgnIycsICcnKS50cmltKCk7XG4gICAgaWYgKGNsZWFuLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgciA9IHBhcnNlSW50KGNsZWFuWzBdICsgY2xlYW5bMF0sIDE2KTtcbiAgICAgIGNvbnN0IGcgPSBwYXJzZUludChjbGVhblsxXSArIGNsZWFuWzFdLCAxNik7XG4gICAgICBjb25zdCBiID0gcGFyc2VJbnQoY2xlYW5bMl0gKyBjbGVhblsyXSwgMTYpO1xuICAgICAgcmV0dXJuIHsgciwgZywgYiB9O1xuICAgIH1cbiAgICBpZiAoY2xlYW4ubGVuZ3RoID09PSA2KSB7XG4gICAgICBjb25zdCByID0gcGFyc2VJbnQoY2xlYW4uc2xpY2UoMCwgMiksIDE2KTtcbiAgICAgIGNvbnN0IGcgPSBwYXJzZUludChjbGVhbi5zbGljZSgyLCA0KSwgMTYpO1xuICAgICAgY29uc3QgYiA9IHBhcnNlSW50KGNsZWFuLnNsaWNlKDQsIDYpLCAxNik7XG4gICAgICByZXR1cm4geyByLCBnLCBiIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBoZXhUb1JnYmEoaGV4OiBzdHJpbmcsIGFscGhhID0gMSk6IHN0cmluZyB7XG4gICAgY29uc3QgcmdiID0gdGhpcy5oZXhUb1JnYihoZXgpO1xuICAgIGlmICghcmdiKSByZXR1cm4gaGV4O1xuICAgIHJldHVybiBgcmdiYSgke3JnYi5yfSwgJHtyZ2IuZ30sICR7cmdiLmJ9LCAke2FscGhhfSlgO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250cmFzdENvbG9yKGhleDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCByZ2IgPSB0aGlzLmhleFRvUmdiKGhleCk7XG4gICAgaWYgKCFyZ2IpIHJldHVybiAnI2ZmZic7XG4gICAgLy8gY2FsY3VsYXRlIGx1bWluYW5jZVxuICAgIGNvbnN0IHIgPSByZ2IuciAvIDI1NTtcbiAgICBjb25zdCBnID0gcmdiLmcgLyAyNTU7XG4gICAgY29uc3QgYiA9IHJnYi5iIC8gMjU1O1xuICAgIGNvbnN0IGwgPSAwLjIxMjYgKiByICsgMC43MTUyICogZyArIDAuMDcyMiAqIGI7XG4gICAgcmV0dXJuIGwgPiAwLjYgPyAnIzAwMCcgOiAnI2ZmZic7XG4gIH1cblxuICBwcml2YXRlIGlzU2FtZURheShkYXRlMTogRGF0ZSwgZGF0ZTI6IERhdGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZGF0ZTEuZ2V0RnVsbFllYXIoKSA9PT0gZGF0ZTIuZ2V0RnVsbFllYXIoKSAmJlxuICAgICAgICAgICBkYXRlMS5nZXRNb250aCgpID09PSBkYXRlMi5nZXRNb250aCgpICYmXG4gICAgICAgICAgIGRhdGUxLmdldERhdGUoKSA9PT0gZGF0ZTIuZ2V0RGF0ZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRFYXJsaWVzdFllYXJXaXRoRGF0YShoYWJpdE5hbWU6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XG4gICAgY29uc3QgaGFiaXREYXRhID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmdldERhdGEoKVtoYWJpdE5hbWVdO1xuXG4gICAgaWYgKCFoYWJpdERhdGEgfHwgdHlwZW9mIGhhYml0RGF0YSAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheShoYWJpdERhdGEpKSB7XG4gICAgICByZXR1cm4gY3VycmVudFllYXI7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0ZXMgPSBPYmplY3Qua2V5cyhoYWJpdERhdGEgYXMgeyBbZGF0ZTogc3RyaW5nXTogYm9vbGVhbiB9KTtcbiAgICBpZiAoZGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gY3VycmVudFllYXI7XG4gICAgfVxuXG4gICAgbGV0IGVhcmxpZXN0WWVhciA9IGN1cnJlbnRZZWFyO1xuICAgIGRhdGVzLmZvckVhY2goZGF0ZVN0ciA9PiB7XG4gICAgICBjb25zdCB5ZWFyID0gcGFyc2VJbnQoZGF0ZVN0ci5zcGxpdCgnLScpWzBdKTtcbiAgICAgIGlmICh5ZWFyIDwgZWFybGllc3RZZWFyKSB7XG4gICAgICAgIGVhcmxpZXN0WWVhciA9IHllYXI7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZWFybGllc3RZZWFyO1xuICB9XG5cbiAgYXN5bmMgb25DbG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBDbGVhbnVwIGlmIG5lZWRlZFxuICB9XG59XG5cbmNsYXNzIEFkZEhhYml0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luO1xuICBvblN1Ym1pdDogKCkgPT4gUHJvbWlzZTx2b2lkPjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IGFueSwgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW4sIG9uU3VibWl0OiAoKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gIH1cblxuICBvbk9wZW4oKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnQWRkJyB9KTtcblxuICAgIGxldCBoYWJpdE5hbWUgPSAnJztcbiAgLy8gZGVmYXVsdCBjb2xvciBjaG9pY2VzXG4gIGNvbnN0IENPTE9SUyA9IFsnIzBBODRGRicsICcjMjZBNjQxJywgJyNGRjNCMzAnLCAnI0ZGOUYwQScsICcjQUY1MkRFJywgJyM1QUM4RkEnLCAnI0ZGMkQ1NSddO1xuICBsZXQgc2VsZWN0ZWRDb2xvciA9IENPTE9SU1swXTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKCdIYWJpdCBOYW1lJylcbiAgICAgIC5zZXREZXNjKCdFbnRlciB0aGUgbmFtZSBvZiB5b3VyIG5ldyBoYWJpdCcpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgdGV4dC5zZXRQbGFjZWhvbGRlcignZS5nLiwgRXhlcmNpc2UsIFJlYWQsIE1lZGl0YXRlJylcbiAgICAgICAgICAub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgaGFiaXROYW1lID0gdmFsdWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgIHRleHQuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChlKSA9PiB7XG4gICAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1pdChoYWJpdE5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGV4dC5pbnB1dEVsLmZvY3VzKCksIDEwKTtcbiAgICAgIH0pO1xuXG4gICAgLy8gQ29sb3IgcGlja2VyXG4gICAgY29uc3QgY29sb3JTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoJ0NvbG9yJylcbiAgICAgIC5zZXREZXNjKCdQaWNrIGEgY29sb3IgZm9yIHRoaXMgaGFiaXQnKVxuICAgICAgLmFkZEJ1dHRvbigoKSA9PiB7fSk7XG5cbiAgICBjb25zdCBzd2F0Y2hDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnaGFiaXQtY29sb3Itc3dhdGNoZXMnIH0pO1xuICAgIENPTE9SUy5mb3JFYWNoKGMgPT4ge1xuICAgICAgY29uc3Qgc3cgPSBzd2F0Y2hDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnY29sb3Itc3dhdGNoJyB9KTtcbiAgICAgIHN3LnNldEF0dHIoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICBzdy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjO1xuICAgICAgaWYgKGMgPT09IHNlbGVjdGVkQ29sb3IpIHN3LmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgICAgc3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHNlbGVjdGVkQ29sb3IgPSBjO1xuICAgICAgICBzd2F0Y2hDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmNvbG9yLXN3YXRjaCcpLmZvckVhY2goKHM6IEVsZW1lbnQpID0+IHMuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKSk7XG4gICAgICAgICAgc3cuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdBZGQnKVxuICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc3VibWl0KGhhYml0TmFtZSwgc2VsZWN0ZWRDb2xvcik7XG4gICAgICAgIH0pKVxuICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KSk7XG4gIH1cblxuICBhc3luYyBzdWJtaXQoaGFiaXROYW1lOiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdHJpbW1lZE5hbWUgPSBoYWJpdE5hbWUgPyBoYWJpdE5hbWUudHJpbSgpIDogJyc7XG4gICAgaWYgKCF0cmltbWVkTmFtZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN1Y2Nlc3MgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuYWRkSGFiaXQodHJpbW1lZE5hbWUpO1xuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgLy8gc3RvcmUgY29sb3IgdW5kZXIgdGhlIHRyaW1tZWQgaGFiaXQgbmFtZSBzbyBrZXlzIG1hdGNoXG4gICAgICAgIHRoaXMucGx1Z2luLmRhdGFTdG9yZS5zZXRIYWJpdENvbG9yKHRyaW1tZWROYW1lLCBjb2xvcik7XG4gICAgICB9XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICBhd2FpdCB0aGlzLm9uU3VibWl0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICB0ZXh0OiAnVGhpcyBoYWJpdCBhbHJlYWR5IGV4aXN0cyBvciB0aGUgbmFtZSBpcyBpbnZhbGlkIScsXG4gICAgICAgIGNsczogJ2hhYml0LWVycm9yLW1lc3NhZ2UnXG4gICAgICB9KTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gZXJyb3JFbC5yZW1vdmUoKSwgMzAwMCk7XG4gICAgfVxuICB9XG5cbiAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufVxuXG5jbGFzcyBFZGl0SGFiaXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW47XG4gIG9sZE5hbWU6IHN0cmluZztcbiAgb25TdWJtaXQ6IChuZXdOYW1lOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG5cbiAgY29uc3RydWN0b3IoYXBwOiBhbnksIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luLCBvbGROYW1lOiBzdHJpbmcsIG9uU3VibWl0OiAobmV3TmFtZTogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLm9sZE5hbWUgPSBvbGROYW1lO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdFZGl0IEhhYml0JyB9KTtcblxuICAgIGxldCBoYWJpdE5hbWUgPSB0aGlzLm9sZE5hbWU7XG5cbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuc2V0TmFtZSgnSGFiaXQgTmFtZScpXG4gICAgICAuc2V0RGVzYygnRW50ZXIgdGhlIG5ldyBuYW1lIGZvciB5b3VyIGhhYml0JylcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICB0ZXh0LnNldFZhbHVlKHRoaXMub2xkTmFtZSlcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2UuZy4sIEV4ZXJjaXNlLCBSZWFkLCBNZWRpdGF0ZScpXG4gICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIGhhYml0TmFtZSA9IHZhbHVlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB0ZXh0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXQoaGFiaXROYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0ZXh0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgICB0ZXh0LmlucHV0RWwuc2VsZWN0KCk7XG4gICAgICAgIH0sIDEwKTtcbiAgICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdTYXZlJylcbiAgICAgICAgLnNldEN0YSgpXG4gICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICB0aGlzLnN1Ym1pdChoYWJpdE5hbWUpO1xuICAgICAgICB9KSlcbiAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2FuY2VsJylcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSkpO1xuICB9XG5cbiAgYXN5bmMgc3VibWl0KGhhYml0TmFtZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFoYWJpdE5hbWUudHJpbSgpIHx8IGhhYml0TmFtZSA9PT0gdGhpcy5vbGROYW1lKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc3VjY2VzcyA9IHRoaXMucGx1Z2luLmRhdGFTdG9yZS5yZW5hbWVIYWJpdCh0aGlzLm9sZE5hbWUsIGhhYml0TmFtZSk7XG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIGF3YWl0IHRoaXMub25TdWJtaXQoaGFiaXROYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnLCB7XG4gICAgICAgIHRleHQ6ICdUaGlzIGhhYml0IG5hbWUgYWxyZWFkeSBleGlzdHMgb3IgaXMgaW52YWxpZCEnLFxuICAgICAgICBjbHM6ICdoYWJpdC1lcnJvci1tZXNzYWdlJ1xuICAgICAgfSk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IGVycm9yRWwucmVtb3ZlKCksIDMwMDApO1xuICAgIH1cbiAgfVxuXG4gIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG4gIH1cbn1cblxuY2xhc3MgRGVsZXRlSGFiaXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW47XG4gIGhhYml0TmFtZTogc3RyaW5nO1xuICBvblN1Ym1pdDogKCkgPT4gUHJvbWlzZTx2b2lkPjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IGFueSwgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW4sIGhhYml0TmFtZTogc3RyaW5nLCBvblN1Ym1pdDogKCkgPT4gUHJvbWlzZTx2b2lkPikge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5oYWJpdE5hbWUgPSBoYWJpdE5hbWU7XG4gICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xuICB9XG5cbiAgb25PcGVuKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0RlbGV0ZSBIYWJpdCcgfSk7XG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7XG4gICAgICB0ZXh0OiBgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBcIiR7dGhpcy5oYWJpdE5hbWV9XCI/IFRoaXMgd2lsbCByZW1vdmUgYWxsIHByb2dyZXNzIGRhdGEgZm9yIHRoaXMgaGFiaXQuYFxuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdEZWxldGUnKVxuICAgICAgICAuc2V0V2FybmluZygpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhU3RvcmUucmVtb3ZlSGFiaXQodGhpcy5oYWJpdE5hbWUpO1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLm9uU3VibWl0KCk7XG4gICAgICAgIH0pKVxuICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KSk7XG4gIH1cblxuICBvbkNsb3NlKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgSGFiaXRUcmFja2VyUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBIYWJpdFRyYWNrZXJTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbikge1xuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnSGFiaXQgVHJhY2tlciBTZXR0aW5ncycgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdIYWJpdHMgRmlsZSBQYXRoJylcbiAgICAgIC5zZXREZXNjKCdQYXRoIHRvIHRoZSBtYXJrZG93biBmaWxlIGNvbnRhaW5pbmcgeW91ciBsaXN0IG9mIGhhYml0cyAoZS5nLiwgaGFiaXRzLm1kKScpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdoYWJpdHMubWQnKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFiaXRzRmlsZVBhdGgpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYWJpdHNGaWxlUGF0aCA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIHRoaXMucGx1Z2luLnJlZnJlc2hWaWV3KCk7XG4gICAgICAgIH0pKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBIYWJpdFBhcnNlciB7XG4gIGFwcDogQXBwO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwKSB7XG4gICAgdGhpcy5hcHAgPSBhcHA7XG4gIH1cblxuICBhc3luYyBwYXJzZUhhYml0c0Zyb21GaWxlKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cbiAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICBjb25zb2xlLmxvZyhgSGFiaXRzIGZpbGUgbm90IGZvdW5kOiAke2ZpbGVQYXRofWApO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgIGNvbnN0IGhhYml0cyA9IHRoaXMuZXh0cmFjdEhhYml0cyhjb250ZW50KTtcbiAgICAgIHJldHVybiBoYWJpdHM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgaGFiaXRzIGZpbGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdEhhYml0cyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaGFiaXRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIGNvbnN0IHRyaW1tZWRMaW5lID0gbGluZS50cmltKCk7XG5cbiAgICAgIC8vIFN1cHBvcnQgdmFyaW91cyBtYXJrZG93biBsaXN0IGZvcm1hdHNcbiAgICAgIC8vIC0gWyBdIEhhYml0IG5hbWVcbiAgICAgIC8vIC0gSGFiaXQgbmFtZVxuICAgICAgLy8gKiBIYWJpdCBuYW1lXG4gICAgICAvLyAxLiBIYWJpdCBuYW1lXG4gICAgICBjb25zdCBjaGVja2JveE1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL15bLSpdXFxzKlxcW1sgeF1cXF1cXHMqKC4rKSQvaSk7XG4gICAgICBjb25zdCBsaXN0TWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXlstKl1cXHMrKC4rKSQvKTtcbiAgICAgIGNvbnN0IG51bWJlcmVkTWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXlxcZCtcXC5cXHMrKC4rKSQvKTtcblxuICAgICAgaWYgKGNoZWNrYm94TWF0Y2gpIHtcbiAgICAgICAgaGFiaXRzLnB1c2goY2hlY2tib3hNYXRjaFsxXS50cmltKCkpO1xuICAgICAgfSBlbHNlIGlmIChsaXN0TWF0Y2gpIHtcbiAgICAgICAgaGFiaXRzLnB1c2gobGlzdE1hdGNoWzFdLnRyaW0oKSk7XG4gICAgICB9IGVsc2UgaWYgKG51bWJlcmVkTWF0Y2gpIHtcbiAgICAgICAgaGFiaXRzLnB1c2gobnVtYmVyZWRNYXRjaFsxXS50cmltKCkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBoYWJpdHM7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBIYWJpdERhdGEgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEhhYml0RGF0YVN0b3JlIHtcbiAgcHJpdmF0ZSBkYXRhOiBIYWJpdERhdGEgPSB7fTtcbiAgcHJpdmF0ZSBzYXZlQ2FsbGJhY2s6ICgpID0+IFByb21pc2U8dm9pZD47XG5cbiAgY29uc3RydWN0b3Ioc2F2ZUNhbGxiYWNrOiAoKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgdGhpcy5zYXZlQ2FsbGJhY2sgPSBzYXZlQ2FsbGJhY2s7XG4gIH1cblxuICBsb2FkRGF0YShkYXRhOiBIYWJpdERhdGEpOiB2b2lkIHtcbiAgICB0aGlzLmRhdGEgPSBkYXRhIHx8IHt9O1xuICAgIGlmICghdGhpcy5kYXRhLmhhYml0cykge1xuICAgICAgdGhpcy5kYXRhLmhhYml0cyA9IFtdO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuZGF0YS5jb2xvcnMpIHtcbiAgICAgIHRoaXMuZGF0YS5jb2xvcnMgPSB7fTtcbiAgICB9XG4gIH1cblxuICBnZXREYXRhKCk6IEhhYml0RGF0YSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfVxuXG4gIGdldEhhYml0cygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5oYWJpdHMgfHwgW107XG4gIH1cblxuICBhZGRIYWJpdChoYWJpdE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHRyaW1tZWROYW1lID0gaGFiaXROYW1lLnRyaW0oKTtcbiAgICBpZiAoIXRyaW1tZWROYW1lKSByZXR1cm4gZmFsc2U7XG5cbiAgICBpZiAoIXRoaXMuZGF0YS5oYWJpdHMpIHtcbiAgICAgIHRoaXMuZGF0YS5oYWJpdHMgPSBbXTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmhhYml0cy5pbmNsdWRlcyh0cmltbWVkTmFtZSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmRhdGEuaGFiaXRzLnB1c2godHJpbW1lZE5hbWUpO1xuICAgIHRoaXMuZGF0YVt0cmltbWVkTmFtZV0gPSB7fTtcbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmVtb3ZlSGFiaXQoaGFiaXROYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5oYWJpdHMpIHJldHVybiBmYWxzZTtcblxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kYXRhLmhhYml0cy5pbmRleE9mKGhhYml0TmFtZSk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgdGhpcy5kYXRhLmhhYml0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGRlbGV0ZSB0aGlzLmRhdGFbaGFiaXROYW1lXTtcbiAgICBpZiAodGhpcy5kYXRhLmNvbG9ycyAmJiB0aGlzLmRhdGEuY29sb3JzW2hhYml0TmFtZV0pIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmRhdGEuY29sb3JzW2hhYml0TmFtZV07XG4gICAgfVxuICAgIHRoaXMuc2F2ZUNhbGxiYWNrKCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZW5hbWVIYWJpdChvbGROYW1lOiBzdHJpbmcsIG5ld05hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHRyaW1tZWROZXdOYW1lID0gbmV3TmFtZS50cmltKCk7XG4gICAgaWYgKCF0cmltbWVkTmV3TmFtZSB8fCAhdGhpcy5kYXRhLmhhYml0cykgcmV0dXJuIGZhbHNlO1xuXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmRhdGEuaGFiaXRzLmluZGV4T2Yob2xkTmFtZSk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5oYWJpdHMuaW5jbHVkZXModHJpbW1lZE5ld05hbWUpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy5kYXRhLmhhYml0c1tpbmRleF0gPSB0cmltbWVkTmV3TmFtZTtcblxuICAgIGlmICh0aGlzLmRhdGFbb2xkTmFtZV0pIHtcbiAgICAgIHRoaXMuZGF0YVt0cmltbWVkTmV3TmFtZV0gPSB0aGlzLmRhdGFbb2xkTmFtZV07XG4gICAgICBkZWxldGUgdGhpcy5kYXRhW29sZE5hbWVdO1xuICAgIH1cbiAgICAvLyBtb3ZlIGNvbG9yIGlmIHByZXNlbnRcbiAgICBpZiAodGhpcy5kYXRhLmNvbG9ycyAmJiB0aGlzLmRhdGEuY29sb3JzW29sZE5hbWVdKSB7XG4gICAgICB0aGlzLmRhdGEuY29sb3JzW3RyaW1tZWROZXdOYW1lXSA9IHRoaXMuZGF0YS5jb2xvcnNbb2xkTmFtZV07XG4gICAgICBkZWxldGUgdGhpcy5kYXRhLmNvbG9yc1tvbGROYW1lXTtcbiAgICB9XG5cbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgdG9nZ2xlSGFiaXQoaGFiaXROYW1lOiBzdHJpbmcsIGRhdGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5kYXRhW2hhYml0TmFtZV0pIHtcbiAgICAgIHRoaXMuZGF0YVtoYWJpdE5hbWVdID0ge307XG4gICAgfVxuXG4gICAgY29uc3QgaGFiaXREYXRhID0gdGhpcy5kYXRhW2hhYml0TmFtZV0gYXMgeyBbZGF0ZTogc3RyaW5nXTogYm9vbGVhbiB9O1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGhhYml0RGF0YVtkYXRlXSB8fCBmYWxzZTtcbiAgICBoYWJpdERhdGFbZGF0ZV0gPSAhY3VycmVudFZhbHVlO1xuXG4gICAgdGhpcy5zYXZlQ2FsbGJhY2soKTtcblxuICAgIHJldHVybiBoYWJpdERhdGFbZGF0ZV07XG4gIH1cblxuICBnZXRIYWJpdENvbG9yKGhhYml0TmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLmNvbG9ycyA/IHRoaXMuZGF0YS5jb2xvcnNbaGFiaXROYW1lXSA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHNldEhhYml0Q29sb3IoaGFiaXROYW1lOiBzdHJpbmcsIGNvbG9yOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5jb2xvcnMpIHRoaXMuZGF0YS5jb2xvcnMgPSB7fTtcbiAgICB0aGlzLmRhdGEuY29sb3JzW2hhYml0TmFtZV0gPSBjb2xvcjtcbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICB9XG5cbiAgaXNIYWJpdENvbXBsZXRlZChoYWJpdE5hbWU6IHN0cmluZywgZGF0ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgaGFiaXREYXRhID0gdGhpcy5kYXRhW2hhYml0TmFtZV07XG4gICAgaWYgKHR5cGVvZiBoYWJpdERhdGEgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KGhhYml0RGF0YSkpIHtcbiAgICAgIHJldHVybiBoYWJpdERhdGFbZGF0ZV0gfHwgZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGdldEhhYml0U3RyZWFrKGhhYml0TmFtZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBoYWJpdERhdGEgPSB0aGlzLmRhdGFbaGFiaXROYW1lXTtcbiAgICBpZiAoIWhhYml0RGF0YSB8fCB0eXBlb2YgaGFiaXREYXRhICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KGhhYml0RGF0YSkpIHJldHVybiAwO1xuXG4gICAgbGV0IHN0cmVhayA9IDA7XG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgIHRvZGF5LnNldEhvdXJzKDAsIDAsIDAsIDApO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzNjU7IGkrKykge1xuICAgICAgY29uc3QgY2hlY2tEYXRlID0gbmV3IERhdGUodG9kYXkpO1xuICAgICAgY2hlY2tEYXRlLnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpIC0gaSk7XG4gICAgICBjb25zdCBkYXRlU3RyID0gdGhpcy5mb3JtYXREYXRlKGNoZWNrRGF0ZSk7XG5cbiAgICAgIGlmICgoaGFiaXREYXRhIGFzIHsgW2RhdGU6IHN0cmluZ106IGJvb2xlYW4gfSlbZGF0ZVN0cl0pIHtcbiAgICAgICAgc3RyZWFrKys7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3RyZWFrO1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXREYXRlKGRhdGU6IERhdGUpOiBzdHJpbmcge1xuICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgfVxufVxuIiwgImV4cG9ydCBpbnRlcmZhY2UgSGFiaXRUcmFja2VyU2V0dGluZ3Mge1xuICBoYWJpdHNGaWxlUGF0aDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEhhYml0RGF0YSB7XG4gIGhhYml0cz86IHN0cmluZ1tdO1xuICBjb2xvcnM/OiB7IFtoYWJpdE5hbWU6IHN0cmluZ106IHN0cmluZyB9O1xuICAvLyBoYWJpdCBlbnRyaWVzIG1hcCB0byBkYXRlLT5ib29sZWFuLCBidXQgYWxsb3cgYW55IGZvciBmbGV4aWJpbGl0eVxuICBbaGFiaXROYW1lOiBzdHJpbmddOiBhbnk7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBIYWJpdFRyYWNrZXJT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UUFDVixDQUFDO0FBQ0QsZUFBTztBQUFBLE1BQ1Q7QUFBQSxJQUNGO0FBRUEsUUFBSSxNQUFNO0FBQ1IsZ0JBQVUsV0FBVyxJQUFJO0FBQUEsSUFDM0I7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLGNBQTZCO0FBQ2pDLFVBQU0sU0FBUyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsdUJBQXVCO0FBQ3pFLGVBQVcsUUFBUSxRQUFRO0FBQ3pCLFlBQU0sT0FBTyxLQUFLO0FBQ2xCLFlBQU0sZ0JBQWdCLEtBQUssVUFBVSxVQUFVO0FBQy9DLFlBQU0sZ0JBQWlCLEtBQWE7QUFLcEMsVUFBSSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsU0FBUyxhQUFhLEdBQUc7QUFDNUQsY0FBTSxLQUFLLE9BQU87QUFBQSxNQUNwQjtBQUFBLElBQ0Y7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLGVBQThCO0FBQ2xDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDM0U7QUFBQSxFQUVBLE1BQU0sZUFBOEI7QUFDbEMsVUFBTSxNQUFNLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDcEM7QUFBQSxFQUVBLE1BQU0sZ0JBQStCO0FBQ25DLFVBQU0sTUFBTSxTQUFTLEtBQUssVUFBVSxRQUFRLENBQUM7QUFBQSxFQUMvQztBQUFBLEVBRUEsV0FBaUI7QUFBQSxFQUVqQjtBQUNGOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
