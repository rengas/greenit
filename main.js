/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => HabitTrackerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/habitView.ts
var import_obsidian = require("obsidian");
var VIEW_TYPE_HABIT_TRACKER = "habit-tracker-view";
var HabitTrackerView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.selectedHabit = null;
    this.viewType = "year";
    this.selectedMonth = /* @__PURE__ */ new Date();
    this.selectedYear = (/* @__PURE__ */ new Date()).getFullYear();
    this.plugin = plugin;
    this.selectedMonth.setDate(1);
  }
  getViewType() {
    return VIEW_TYPE_HABIT_TRACKER;
  }
  getDisplayText() {
    return "Habit Tracker";
  }
  getIcon() {
    return "calendar-check";
  }
  async onOpen() {
    await this.render();
  }
  async render() {
    console.log("RENDER START: selectedHabit =", this.selectedHabit, "Type:", typeof this.selectedHabit);
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("habit-tracker-container");
    this.renderControls(container);
    const habits = this.plugin.dataStore.getHabits();
    console.log("RENDER: Habits from store =", habits);
    if (habits.length === 0) {
      container.createEl("div", {
        text: 'No habits yet. Click "Add New Habit" to get started!',
        cls: "no-habits-message"
      });
      console.log("RENDER: No habits, exiting.");
      return;
    }
    if (!this.selectedHabit || !habits.includes(this.selectedHabit)) {
      if (habits.length > 0) {
        this.selectedHabit = habits[0];
      } else {
        this.selectedHabit = null;
        container.createEl("div", {
          text: 'No habits yet. Click "Add New Habit" to get started!',
          cls: "no-habits-message"
        });
        return;
      }
    }
    if (this.selectedHabit) {
      if (this.viewType === "year") {
        this.renderYearView(container, this.selectedHabit);
      } else if (this.viewType === "month") {
        this.renderMonthView(container, this.selectedHabit);
      } else if (this.viewType === "year-overview") {
        this.renderYearOverview(container, this.selectedHabit);
      }
    }
  }
  renderControls(container) {
    const controlsSection = container.createEl("div", { cls: "habit-controls" });
    const addButton = controlsSection.createEl("button", {
      text: "Add",
      cls: "habit-control-button"
    });
    addButton.addEventListener("click", () => {
      new AddHabitModal(this.app, this.plugin, async () => {
        await this.render();
      }).open();
    });
    const habits = this.plugin.dataStore.getHabits();
    if (habits.length > 0) {
      const selectorContainer = controlsSection.createEl("div", { cls: "habit-selector-container" });
      const customDropdown = selectorContainer.createEl("div", { cls: "custom-habit-dropdown" });
      const dropdownButton = customDropdown.createEl("button", { cls: "habit-dropdown-button" });
      dropdownButton.createEl("span", { text: this.selectedHabit || "Select Habit", cls: "habit-dropdown-text" });
      dropdownButton.createEl("span", { text: "\u25BC", cls: "habit-dropdown-arrow" });
      const dropdownMenu = customDropdown.createEl("div", { cls: "habit-dropdown-menu" });
      habits.forEach((habit) => {
        const item = dropdownMenu.createEl("div", { cls: "habit-dropdown-item" });
        if (habit === this.selectedHabit) {
          item.addClass("active");
        }
        const habitText = item.createEl("span", { text: habit, cls: "habit-item-text" });
        habitText.addEventListener("click", async (e) => {
          e.stopPropagation();
          this.selectedHabit = habit;
          dropdownMenu.removeClass("show");
          await this.render();
        });
      });
      dropdownButton.addEventListener("click", (e) => {
        e.stopPropagation();
        const isShown = dropdownMenu.hasClass("show");
        if (isShown) {
          dropdownMenu.removeClass("show");
        } else {
          dropdownMenu.addClass("show");
        }
      });
      this.registerDomEvent(document, "click", (e) => {
        if (!customDropdown.contains(e.target)) {
          dropdownMenu.removeClass("show");
        }
      });
      console.log("Rendering Edit Button. selectedHabit:", this.selectedHabit, "Type:", typeof this.selectedHabit);
      const editButton = controlsSection.createEl("button", {
        text: "Edit",
        cls: "habit-control-button"
      });
      editButton.disabled = !this.selectedHabit;
      editButton.addEventListener("click", () => {
        if (this.selectedHabit) {
          new EditHabitModal(this.app, this.plugin, this.selectedHabit, async (newName) => {
            this.selectedHabit = newName;
            await this.render();
          }).open();
        }
      });
      const deleteButton = controlsSection.createEl("button", {
        text: "Delete",
        cls: "habit-control-button"
      });
      deleteButton.disabled = !this.selectedHabit;
      deleteButton.addEventListener("click", () => {
        if (this.selectedHabit) {
          new DeleteHabitModal(this.app, this.plugin, this.selectedHabit, async () => {
            this.selectedHabit = null;
            await this.render();
          }).open();
        }
      });
      const viewControlsContainer = controlsSection.createEl("div", { cls: "view-controls-container" });
      const radioGroup = viewControlsContainer.createEl("div", { cls: "view-radio-group" });
      const viewOptions = [
        { value: "year", text: "Year", title: "GitHub-style contribution grid" },
        { value: "month", text: "Month", title: "Traditional monthly calendar" },
        { value: "year-overview", text: "Year Overview", title: "All 12 months at a glance" }
      ];
      viewOptions.forEach((option) => {
        const radioLabel = radioGroup.createEl("label", { cls: "view-radio-label" });
        const radioInput = radioLabel.createEl("input", {
          type: "radio",
          attr: {
            name: "view-type",
            value: option.value
          },
          cls: "view-radio-input"
        });
        if (option.value === this.viewType) {
          radioInput.checked = true;
        }
        radioInput.addEventListener("change", async () => {
          if (radioInput.checked) {
            this.viewType = option.value;
            await this.render();
          }
        });
        radioLabel.createEl("span", { text: option.text, cls: "view-radio-text" });
        radioLabel.setAttribute("title", option.title);
      });
      if (this.viewType === "month") {
        const monthNav = viewControlsContainer.createEl("div", { cls: "month-navigation" });
        const prevButton = monthNav.createEl("button", {
          text: "\u25C0",
          cls: "month-nav-button"
        });
        prevButton.addEventListener("click", async () => {
          this.selectedMonth.setMonth(this.selectedMonth.getMonth() - 1);
          await this.render();
        });
        const monthLabel = monthNav.createEl("span", {
          text: this.selectedMonth.toLocaleDateString("en-US", { month: "long", year: "numeric" }),
          cls: "month-label-text"
        });
        const nextButton = monthNav.createEl("button", {
          text: "\u25B6",
          cls: "month-nav-button"
        });
        nextButton.addEventListener("click", async () => {
          this.selectedMonth.setMonth(this.selectedMonth.getMonth() + 1);
          await this.render();
        });
        const todayButton = monthNav.createEl("button", {
          text: "Today",
          cls: "month-nav-button today-button"
        });
        todayButton.addEventListener("click", async () => {
          this.selectedMonth = /* @__PURE__ */ new Date();
          this.selectedMonth.setDate(1);
          await this.render();
        });
      }
    }
  }
  renderYearView(container, habitName) {
    const section = container.createEl("div", { cls: "habit-section github-style" });
    const header = section.createEl("div", { cls: "github-header" });
    header.createEl("div", { text: habitName, cls: "habit-name" });
    const yearContainer = section.createEl("div", { cls: "github-year-container" });
    const graphContainer = yearContainer.createEl("div", { cls: "github-graph-container" });
    const monthLabels = graphContainer.createEl("div", { cls: "github-month-labels" });
    monthLabels.createEl("div", { cls: "github-days-label-spacer" });
    const monthLabelContainer = monthLabels.createEl("div", { cls: "github-month-label-container" });
    const gridWrapper = graphContainer.createEl("div", { cls: "github-grid-wrapper" });
    const dayLabels = gridWrapper.createEl("div", { cls: "github-day-labels" });
    ["Mon", "Wed", "Fri"].forEach((day, index) => {
      const label = dayLabels.createEl("div", { cls: "github-day-label" });
      label.style.gridRow = `${index * 2 + 2}`;
      label.textContent = day;
    });
    const grid = gridWrapper.createEl("div", { cls: "github-contribution-grid" });
    const startDate = new Date(this.selectedYear, 0, 1);
    const startDay = startDate.getDay();
    const daysToSubtract = startDay === 0 ? 6 : startDay - 1;
    startDate.setDate(startDate.getDate() - daysToSubtract);
    const endDate = new Date(this.selectedYear, 11, 31);
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    let currentMonthLabel = -1;
    let weekIndex = 0;
    const totalDays = Math.ceil((endDate.getTime() - startDate.getTime()) / (1e3 * 60 * 60 * 24)) + 1;
    const totalWeeks = Math.ceil(totalDays / 7);
    for (let week = 0; week < totalWeeks; week++) {
      for (let day = 0; day < 7; day++) {
        const currentDate = new Date(startDate);
        currentDate.setDate(startDate.getDate() + week * 7 + day);
        const dateStr = this.formatDate(currentDate);
        const cell = grid.createEl("div", { cls: "github-cell" });
        cell.style.gridColumn = `${week + 1}`;
        cell.style.gridRow = `${day + 1}`;
        if (currentDate.getFullYear() !== this.selectedYear) {
          cell.addClass("outside-year");
        } else {
          const isCompleted = this.plugin.dataStore.isHabitCompleted(habitName, dateStr);
          if (isCompleted) {
            cell.addClass("completed");
          }
          if (this.isSameDay(currentDate, today)) {
            cell.addClass("today");
          }
          cell.setAttribute("data-date", dateStr);
          cell.setAttribute("title", `${habitName} - ${dateStr}`);
          cell.addEventListener("click", () => {
            const newState = this.plugin.dataStore.toggleHabit(habitName, dateStr);
            if (newState) {
              cell.addClass("completed");
            } else {
              cell.removeClass("completed");
            }
          });
        }
        if (day === 0 && currentDate.getFullYear() === this.selectedYear) {
          const month = currentDate.getMonth();
          if (month !== currentMonthLabel && week > 0) {
            const monthLabel = monthLabelContainer.createEl("div", { cls: "github-month-label" });
            monthLabel.textContent = currentDate.toLocaleDateString("en-US", { month: "short" });
            monthLabel.style.gridColumn = `${week + 1}`;
            currentMonthLabel = month;
          }
        }
      }
    }
    const yearSelector = yearContainer.createEl("div", { cls: "github-year-selector" });
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    const earliestYear = this.getEarliestYearWithData(habitName);
    const startYear = Math.min(earliestYear, currentYear);
    for (let year = startYear; year <= currentYear; year++) {
      const yearButton = yearSelector.createEl("button", {
        text: year.toString(),
        cls: "github-year-button"
      });
      if (year === this.selectedYear) {
        yearButton.addClass("active");
      }
      if (year === currentYear) {
        yearButton.addClass("current-year");
      }
      yearButton.addEventListener("click", async () => {
        this.selectedYear = year;
        await this.render();
      });
    }
  }
  renderMonthView(container, habitName) {
    const section = container.createEl("div", { cls: "habit-section calendar-view" });
    section.createEl("div", { text: habitName, cls: "habit-name" });
    const calendar = section.createEl("div", { cls: "calendar-month" });
    const weekDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
    const weekDayHeader = calendar.createEl("div", { cls: "calendar-weekdays" });
    weekDays.forEach((day) => {
      weekDayHeader.createEl("div", { text: day, cls: "calendar-weekday" });
    });
    const daysGrid = calendar.createEl("div", { cls: "calendar-days-grid" });
    const year = this.selectedMonth.getFullYear();
    const month = this.selectedMonth.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const startingDayOfWeek = firstDay.getDay();
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    for (let i = 0; i < startingDayOfWeek; i++) {
      daysGrid.createEl("div", { cls: "calendar-day empty" });
    }
    for (let day = 1; day <= lastDay.getDate(); day++) {
      const currentDate = new Date(year, month, day);
      const dateStr = this.formatDate(currentDate);
      const dayCell = daysGrid.createEl("div", { cls: "calendar-day" });
      dayCell.createEl("div", { text: day.toString(), cls: "calendar-day-number" });
      const isCompleted = this.plugin.dataStore.isHabitCompleted(habitName, dateStr);
      if (isCompleted) {
        dayCell.addClass("completed");
      }
      if (this.isSameDay(currentDate, today)) {
        dayCell.addClass("today");
      }
      dayCell.setAttribute("data-date", dateStr);
      dayCell.setAttribute("title", `${habitName} - ${dateStr}`);
      dayCell.addEventListener("click", () => {
        const newState = this.plugin.dataStore.toggleHabit(habitName, dateStr);
        if (newState) {
          dayCell.addClass("completed");
        } else {
          dayCell.removeClass("completed");
        }
      });
    }
  }
  renderYearOverview(container, habitName) {
    const section = container.createEl("div", { cls: "habit-section year-overview" });
    const header = section.createEl("div", { cls: "year-overview-header" });
    header.createEl("div", { text: habitName, cls: "habit-name" });
    const yearContainer = section.createEl("div", { cls: "year-overview-container" });
    const yearGrid = yearContainer.createEl("div", { cls: "year-overview-grid" });
    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    const currentMonth = (/* @__PURE__ */ new Date()).getMonth();
    const isCurrentYear = this.selectedYear === currentYear;
    const lastMonth = isCurrentYear ? currentMonth : 11;
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    const todayDate = today.getDate();
    for (let month = 0; month <= lastMonth; month++) {
      const monthContainer = yearGrid.createEl("div", { cls: "year-overview-month" });
      monthContainer.createEl("div", { text: monthNames[month], cls: "year-overview-month-name" });
      const monthDays = monthContainer.createEl("div", { cls: "year-overview-days" });
      const daysInMonth = new Date(this.selectedYear, month + 1, 0).getDate();
      const isCurrentMonth = isCurrentYear && month === currentMonth;
      const lastDay = isCurrentMonth ? todayDate : daysInMonth;
      for (let day = 1; day <= lastDay; day++) {
        const currentDate = new Date(this.selectedYear, month, day);
        const dateStr = this.formatDate(currentDate);
        const dayCell = monthDays.createEl("div", { cls: "year-overview-day" });
        dayCell.createEl("span", { text: day.toString(), cls: "year-overview-day-number" });
        const isCompleted = this.plugin.dataStore.isHabitCompleted(habitName, dateStr);
        if (isCompleted) {
          dayCell.addClass("completed");
        }
        if (this.isSameDay(currentDate, today)) {
          dayCell.addClass("today");
        }
        dayCell.setAttribute("data-date", dateStr);
        dayCell.setAttribute("title", `${habitName} - ${dateStr}`);
        dayCell.addEventListener("click", () => {
          const newState = this.plugin.dataStore.toggleHabit(habitName, dateStr);
          if (newState) {
            dayCell.addClass("completed");
          } else {
            dayCell.removeClass("completed");
          }
        });
      }
    }
    const yearSelector = yearContainer.createEl("div", { cls: "year-overview-year-selector" });
    const earliestYear = this.getEarliestYearWithData(habitName);
    const startYear = Math.min(earliestYear, currentYear);
    for (let year = startYear; year <= currentYear; year++) {
      const yearButton = yearSelector.createEl("button", {
        text: year.toString(),
        cls: "year-overview-year-button"
      });
      if (year === this.selectedYear) {
        yearButton.addClass("active");
      }
      if (year === currentYear) {
        yearButton.addClass("current-year");
      }
      yearButton.addEventListener("click", async () => {
        this.selectedYear = year;
        await this.render();
      });
    }
  }
  formatDate(date) {
    return date.toISOString().split("T")[0];
  }
  isSameDay(date1, date2) {
    return date1.getFullYear() === date2.getFullYear() && date1.getMonth() === date2.getMonth() && date1.getDate() === date2.getDate();
  }
  getEarliestYearWithData(habitName) {
    const currentYear = (/* @__PURE__ */ new Date()).getFullYear();
    const habitData = this.plugin.dataStore.getData()[habitName];
    if (!habitData || typeof habitData !== "object" || Array.isArray(habitData)) {
      return currentYear;
    }
    const dates = Object.keys(habitData);
    if (dates.length === 0) {
      return currentYear;
    }
    let earliestYear = currentYear;
    dates.forEach((dateStr) => {
      const year = parseInt(dateStr.split("-")[0]);
      if (year < earliestYear) {
        earliestYear = year;
      }
    });
    return earliestYear;
  }
  async onClose() {
  }
};
var AddHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Add" });
    let habitName = "";
    new import_obsidian.Setting(contentEl).setName("Habit Name").setDesc("Enter the name of your new habit").addText((text) => {
      text.setPlaceholder("e.g., Exercise, Read, Meditate").onChange((value) => {
        habitName = value;
      });
      text.inputEl.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          this.submit(habitName);
        }
      });
      setTimeout(() => text.inputEl.focus(), 10);
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Add").setCta().onClick(() => {
      this.submit(habitName);
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  async submit(habitName) {
    if (!habitName.trim()) {
      return;
    }
    const success = this.plugin.dataStore.addHabit(habitName);
    if (success) {
      this.close();
      await this.onSubmit();
    } else {
      const errorEl = this.contentEl.createEl("div", {
        text: "This habit already exists or the name is invalid!",
        cls: "habit-error-message"
      });
      setTimeout(() => errorEl.remove(), 3e3);
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var EditHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, oldName, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.oldName = oldName;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Edit Habit" });
    let habitName = this.oldName;
    new import_obsidian.Setting(contentEl).setName("Habit Name").setDesc("Enter the new name for your habit").addText((text) => {
      text.setValue(this.oldName).setPlaceholder("e.g., Exercise, Read, Meditate").onChange((value) => {
        habitName = value;
      });
      text.inputEl.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          this.submit(habitName);
        }
      });
      setTimeout(() => {
        text.inputEl.focus();
        text.inputEl.select();
      }, 10);
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Save").setCta().onClick(() => {
      this.submit(habitName);
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  async submit(habitName) {
    if (!habitName.trim() || habitName === this.oldName) {
      this.close();
      return;
    }
    const success = this.plugin.dataStore.renameHabit(this.oldName, habitName);
    if (success) {
      this.close();
      await this.onSubmit(habitName);
    } else {
      const errorEl = this.contentEl.createEl("div", {
        text: "This habit name already exists or is invalid!",
        cls: "habit-error-message"
      });
      setTimeout(() => errorEl.remove(), 3e3);
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var DeleteHabitModal = class extends import_obsidian.Modal {
  constructor(app, plugin, habitName, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.habitName = habitName;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Delete Habit" });
    contentEl.createEl("p", {
      text: `Are you sure you want to delete "${this.habitName}"? This will remove all progress data for this habit.`
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Delete").setWarning().onClick(async () => {
      this.plugin.dataStore.removeHabit(this.habitName);
      this.close();
      await this.onSubmit();
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings.ts
var import_obsidian2 = require("obsidian");
var HabitTrackerSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Habit Tracker Settings" });
    new import_obsidian2.Setting(containerEl).setName("Habits File Path").setDesc("Path to the markdown file containing your list of habits (e.g., habits.md)").addText((text) => text.setPlaceholder("habits.md").setValue(this.plugin.settings.habitsFilePath).onChange(async (value) => {
      this.plugin.settings.habitsFilePath = value;
      await this.plugin.saveSettings();
      this.plugin.refreshView();
    }));
  }
};

// src/habitParser.ts
var import_obsidian3 = require("obsidian");
var HabitParser = class {
  constructor(app) {
    this.app = app;
  }
  async parseHabitsFromFile(filePath) {
    const file = this.app.vault.getAbstractFileByPath(filePath);
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      console.log(`Habits file not found: ${filePath}`);
      return [];
    }
    try {
      const content = await this.app.vault.read(file);
      const habits = this.extractHabits(content);
      return habits;
    } catch (error) {
      console.error("Error reading habits file:", error);
      return [];
    }
  }
  extractHabits(content) {
    const habits = [];
    const lines = content.split("\n");
    for (const line of lines) {
      const trimmedLine = line.trim();
      const checkboxMatch = trimmedLine.match(/^[-*]\s*\[[ x]\]\s*(.+)$/i);
      const listMatch = trimmedLine.match(/^[-*]\s+(.+)$/);
      const numberedMatch = trimmedLine.match(/^\d+\.\s+(.+)$/);
      if (checkboxMatch) {
        habits.push(checkboxMatch[1].trim());
      } else if (listMatch) {
        habits.push(listMatch[1].trim());
      } else if (numberedMatch) {
        habits.push(numberedMatch[1].trim());
      }
    }
    return habits;
  }
};

// src/dataStore.ts
var HabitDataStore = class {
  constructor(saveCallback) {
    this.data = {};
    this.saveCallback = saveCallback;
  }
  loadData(data) {
    this.data = data || {};
    if (!this.data.habits) {
      this.data.habits = [];
    }
  }
  getData() {
    return this.data;
  }
  getHabits() {
    return this.data.habits || [];
  }
  addHabit(habitName) {
    const trimmedName = habitName.trim();
    if (!trimmedName)
      return false;
    if (!this.data.habits) {
      this.data.habits = [];
    }
    if (this.data.habits.includes(trimmedName)) {
      return false;
    }
    this.data.habits.push(trimmedName);
    this.data[trimmedName] = {};
    this.saveCallback();
    return true;
  }
  removeHabit(habitName) {
    if (!this.data.habits)
      return false;
    const index = this.data.habits.indexOf(habitName);
    if (index === -1)
      return false;
    this.data.habits.splice(index, 1);
    delete this.data[habitName];
    this.saveCallback();
    return true;
  }
  renameHabit(oldName, newName) {
    const trimmedNewName = newName.trim();
    if (!trimmedNewName || !this.data.habits)
      return false;
    const index = this.data.habits.indexOf(oldName);
    if (index === -1)
      return false;
    if (this.data.habits.includes(trimmedNewName)) {
      return false;
    }
    this.data.habits[index] = trimmedNewName;
    if (this.data[oldName]) {
      this.data[trimmedNewName] = this.data[oldName];
      delete this.data[oldName];
    }
    this.saveCallback();
    return true;
  }
  toggleHabit(habitName, date) {
    if (!this.data[habitName]) {
      this.data[habitName] = {};
    }
    const habitData = this.data[habitName];
    const currentValue = habitData[date] || false;
    habitData[date] = !currentValue;
    this.saveCallback();
    return habitData[date];
  }
  isHabitCompleted(habitName, date) {
    const habitData = this.data[habitName];
    if (typeof habitData === "object" && !Array.isArray(habitData)) {
      return habitData[date] || false;
    }
    return false;
  }
  getHabitStreak(habitName) {
    const habitData = this.data[habitName];
    if (!habitData || typeof habitData !== "object" || Array.isArray(habitData))
      return 0;
    let streak = 0;
    const today = /* @__PURE__ */ new Date();
    today.setHours(0, 0, 0, 0);
    for (let i = 0; i < 365; i++) {
      const checkDate = new Date(today);
      checkDate.setDate(today.getDate() - i);
      const dateStr = this.formatDate(checkDate);
      if (habitData[dateStr]) {
        streak++;
      } else {
        break;
      }
    }
    return streak;
  }
  formatDate(date) {
    return date.toISOString().split("T")[0];
  }
};

// src/types.ts
var DEFAULT_SETTINGS = {
  habitsFilePath: "habits.md"
};

// src/main.ts
var HabitTrackerPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.habitParser = new HabitParser(this.app);
    this.dataStore = new HabitDataStore(async () => {
      await this.saveHabitData();
    });
    const habitData = await this.loadData();
    this.dataStore.loadData(habitData || {});
    this.registerView(
      VIEW_TYPE_HABIT_TRACKER,
      (leaf) => new HabitTrackerView(leaf, this)
    );
    this.addRibbonIcon("calendar-check", "Open Habit Tracker", () => {
      this.activateView();
    });
    this.addCommand({
      id: "open-habit-tracker",
      name: "Open Habit Tracker",
      callback: () => {
        this.activateView();
      }
    });
    this.addSettingTab(new HabitTrackerSettingTab(this.app, this));
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_HABIT_TRACKER)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (rightLeaf) {
        await rightLeaf.setViewState({
          type: VIEW_TYPE_HABIT_TRACKER,
          active: true
        });
        leaf = rightLeaf;
      }
    }
    if (leaf) {
      workspace.revealLeaf(leaf);
    }
  }
  async refreshView() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_HABIT_TRACKER);
    for (const leaf of leaves) {
      const view = leaf.view;
      const currentHabits = this.dataStore.getHabits();
      const selectedHabit = view.selectedHabit;
      if (!selectedHabit || !currentHabits.includes(selectedHabit)) {
        await view.render();
      }
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await super.saveData(this.settings);
  }
  async saveHabitData() {
    await super.saveData(this.dataStore.getData());
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2hhYml0Vmlldy50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2hhYml0UGFyc2VyLnRzIiwgInNyYy9kYXRhU3RvcmUudHMiLCAic3JjL3R5cGVzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBIYWJpdFRyYWNrZXJWaWV3LCBWSUVXX1RZUEVfSEFCSVRfVFJBQ0tFUiB9IGZyb20gJy4vaGFiaXRWaWV3JztcbmltcG9ydCB7IEhhYml0VHJhY2tlclNldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IEhhYml0UGFyc2VyIH0gZnJvbSAnLi9oYWJpdFBhcnNlcic7XG5pbXBvcnQgeyBIYWJpdERhdGFTdG9yZSB9IGZyb20gJy4vZGF0YVN0b3JlJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEhhYml0VHJhY2tlclNldHRpbmdzLCBIYWJpdERhdGEgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGFiaXRUcmFja2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgc2V0dGluZ3M6IEhhYml0VHJhY2tlclNldHRpbmdzO1xuICBoYWJpdFBhcnNlcjogSGFiaXRQYXJzZXI7XG4gIGRhdGFTdG9yZTogSGFiaXREYXRhU3RvcmU7XG5cbiAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICB0aGlzLmhhYml0UGFyc2VyID0gbmV3IEhhYml0UGFyc2VyKHRoaXMuYXBwKTtcbiAgICB0aGlzLmRhdGFTdG9yZSA9IG5ldyBIYWJpdERhdGFTdG9yZShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVIYWJpdERhdGEoKTtcbiAgICB9KTtcblxuICAgIC8vIExvYWQgaGFiaXQgZGF0YVxuICAgIGNvbnN0IGhhYml0RGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSBhcyBIYWJpdERhdGE7XG4gICAgdGhpcy5kYXRhU3RvcmUubG9hZERhdGEoaGFiaXREYXRhIHx8IHt9KTtcblxuICAgIC8vIFJlZ2lzdGVyIHZpZXdcbiAgICB0aGlzLnJlZ2lzdGVyVmlldyhcbiAgICAgIFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSLFxuICAgICAgKGxlYWYpID0+IG5ldyBIYWJpdFRyYWNrZXJWaWV3KGxlYWYsIHRoaXMpXG4gICAgKTtcblxuICAgIC8vIEFkZCByaWJib24gaWNvblxuICAgIHRoaXMuYWRkUmliYm9uSWNvbignY2FsZW5kYXItY2hlY2snLCAnT3BlbiBIYWJpdCBUcmFja2VyJywgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICB9KTtcblxuICAgIC8vIEFkZCBjb21tYW5kIHRvIG9wZW4gdmlld1xuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ29wZW4taGFiaXQtdHJhY2tlcicsXG4gICAgICBuYW1lOiAnT3BlbiBIYWJpdCBUcmFja2VyJyxcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBIYWJpdFRyYWNrZXJTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZVZpZXcoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuXG4gICAgbGV0IGxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSKVswXTtcblxuICAgIGlmICghbGVhZikge1xuICAgICAgY29uc3QgcmlnaHRMZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG4gICAgICBpZiAocmlnaHRMZWFmKSB7XG4gICAgICAgIGF3YWl0IHJpZ2h0TGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgIHR5cGU6IFZJRVdfVFlQRV9IQUJJVF9UUkFDS0VSLFxuICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGxlYWYgPSByaWdodExlYWY7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGxlYWYpIHtcbiAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlZnJlc2hWaWV3KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0hBQklUX1RSQUNLRVIpO1xuICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgSGFiaXRUcmFja2VyVmlldztcbiAgICAgIGNvbnN0IGN1cnJlbnRIYWJpdHMgPSB0aGlzLmRhdGFTdG9yZS5nZXRIYWJpdHMoKTtcbiAgICAgIGNvbnN0IHNlbGVjdGVkSGFiaXQgPSAodmlldyBhcyBhbnkpLnNlbGVjdGVkSGFiaXQ7IC8vIEFjY2VzcyBwcml2YXRlIG1lbWJlciBmb3IgY2hlY2tcblxuICAgICAgLy8gT25seSByZS1yZW5kZXIgaWYgdGhlIHNlbGVjdGVkIGhhYml0IGlzIG5vIGxvbmdlciB2YWxpZFxuICAgICAgLy8gb3IgaWYgbm8gaGFiaXQgaXMgc2VsZWN0ZWQgYW5kIHRoZXJlIGFyZSBoYWJpdHMgYXZhaWxhYmxlLlxuICAgICAgLy8gVGhpcyBwcmV2ZW50cyBjbG9iYmVyaW5nIGEgdmFsaWQgc3RhdGUgZHVlIHRvIGEgYmFja2dyb3VuZCByZWZyZXNoLlxuICAgICAgaWYgKCFzZWxlY3RlZEhhYml0IHx8ICFjdXJyZW50SGFiaXRzLmluY2x1ZGVzKHNlbGVjdGVkSGFiaXQpKSB7XG4gICAgICAgIGF3YWl0IHZpZXcucmVuZGVyKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHN1cGVyLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZUhhYml0RGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBzdXBlci5zYXZlRGF0YSh0aGlzLmRhdGFTdG9yZS5nZXREYXRhKCkpO1xuICB9XG5cbiAgb251bmxvYWQoKTogdm9pZCB7XG4gICAgLy8gQ2xlYW51cFxuICB9XG59XG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgSGFiaXRUcmFja2VyUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfSEFCSVRfVFJBQ0tFUiA9ICdoYWJpdC10cmFja2VyLXZpZXcnO1xuXG50eXBlIFZpZXdUeXBlID0gJ3llYXInIHwgJ21vbnRoJyB8ICd5ZWFyLW92ZXJ2aWV3JztcblxuZXhwb3J0IGNsYXNzIEhhYml0VHJhY2tlclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG4gIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luO1xuICBwcml2YXRlIHNlbGVjdGVkSGFiaXQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHZpZXdUeXBlOiBWaWV3VHlwZSA9ICd5ZWFyJztcbiAgcHJpdmF0ZSBzZWxlY3RlZE1vbnRoOiBEYXRlID0gbmV3IERhdGUoKTtcbiAgcHJpdmF0ZSBzZWxlY3RlZFllYXI6IG51bWJlciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTtcblxuICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbikge1xuICAgIHN1cGVyKGxlYWYpO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIHRoaXMuc2VsZWN0ZWRNb250aC5zZXREYXRlKDEpO1xuICB9XG5cbiAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gVklFV19UWVBFX0hBQklUX1RSQUNLRVI7XG4gIH1cblxuICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiAnSGFiaXQgVHJhY2tlcic7XG4gIH1cblxuICBnZXRJY29uKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICdjYWxlbmRhci1jaGVjayc7XG4gIH1cblxuICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnUkVOREVSIFNUQVJUOiBzZWxlY3RlZEhhYml0ID0nLCB0aGlzLnNlbGVjdGVkSGFiaXQsICdUeXBlOicsIHR5cGVvZiB0aGlzLnNlbGVjdGVkSGFiaXQpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG4gICAgY29udGFpbmVyLmFkZENsYXNzKCdoYWJpdC10cmFja2VyLWNvbnRhaW5lcicpO1xuXG4gICAgdGhpcy5yZW5kZXJDb250cm9scyhjb250YWluZXIpO1xuXG4gICAgY29uc3QgaGFiaXRzID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmdldEhhYml0cygpO1xuICAgIGNvbnNvbGUubG9nKCdSRU5ERVI6IEhhYml0cyBmcm9tIHN0b3JlID0nLCBoYWJpdHMpO1xuXG4gICAgaWYgKGhhYml0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICB0ZXh0OiAnTm8gaGFiaXRzIHlldC4gQ2xpY2sgXCJBZGQgTmV3IEhhYml0XCIgdG8gZ2V0IHN0YXJ0ZWQhJyxcbiAgICAgICAgY2xzOiAnbm8taGFiaXRzLW1lc3NhZ2UnXG4gICAgICB9KTtcbiAgICAgIGNvbnNvbGUubG9nKCdSRU5ERVI6IE5vIGhhYml0cywgZXhpdGluZy4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJZiBhIGhhYml0IGlzIHNlbGVjdGVkIGJ1dCBubyBsb25nZXIgZXhpc3RzIChlLmcuLCBkZWxldGVkIGZyb20gYW5vdGhlciB2aWV3KSxcbiAgICAvLyBvciBpZiBubyBoYWJpdCBpcyBzZWxlY3RlZCBhdCBhbGwsIGRlZmF1bHQgdG8gdGhlIGZpcnN0IG9uZS5cbiAgICBpZiAoIXRoaXMuc2VsZWN0ZWRIYWJpdCB8fCAhaGFiaXRzLmluY2x1ZGVzKHRoaXMuc2VsZWN0ZWRIYWJpdCkpIHtcbiAgICAgIGlmIChoYWJpdHMubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkSGFiaXQgPSBoYWJpdHNbMF07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBObyBoYWJpdHMgdG8gc2VsZWN0LCBlbnN1cmUgYnV0dG9ucyBhcmUgZGlzYWJsZWQgYW5kIGV4aXQuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IG51bGw7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgIHRleHQ6ICdObyBoYWJpdHMgeWV0LiBDbGljayBcIkFkZCBOZXcgSGFiaXRcIiB0byBnZXQgc3RhcnRlZCEnLFxuICAgICAgICAgIGNsczogJ25vLWhhYml0cy1tZXNzYWdlJ1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnNlbGVjdGVkSGFiaXQpIHtcbiAgICAgIGlmICh0aGlzLnZpZXdUeXBlID09PSAneWVhcicpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJZZWFyVmlldyhjb250YWluZXIsIHRoaXMuc2VsZWN0ZWRIYWJpdCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudmlld1R5cGUgPT09ICdtb250aCcpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJNb250aFZpZXcoY29udGFpbmVyLCB0aGlzLnNlbGVjdGVkSGFiaXQpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnZpZXdUeXBlID09PSAneWVhci1vdmVydmlldycpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJZZWFyT3ZlcnZpZXcoY29udGFpbmVyLCB0aGlzLnNlbGVjdGVkSGFiaXQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyQ29udHJvbHMoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IGNvbnRyb2xzU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1jb250cm9scycgfSk7XG5cbiAgICBjb25zdCBhZGRCdXR0b24gPSBjb250cm9sc1NlY3Rpb24uY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgIHRleHQ6ICdBZGQnLFxuICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgfSk7XG4gICAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgbmV3IEFkZEhhYml0TW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9KS5vcGVuKCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBoYWJpdHMgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuZ2V0SGFiaXRzKCk7XG5cbiAgICBpZiAoaGFiaXRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHNlbGVjdG9yQ29udGFpbmVyID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXNlbGVjdG9yLWNvbnRhaW5lcicgfSk7XG5cblxuICAgICAgY29uc3QgY3VzdG9tRHJvcGRvd24gPSBzZWxlY3RvckNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjdXN0b20taGFiaXQtZHJvcGRvd24nIH0pO1xuXG4gICAgICBjb25zdCBkcm9wZG93bkJ1dHRvbiA9IGN1c3RvbURyb3Bkb3duLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ2hhYml0LWRyb3Bkb3duLWJ1dHRvbicgfSk7XG4gICAgICBkcm9wZG93bkJ1dHRvbi5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogdGhpcy5zZWxlY3RlZEhhYml0IHx8ICdTZWxlY3QgSGFiaXQnLCBjbHM6ICdoYWJpdC1kcm9wZG93bi10ZXh0JyB9KTtcbiAgICAgIGRyb3Bkb3duQnV0dG9uLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnXHUyNUJDJywgY2xzOiAnaGFiaXQtZHJvcGRvd24tYXJyb3cnIH0pO1xuXG4gICAgICBjb25zdCBkcm9wZG93bk1lbnUgPSBjdXN0b21Ecm9wZG93bi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1kcm9wZG93bi1tZW51JyB9KTtcblxuICAgICAgaGFiaXRzLmZvckVhY2goaGFiaXQgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gZHJvcGRvd25NZW51LmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LWRyb3Bkb3duLWl0ZW0nIH0pO1xuXG4gICAgICAgIGlmIChoYWJpdCA9PT0gdGhpcy5zZWxlY3RlZEhhYml0KSB7XG4gICAgICAgICAgaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBoYWJpdFRleHQgPSBpdGVtLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBoYWJpdCwgY2xzOiAnaGFiaXQtaXRlbS10ZXh0JyB9KTtcbiAgICAgICAgaGFiaXRUZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IGhhYml0O1xuICAgICAgICAgIGRyb3Bkb3duTWVudS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGRyb3Bkb3duQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgY29uc3QgaXNTaG93biA9IGRyb3Bkb3duTWVudS5oYXNDbGFzcygnc2hvdycpO1xuICAgICAgICBpZiAoaXNTaG93bikge1xuICAgICAgICAgIGRyb3Bkb3duTWVudS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRyb3Bkb3duTWVudS5hZGRDbGFzcygnc2hvdycpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICBpZiAoIWN1c3RvbURyb3Bkb3duLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgICAgICAgZHJvcGRvd25NZW51LnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygnUmVuZGVyaW5nIEVkaXQgQnV0dG9uLiBzZWxlY3RlZEhhYml0OicsIHRoaXMuc2VsZWN0ZWRIYWJpdCwgJ1R5cGU6JywgdHlwZW9mIHRoaXMuc2VsZWN0ZWRIYWJpdCk7XG4gICAgICBjb25zdCBlZGl0QnV0dG9uID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgIHRleHQ6ICdFZGl0JyxcbiAgICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgICB9KTtcbiAgICAgIGVkaXRCdXR0b24uZGlzYWJsZWQgPSAhdGhpcy5zZWxlY3RlZEhhYml0O1xuICAgICAgZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRIYWJpdCkge1xuICAgICAgICAgIG5ldyBFZGl0SGFiaXRNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuc2VsZWN0ZWRIYWJpdCwgYXN5bmMgKG5ld05hbWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRIYWJpdCA9IG5ld05hbWU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgIH0pLm9wZW4oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNvbnRyb2xzU2VjdGlvbi5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgICB0ZXh0OiAnRGVsZXRlJyxcbiAgICAgICAgY2xzOiAnaGFiaXQtY29udHJvbC1idXR0b24nXG4gICAgICB9KTtcbiAgICAgIGRlbGV0ZUJ1dHRvbi5kaXNhYmxlZCA9ICF0aGlzLnNlbGVjdGVkSGFiaXQ7XG4gICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSGFiaXQpIHtcbiAgICAgICAgICBuZXcgRGVsZXRlSGFiaXRNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuc2VsZWN0ZWRIYWJpdCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEhhYml0ID0gbnVsbDtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgfSkub3BlbigpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0NvbnRyb2xzQ29udGFpbmVyID0gY29udHJvbHNTZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3ZpZXctY29udHJvbHMtY29udGFpbmVyJyB9KTtcblxuXG4gICAgICBjb25zdCByYWRpb0dyb3VwID0gdmlld0NvbnRyb2xzQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3ZpZXctcmFkaW8tZ3JvdXAnIH0pO1xuXG4gICAgICBjb25zdCB2aWV3T3B0aW9ucyA9IFtcbiAgICAgICAgeyB2YWx1ZTogJ3llYXInLCB0ZXh0OiAnWWVhcicsIHRpdGxlOiAnR2l0SHViLXN0eWxlIGNvbnRyaWJ1dGlvbiBncmlkJyB9LFxuICAgICAgICB7IHZhbHVlOiAnbW9udGgnLCB0ZXh0OiAnTW9udGgnLCB0aXRsZTogJ1RyYWRpdGlvbmFsIG1vbnRobHkgY2FsZW5kYXInIH0sXG4gICAgICAgIHsgdmFsdWU6ICd5ZWFyLW92ZXJ2aWV3JywgdGV4dDogJ1llYXIgT3ZlcnZpZXcnLCB0aXRsZTogJ0FsbCAxMiBtb250aHMgYXQgYSBnbGFuY2UnIH1cbiAgICAgIF07XG5cbiAgICAgIHZpZXdPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgY29uc3QgcmFkaW9MYWJlbCA9IHJhZGlvR3JvdXAuY3JlYXRlRWwoJ2xhYmVsJywgeyBjbHM6ICd2aWV3LXJhZGlvLWxhYmVsJyB9KTtcblxuICAgICAgICBjb25zdCByYWRpb0lucHV0ID0gcmFkaW9MYWJlbC5jcmVhdGVFbCgnaW5wdXQnLCB7XG4gICAgICAgICAgdHlwZTogJ3JhZGlvJyxcbiAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICBuYW1lOiAndmlldy10eXBlJyxcbiAgICAgICAgICAgIHZhbHVlOiBvcHRpb24udmFsdWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNsczogJ3ZpZXctcmFkaW8taW5wdXQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChvcHRpb24udmFsdWUgPT09IHRoaXMudmlld1R5cGUpIHtcbiAgICAgICAgICByYWRpb0lucHV0LmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmFkaW9JbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgaWYgKHJhZGlvSW5wdXQuY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy52aWV3VHlwZSA9IG9wdGlvbi52YWx1ZSBhcyBWaWV3VHlwZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByYWRpb0xhYmVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBvcHRpb24udGV4dCwgY2xzOiAndmlldy1yYWRpby10ZXh0JyB9KTtcbiAgICAgICAgcmFkaW9MYWJlbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgb3B0aW9uLnRpdGxlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ21vbnRoJykge1xuICAgICAgICBjb25zdCBtb250aE5hdiA9IHZpZXdDb250cm9sc0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdtb250aC1uYXZpZ2F0aW9uJyB9KTtcblxuICAgICAgICBjb25zdCBwcmV2QnV0dG9uID0gbW9udGhOYXYuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICB0ZXh0OiAnXHUyNUMwJyxcbiAgICAgICAgICBjbHM6ICdtb250aC1uYXYtYnV0dG9uJ1xuICAgICAgICB9KTtcbiAgICAgICAgcHJldkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9udGguc2V0TW9udGgodGhpcy5zZWxlY3RlZE1vbnRoLmdldE1vbnRoKCkgLSAxKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBtb250aExhYmVsID0gbW9udGhOYXYuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgdGV4dDogdGhpcy5zZWxlY3RlZE1vbnRoLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tVVMnLCB7IG1vbnRoOiAnbG9uZycsIHllYXI6ICdudW1lcmljJyB9KSxcbiAgICAgICAgICBjbHM6ICdtb250aC1sYWJlbC10ZXh0J1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBuZXh0QnV0dG9uID0gbW9udGhOYXYuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICB0ZXh0OiAnXHUyNUI2JyxcbiAgICAgICAgICBjbHM6ICdtb250aC1uYXYtYnV0dG9uJ1xuICAgICAgICB9KTtcbiAgICAgICAgbmV4dEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9udGguc2V0TW9udGgodGhpcy5zZWxlY3RlZE1vbnRoLmdldE1vbnRoKCkgKyAxKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0b2RheUJ1dHRvbiA9IG1vbnRoTmF2LmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgICAgdGV4dDogJ1RvZGF5JyxcbiAgICAgICAgICBjbHM6ICdtb250aC1uYXYtYnV0dG9uIHRvZGF5LWJ1dHRvbidcbiAgICAgICAgfSk7XG4gICAgICAgIHRvZGF5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNb250aCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgdGhpcy5zZWxlY3RlZE1vbnRoLnNldERhdGUoMSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJZZWFyVmlldyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBoYWJpdE5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnaGFiaXQtc2VjdGlvbiBnaXRodWItc3R5bGUnIH0pO1xuXG4gICAgY29uc3QgaGVhZGVyID0gc2VjdGlvbi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdnaXRodWItaGVhZGVyJyB9KTtcbiAgICBoZWFkZXIuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogaGFiaXROYW1lLCBjbHM6ICdoYWJpdC1uYW1lJyB9KTtcblxuICAgIGNvbnN0IHllYXJDb250YWluZXIgPSBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi15ZWFyLWNvbnRhaW5lcicgfSk7XG5cbiAgICBjb25zdCBncmFwaENvbnRhaW5lciA9IHllYXJDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLWdyYXBoLWNvbnRhaW5lcicgfSk7XG5cbiAgICBjb25zdCBtb250aExhYmVscyA9IGdyYXBoQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1tb250aC1sYWJlbHMnIH0pO1xuICAgIG1vbnRoTGFiZWxzLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1kYXlzLWxhYmVsLXNwYWNlcicgfSk7XG5cbiAgICBjb25zdCBtb250aExhYmVsQ29udGFpbmVyID0gbW9udGhMYWJlbHMuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLW1vbnRoLWxhYmVsLWNvbnRhaW5lcicgfSk7XG5cbiAgICBjb25zdCBncmlkV3JhcHBlciA9IGdyYXBoQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1ncmlkLXdyYXBwZXInIH0pO1xuXG4gICAgY29uc3QgZGF5TGFiZWxzID0gZ3JpZFdyYXBwZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLWRheS1sYWJlbHMnIH0pO1xuICAgIFsnTW9uJywgJ1dlZCcsICdGcmknXS5mb3JFYWNoKChkYXksIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBsYWJlbCA9IGRheUxhYmVscy5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdnaXRodWItZGF5LWxhYmVsJyB9KTtcbiAgICAgIGxhYmVsLnN0eWxlLmdyaWRSb3cgPSBgJHtpbmRleCAqIDIgKyAyfWA7XG4gICAgICBsYWJlbC50ZXh0Q29udGVudCA9IGRheTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGdyaWQgPSBncmlkV3JhcHBlci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdnaXRodWItY29udHJpYnV0aW9uLWdyaWQnIH0pO1xuXG4gICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUodGhpcy5zZWxlY3RlZFllYXIsIDAsIDEpO1xuICAgIGNvbnN0IHN0YXJ0RGF5ID0gc3RhcnREYXRlLmdldERheSgpO1xuICAgIGNvbnN0IGRheXNUb1N1YnRyYWN0ID0gc3RhcnREYXkgPT09IDAgPyA2IDogc3RhcnREYXkgLSAxO1xuICAgIHN0YXJ0RGF0ZS5zZXREYXRlKHN0YXJ0RGF0ZS5nZXREYXRlKCkgLSBkYXlzVG9TdWJ0cmFjdCk7XG5cbiAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUodGhpcy5zZWxlY3RlZFllYXIsIDExLCAzMSk7XG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgIHRvZGF5LnNldEhvdXJzKDAsIDAsIDAsIDApO1xuXG4gICAgbGV0IGN1cnJlbnRNb250aExhYmVsID0gLTE7XG4gICAgbGV0IHdlZWtJbmRleCA9IDA7XG5cbiAgICBjb25zdCB0b3RhbERheXMgPSBNYXRoLmNlaWwoKGVuZERhdGUuZ2V0VGltZSgpIC0gc3RhcnREYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpICsgMTtcbiAgICBjb25zdCB0b3RhbFdlZWtzID0gTWF0aC5jZWlsKHRvdGFsRGF5cyAvIDcpO1xuXG4gICAgZm9yIChsZXQgd2VlayA9IDA7IHdlZWsgPCB0b3RhbFdlZWtzOyB3ZWVrKyspIHtcbiAgICAgIGZvciAobGV0IGRheSA9IDA7IGRheSA8IDc7IGRheSsrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlKTtcbiAgICAgICAgY3VycmVudERhdGUuc2V0RGF0ZShzdGFydERhdGUuZ2V0RGF0ZSgpICsgKHdlZWsgKiA3KSArIGRheSk7XG4gICAgICAgIGNvbnN0IGRhdGVTdHIgPSB0aGlzLmZvcm1hdERhdGUoY3VycmVudERhdGUpO1xuXG4gICAgICAgIGNvbnN0IGNlbGwgPSBncmlkLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2dpdGh1Yi1jZWxsJyB9KTtcbiAgICAgICAgY2VsbC5zdHlsZS5ncmlkQ29sdW1uID0gYCR7d2VlayArIDF9YDtcbiAgICAgICAgY2VsbC5zdHlsZS5ncmlkUm93ID0gYCR7ZGF5ICsgMX1gO1xuXG4gICAgICAgIGlmIChjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpICE9PSB0aGlzLnNlbGVjdGVkWWVhcikge1xuICAgICAgICAgIGNlbGwuYWRkQ2xhc3MoJ291dHNpZGUteWVhcicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGlzQ29tcGxldGVkID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmlzSGFiaXRDb21wbGV0ZWQoaGFiaXROYW1lLCBkYXRlU3RyKTtcbiAgICAgICAgICBpZiAoaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgIGNlbGwuYWRkQ2xhc3MoJ2NvbXBsZXRlZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmlzU2FtZURheShjdXJyZW50RGF0ZSwgdG9kYXkpKSB7XG4gICAgICAgICAgICBjZWxsLmFkZENsYXNzKCd0b2RheScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWRhdGUnLCBkYXRlU3RyKTtcbiAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBgJHtoYWJpdE5hbWV9IC0gJHtkYXRlU3RyfWApO1xuXG4gICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1N0YXRlID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLnRvZ2dsZUhhYml0KGhhYml0TmFtZSwgZGF0ZVN0cik7XG4gICAgICAgICAgICBpZiAobmV3U3RhdGUpIHtcbiAgICAgICAgICAgICAgY2VsbC5hZGRDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjZWxsLnJlbW92ZUNsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXkgPT09IDAgJiYgY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSA9PT0gdGhpcy5zZWxlY3RlZFllYXIpIHtcbiAgICAgICAgICBjb25zdCBtb250aCA9IGN1cnJlbnREYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgaWYgKG1vbnRoICE9PSBjdXJyZW50TW9udGhMYWJlbCAmJiB3ZWVrID4gMCkge1xuICAgICAgICAgICAgY29uc3QgbW9udGhMYWJlbCA9IG1vbnRoTGFiZWxDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLW1vbnRoLWxhYmVsJyB9KTtcbiAgICAgICAgICAgIG1vbnRoTGFiZWwudGV4dENvbnRlbnQgPSBjdXJyZW50RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywgeyBtb250aDogJ3Nob3J0JyB9KTtcbiAgICAgICAgICAgIG1vbnRoTGFiZWwuc3R5bGUuZ3JpZENvbHVtbiA9IGAke3dlZWsgKyAxfWA7XG4gICAgICAgICAgICBjdXJyZW50TW9udGhMYWJlbCA9IG1vbnRoO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHllYXJTZWxlY3RvciA9IHllYXJDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZ2l0aHViLXllYXItc2VsZWN0b3InIH0pO1xuICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IGVhcmxpZXN0WWVhciA9IHRoaXMuZ2V0RWFybGllc3RZZWFyV2l0aERhdGEoaGFiaXROYW1lKTtcbiAgICBjb25zdCBzdGFydFllYXIgPSBNYXRoLm1pbihlYXJsaWVzdFllYXIsIGN1cnJlbnRZZWFyKTtcblxuICAgIGZvciAobGV0IHllYXIgPSBzdGFydFllYXI7IHllYXIgPD0gY3VycmVudFllYXI7IHllYXIrKykge1xuICAgICAgY29uc3QgeWVhckJ1dHRvbiA9IHllYXJTZWxlY3Rvci5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgICB0ZXh0OiB5ZWFyLnRvU3RyaW5nKCksXG4gICAgICAgIGNsczogJ2dpdGh1Yi15ZWFyLWJ1dHRvbidcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoeWVhciA9PT0gdGhpcy5zZWxlY3RlZFllYXIpIHtcbiAgICAgICAgeWVhckJ1dHRvbi5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh5ZWFyID09PSBjdXJyZW50WWVhcikge1xuICAgICAgICB5ZWFyQnV0dG9uLmFkZENsYXNzKCdjdXJyZW50LXllYXInKTtcbiAgICAgIH1cblxuICAgICAgeWVhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFllYXIgPSB5ZWFyO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb250aFZpZXcoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaGFiaXROYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2hhYml0LXNlY3Rpb24gY2FsZW5kYXItdmlldycgfSk7XG5cbiAgICBzZWN0aW9uLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGhhYml0TmFtZSwgY2xzOiAnaGFiaXQtbmFtZScgfSk7XG5cbiAgICBjb25zdCBjYWxlbmRhciA9IHNlY3Rpb24uY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnY2FsZW5kYXItbW9udGgnIH0pO1xuXG4gICAgY29uc3Qgd2Vla0RheXMgPSBbJ1N1bicsICdNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCddO1xuICAgIGNvbnN0IHdlZWtEYXlIZWFkZXIgPSBjYWxlbmRhci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYWxlbmRhci13ZWVrZGF5cycgfSk7XG4gICAgd2Vla0RheXMuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgd2Vla0RheUhlYWRlci5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBkYXksIGNsczogJ2NhbGVuZGFyLXdlZWtkYXknIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZGF5c0dyaWQgPSBjYWxlbmRhci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYWxlbmRhci1kYXlzLWdyaWQnIH0pO1xuXG4gICAgY29uc3QgeWVhciA9IHRoaXMuc2VsZWN0ZWRNb250aC5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IG1vbnRoID0gdGhpcy5zZWxlY3RlZE1vbnRoLmdldE1vbnRoKCk7XG4gICAgY29uc3QgZmlyc3REYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMSk7XG4gICAgY29uc3QgbGFzdERheSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoICsgMSwgMCk7XG4gICAgY29uc3Qgc3RhcnRpbmdEYXlPZldlZWsgPSBmaXJzdERheS5nZXREYXkoKTtcblxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhcnRpbmdEYXlPZldlZWs7IGkrKykge1xuICAgICAgZGF5c0dyaWQuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnY2FsZW5kYXItZGF5IGVtcHR5JyB9KTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBkYXkgPSAxOyBkYXkgPD0gbGFzdERheS5nZXREYXRlKCk7IGRheSsrKSB7XG4gICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xuICAgICAgY29uc3QgZGF0ZVN0ciA9IHRoaXMuZm9ybWF0RGF0ZShjdXJyZW50RGF0ZSk7XG5cbiAgICAgIGNvbnN0IGRheUNlbGwgPSBkYXlzR3JpZC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYWxlbmRhci1kYXknIH0pO1xuICAgICAgZGF5Q2VsbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBkYXkudG9TdHJpbmcoKSwgY2xzOiAnY2FsZW5kYXItZGF5LW51bWJlcicgfSk7XG5cbiAgICAgIGNvbnN0IGlzQ29tcGxldGVkID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLmlzSGFiaXRDb21wbGV0ZWQoaGFiaXROYW1lLCBkYXRlU3RyKTtcbiAgICAgIGlmIChpc0NvbXBsZXRlZCkge1xuICAgICAgICBkYXlDZWxsLmFkZENsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuaXNTYW1lRGF5KGN1cnJlbnREYXRlLCB0b2RheSkpIHtcbiAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygndG9kYXknKTtcbiAgICAgIH1cblxuICAgICAgZGF5Q2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGF0ZScsIGRhdGVTdHIpO1xuICAgICAgZGF5Q2VsbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgYCR7aGFiaXROYW1lfSAtICR7ZGF0ZVN0cn1gKTtcblxuICAgICAgZGF5Q2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgbmV3U3RhdGUgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUudG9nZ2xlSGFiaXQoaGFiaXROYW1lLCBkYXRlU3RyKTtcbiAgICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF5Q2VsbC5yZW1vdmVDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyWWVhck92ZXJ2aWV3KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGhhYml0TmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3Qgc2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdoYWJpdC1zZWN0aW9uIHllYXItb3ZlcnZpZXcnIH0pO1xuXG4gICAgY29uc3QgaGVhZGVyID0gc2VjdGlvbi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd5ZWFyLW92ZXJ2aWV3LWhlYWRlcicgfSk7XG4gICAgaGVhZGVyLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGhhYml0TmFtZSwgY2xzOiAnaGFiaXQtbmFtZScgfSk7XG5cbiAgICBjb25zdCB5ZWFyQ29udGFpbmVyID0gc2VjdGlvbi5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd5ZWFyLW92ZXJ2aWV3LWNvbnRhaW5lcicgfSk7XG5cbiAgICBjb25zdCB5ZWFyR3JpZCA9IHllYXJDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAneWVhci1vdmVydmlldy1ncmlkJyB9KTtcblxuICAgIGNvbnN0IG1vbnRoTmFtZXMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcblxuICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IGN1cnJlbnRNb250aCA9IG5ldyBEYXRlKCkuZ2V0TW9udGgoKTtcbiAgICBjb25zdCBpc0N1cnJlbnRZZWFyID0gdGhpcy5zZWxlY3RlZFllYXIgPT09IGN1cnJlbnRZZWFyO1xuICAgIGNvbnN0IGxhc3RNb250aCA9IGlzQ3VycmVudFllYXIgPyBjdXJyZW50TW9udGggOiAxMTtcblxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICBjb25zdCB0b2RheURhdGUgPSB0b2RheS5nZXREYXRlKCk7XG5cbiAgICBmb3IgKGxldCBtb250aCA9IDA7IG1vbnRoIDw9IGxhc3RNb250aDsgbW9udGgrKykge1xuICAgICAgY29uc3QgbW9udGhDb250YWluZXIgPSB5ZWFyR3JpZC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd5ZWFyLW92ZXJ2aWV3LW1vbnRoJyB9KTtcblxuICAgICAgbW9udGhDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogbW9udGhOYW1lc1ttb250aF0sIGNsczogJ3llYXItb3ZlcnZpZXctbW9udGgtbmFtZScgfSk7XG5cbiAgICAgIGNvbnN0IG1vbnRoRGF5cyA9IG1vbnRoQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctZGF5cycgfSk7XG5cbiAgICAgIGNvbnN0IGRheXNJbk1vbnRoID0gbmV3IERhdGUodGhpcy5zZWxlY3RlZFllYXIsIG1vbnRoICsgMSwgMCkuZ2V0RGF0ZSgpO1xuICAgICAgY29uc3QgaXNDdXJyZW50TW9udGggPSBpc0N1cnJlbnRZZWFyICYmIG1vbnRoID09PSBjdXJyZW50TW9udGg7XG4gICAgICBjb25zdCBsYXN0RGF5ID0gaXNDdXJyZW50TW9udGggPyB0b2RheURhdGUgOiBkYXlzSW5Nb250aDtcblxuICAgICAgZm9yIChsZXQgZGF5ID0gMTsgZGF5IDw9IGxhc3REYXk7IGRheSsrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUodGhpcy5zZWxlY3RlZFllYXIsIG1vbnRoLCBkYXkpO1xuICAgICAgICBjb25zdCBkYXRlU3RyID0gdGhpcy5mb3JtYXREYXRlKGN1cnJlbnREYXRlKTtcblxuICAgICAgICBjb25zdCBkYXlDZWxsID0gbW9udGhEYXlzLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXctZGF5JyB9KTtcbiAgICAgICAgZGF5Q2VsbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogZGF5LnRvU3RyaW5nKCksIGNsczogJ3llYXItb3ZlcnZpZXctZGF5LW51bWJlcicgfSk7XG5cbiAgICAgICAgY29uc3QgaXNDb21wbGV0ZWQgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuaXNIYWJpdENvbXBsZXRlZChoYWJpdE5hbWUsIGRhdGVTdHIpO1xuICAgICAgICBpZiAoaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICBkYXlDZWxsLmFkZENsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzU2FtZURheShjdXJyZW50RGF0ZSwgdG9kYXkpKSB7XG4gICAgICAgICAgZGF5Q2VsbC5hZGRDbGFzcygndG9kYXknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRheUNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWRhdGUnLCBkYXRlU3RyKTtcbiAgICAgICAgZGF5Q2VsbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgYCR7aGFiaXROYW1lfSAtICR7ZGF0ZVN0cn1gKTtcblxuICAgICAgICBkYXlDZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld1N0YXRlID0gdGhpcy5wbHVnaW4uZGF0YVN0b3JlLnRvZ2dsZUhhYml0KGhhYml0TmFtZSwgZGF0ZVN0cik7XG4gICAgICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICAgICBkYXlDZWxsLmFkZENsYXNzKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGF5Q2VsbC5yZW1vdmVDbGFzcygnY29tcGxldGVkJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB5ZWFyU2VsZWN0b3IgPSB5ZWFyQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3llYXItb3ZlcnZpZXcteWVhci1zZWxlY3RvcicgfSk7XG4gICAgY29uc3QgZWFybGllc3RZZWFyID0gdGhpcy5nZXRFYXJsaWVzdFllYXJXaXRoRGF0YShoYWJpdE5hbWUpO1xuICAgIGNvbnN0IHN0YXJ0WWVhciA9IE1hdGgubWluKGVhcmxpZXN0WWVhciwgY3VycmVudFllYXIpO1xuXG4gICAgZm9yIChsZXQgeWVhciA9IHN0YXJ0WWVhcjsgeWVhciA8PSBjdXJyZW50WWVhcjsgeWVhcisrKSB7XG4gICAgICBjb25zdCB5ZWFyQnV0dG9uID0geWVhclNlbGVjdG9yLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgIHRleHQ6IHllYXIudG9TdHJpbmcoKSxcbiAgICAgICAgY2xzOiAneWVhci1vdmVydmlldy15ZWFyLWJ1dHRvbidcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoeWVhciA9PT0gdGhpcy5zZWxlY3RlZFllYXIpIHtcbiAgICAgICAgeWVhckJ1dHRvbi5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh5ZWFyID09PSBjdXJyZW50WWVhcikge1xuICAgICAgICB5ZWFyQnV0dG9uLmFkZENsYXNzKCdjdXJyZW50LXllYXInKTtcbiAgICAgIH1cblxuICAgICAgeWVhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFllYXIgPSB5ZWFyO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXREYXRlKGRhdGU6IERhdGUpOiBzdHJpbmcge1xuICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgfVxuXG4gIHByaXZhdGUgaXNTYW1lRGF5KGRhdGUxOiBEYXRlLCBkYXRlMjogRGF0ZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBkYXRlMS5nZXRGdWxsWWVhcigpID09PSBkYXRlMi5nZXRGdWxsWWVhcigpICYmXG4gICAgICAgICAgIGRhdGUxLmdldE1vbnRoKCkgPT09IGRhdGUyLmdldE1vbnRoKCkgJiZcbiAgICAgICAgICAgZGF0ZTEuZ2V0RGF0ZSgpID09PSBkYXRlMi5nZXREYXRlKCk7XG4gIH1cblxuICBwcml2YXRlIGdldEVhcmxpZXN0WWVhcldpdGhEYXRhKGhhYml0TmFtZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBjdXJyZW50WWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTtcbiAgICBjb25zdCBoYWJpdERhdGEgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuZ2V0RGF0YSgpW2hhYml0TmFtZV07XG5cbiAgICBpZiAoIWhhYml0RGF0YSB8fCB0eXBlb2YgaGFiaXREYXRhICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KGhhYml0RGF0YSkpIHtcbiAgICAgIHJldHVybiBjdXJyZW50WWVhcjtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRlcyA9IE9iamVjdC5rZXlzKGhhYml0RGF0YSBhcyB7IFtkYXRlOiBzdHJpbmddOiBib29sZWFuIH0pO1xuICAgIGlmIChkYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBjdXJyZW50WWVhcjtcbiAgICB9XG5cbiAgICBsZXQgZWFybGllc3RZZWFyID0gY3VycmVudFllYXI7XG4gICAgZGF0ZXMuZm9yRWFjaChkYXRlU3RyID0+IHtcbiAgICAgIGNvbnN0IHllYXIgPSBwYXJzZUludChkYXRlU3RyLnNwbGl0KCctJylbMF0pO1xuICAgICAgaWYgKHllYXIgPCBlYXJsaWVzdFllYXIpIHtcbiAgICAgICAgZWFybGllc3RZZWFyID0geWVhcjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBlYXJsaWVzdFllYXI7XG4gIH1cblxuICBhc3luYyBvbkNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIENsZWFudXAgaWYgbmVlZGVkXG4gIH1cbn1cblxuY2xhc3MgQWRkSGFiaXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW47XG4gIG9uU3VibWl0OiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogYW55LCBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbiwgb25TdWJtaXQ6ICgpID0+IFByb21pc2U8dm9pZD4pIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdBZGQnIH0pO1xuXG4gICAgbGV0IGhhYml0TmFtZSA9ICcnO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoJ0hhYml0IE5hbWUnKVxuICAgICAgLnNldERlc2MoJ0VudGVyIHRoZSBuYW1lIG9mIHlvdXIgbmV3IGhhYml0JylcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICB0ZXh0LnNldFBsYWNlaG9sZGVyKCdlLmcuLCBFeGVyY2lzZSwgUmVhZCwgTWVkaXRhdGUnKVxuICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBoYWJpdE5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgdGV4dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0KGhhYml0TmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0ZXh0LmlucHV0RWwuZm9jdXMoKSwgMTApO1xuICAgICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FkZCcpXG4gICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zdWJtaXQoaGFiaXROYW1lKTtcbiAgICAgICAgfSkpXG4gICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgLnNldEJ1dHRvblRleHQoJ0NhbmNlbCcpXG4gICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pKTtcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdChoYWJpdE5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghaGFiaXROYW1lLnRyaW0oKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN1Y2Nlc3MgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUuYWRkSGFiaXQoaGFiaXROYW1lKTtcbiAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgYXdhaXQgdGhpcy5vblN1Ym1pdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBlcnJvckVsID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgdGV4dDogJ1RoaXMgaGFiaXQgYWxyZWFkeSBleGlzdHMgb3IgdGhlIG5hbWUgaXMgaW52YWxpZCEnLFxuICAgICAgICBjbHM6ICdoYWJpdC1lcnJvci1tZXNzYWdlJ1xuICAgICAgfSk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IGVycm9yRWwucmVtb3ZlKCksIDMwMDApO1xuICAgIH1cbiAgfVxuXG4gIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG4gIH1cbn1cblxuY2xhc3MgRWRpdEhhYml0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luO1xuICBvbGROYW1lOiBzdHJpbmc7XG4gIG9uU3VibWl0OiAobmV3TmFtZTogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogYW55LCBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbiwgb2xkTmFtZTogc3RyaW5nLCBvblN1Ym1pdDogKG5ld05hbWU6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPikge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5vbGROYW1lID0gb2xkTmFtZTtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gIH1cblxuICBvbk9wZW4oKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnRWRpdCBIYWJpdCcgfSk7XG5cbiAgICBsZXQgaGFiaXROYW1lID0gdGhpcy5vbGROYW1lO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoJ0hhYml0IE5hbWUnKVxuICAgICAgLnNldERlc2MoJ0VudGVyIHRoZSBuZXcgbmFtZSBmb3IgeW91ciBoYWJpdCcpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgdGV4dC5zZXRWYWx1ZSh0aGlzLm9sZE5hbWUpXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdlLmcuLCBFeGVyY2lzZSwgUmVhZCwgTWVkaXRhdGUnKVxuICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBoYWJpdE5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgdGV4dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0KGhhYml0TmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGV4dC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgICAgdGV4dC5pbnB1dEVsLnNlbGVjdCgpO1xuICAgICAgICB9LCAxMCk7XG4gICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnU2F2ZScpXG4gICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zdWJtaXQoaGFiaXROYW1lKTtcbiAgICAgICAgfSkpXG4gICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgLnNldEJ1dHRvblRleHQoJ0NhbmNlbCcpXG4gICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pKTtcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdChoYWJpdE5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghaGFiaXROYW1lLnRyaW0oKSB8fCBoYWJpdE5hbWUgPT09IHRoaXMub2xkTmFtZSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN1Y2Nlc3MgPSB0aGlzLnBsdWdpbi5kYXRhU3RvcmUucmVuYW1lSGFiaXQodGhpcy5vbGROYW1lLCBoYWJpdE5hbWUpO1xuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICBhd2FpdCB0aGlzLm9uU3VibWl0KGhhYml0TmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICB0ZXh0OiAnVGhpcyBoYWJpdCBuYW1lIGFscmVhZHkgZXhpc3RzIG9yIGlzIGludmFsaWQhJyxcbiAgICAgICAgY2xzOiAnaGFiaXQtZXJyb3ItbWVzc2FnZSdcbiAgICAgIH0pO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiBlcnJvckVsLnJlbW92ZSgpLCAzMDAwKTtcbiAgICB9XG4gIH1cblxuICBvbkNsb3NlKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG5cbmNsYXNzIERlbGV0ZUhhYml0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luO1xuICBoYWJpdE5hbWU6IHN0cmluZztcbiAgb25TdWJtaXQ6ICgpID0+IFByb21pc2U8dm9pZD47XG5cbiAgY29uc3RydWN0b3IoYXBwOiBhbnksIHBsdWdpbjogSGFiaXRUcmFja2VyUGx1Z2luLCBoYWJpdE5hbWU6IHN0cmluZywgb25TdWJtaXQ6ICgpID0+IFByb21pc2U8dm9pZD4pIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIHRoaXMuaGFiaXROYW1lID0gaGFiaXROYW1lO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdEZWxldGUgSGFiaXQnIH0pO1xuXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywge1xuICAgICAgdGV4dDogYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgXCIke3RoaXMuaGFiaXROYW1lfVwiPyBUaGlzIHdpbGwgcmVtb3ZlIGFsbCBwcm9ncmVzcyBkYXRhIGZvciB0aGlzIGhhYml0LmBcbiAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnRGVsZXRlJylcbiAgICAgICAgLnNldFdhcm5pbmcoKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YVN0b3JlLnJlbW92ZUhhYml0KHRoaXMuaGFiaXROYW1lKTtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5vblN1Ym1pdCgpO1xuICAgICAgICB9KSlcbiAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2FuY2VsJylcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSkpO1xuICB9XG5cbiAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB0eXBlIEhhYml0VHJhY2tlclBsdWdpbiBmcm9tICcuL21haW4nO1xuXG5leHBvcnQgY2xhc3MgSGFiaXRUcmFja2VyU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IEhhYml0VHJhY2tlclBsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBIYWJpdFRyYWNrZXJQbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0hhYml0IFRyYWNrZXIgU2V0dGluZ3MnIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSgnSGFiaXRzIEZpbGUgUGF0aCcpXG4gICAgICAuc2V0RGVzYygnUGF0aCB0byB0aGUgbWFya2Rvd24gZmlsZSBjb250YWluaW5nIHlvdXIgbGlzdCBvZiBoYWJpdHMgKGUuZy4sIGhhYml0cy5tZCknKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignaGFiaXRzLm1kJylcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhhYml0c0ZpbGVQYXRoKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFiaXRzRmlsZVBhdGggPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5yZWZyZXNoVmlldygpO1xuICAgICAgICB9KSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgSGFiaXRQYXJzZXIge1xuICBhcHA6IEFwcDtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgIHRoaXMuYXBwID0gYXBwO1xuICB9XG5cbiAgYXN5bmMgcGFyc2VIYWJpdHNGcm9tRmlsZShmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgY29uc29sZS5sb2coYEhhYml0cyBmaWxlIG5vdCBmb3VuZDogJHtmaWxlUGF0aH1gKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICBjb25zdCBoYWJpdHMgPSB0aGlzLmV4dHJhY3RIYWJpdHMoY29udGVudCk7XG4gICAgICByZXR1cm4gaGFiaXRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGhhYml0cyBmaWxlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RIYWJpdHMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhhYml0czogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICBjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xuXG4gICAgICAvLyBTdXBwb3J0IHZhcmlvdXMgbWFya2Rvd24gbGlzdCBmb3JtYXRzXG4gICAgICAvLyAtIFsgXSBIYWJpdCBuYW1lXG4gICAgICAvLyAtIEhhYml0IG5hbWVcbiAgICAgIC8vICogSGFiaXQgbmFtZVxuICAgICAgLy8gMS4gSGFiaXQgbmFtZVxuICAgICAgY29uc3QgY2hlY2tib3hNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eWy0qXVxccypcXFtbIHhdXFxdXFxzKiguKykkL2kpO1xuICAgICAgY29uc3QgbGlzdE1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL15bLSpdXFxzKyguKykkLyk7XG4gICAgICBjb25zdCBudW1iZXJlZE1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL15cXGQrXFwuXFxzKyguKykkLyk7XG5cbiAgICAgIGlmIChjaGVja2JveE1hdGNoKSB7XG4gICAgICAgIGhhYml0cy5wdXNoKGNoZWNrYm94TWF0Y2hbMV0udHJpbSgpKTtcbiAgICAgIH0gZWxzZSBpZiAobGlzdE1hdGNoKSB7XG4gICAgICAgIGhhYml0cy5wdXNoKGxpc3RNYXRjaFsxXS50cmltKCkpO1xuICAgICAgfSBlbHNlIGlmIChudW1iZXJlZE1hdGNoKSB7XG4gICAgICAgIGhhYml0cy5wdXNoKG51bWJlcmVkTWF0Y2hbMV0udHJpbSgpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaGFiaXRzO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgSGFiaXREYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBIYWJpdERhdGFTdG9yZSB7XG4gIHByaXZhdGUgZGF0YTogSGFiaXREYXRhID0ge307XG4gIHByaXZhdGUgc2F2ZUNhbGxiYWNrOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuXG4gIGNvbnN0cnVjdG9yKHNhdmVDYWxsYmFjazogKCkgPT4gUHJvbWlzZTx2b2lkPikge1xuICAgIHRoaXMuc2F2ZUNhbGxiYWNrID0gc2F2ZUNhbGxiYWNrO1xuICB9XG5cbiAgbG9hZERhdGEoZGF0YTogSGFiaXREYXRhKTogdm9pZCB7XG4gICAgdGhpcy5kYXRhID0gZGF0YSB8fCB7fTtcbiAgICBpZiAoIXRoaXMuZGF0YS5oYWJpdHMpIHtcbiAgICAgIHRoaXMuZGF0YS5oYWJpdHMgPSBbXTtcbiAgICB9XG4gIH1cblxuICBnZXREYXRhKCk6IEhhYml0RGF0YSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfVxuXG4gIGdldEhhYml0cygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5oYWJpdHMgfHwgW107XG4gIH1cblxuICBhZGRIYWJpdChoYWJpdE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHRyaW1tZWROYW1lID0gaGFiaXROYW1lLnRyaW0oKTtcbiAgICBpZiAoIXRyaW1tZWROYW1lKSByZXR1cm4gZmFsc2U7XG5cbiAgICBpZiAoIXRoaXMuZGF0YS5oYWJpdHMpIHtcbiAgICAgIHRoaXMuZGF0YS5oYWJpdHMgPSBbXTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmhhYml0cy5pbmNsdWRlcyh0cmltbWVkTmFtZSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmRhdGEuaGFiaXRzLnB1c2godHJpbW1lZE5hbWUpO1xuICAgIHRoaXMuZGF0YVt0cmltbWVkTmFtZV0gPSB7fTtcbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmVtb3ZlSGFiaXQoaGFiaXROYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5oYWJpdHMpIHJldHVybiBmYWxzZTtcblxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kYXRhLmhhYml0cy5pbmRleE9mKGhhYml0TmFtZSk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgdGhpcy5kYXRhLmhhYml0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGRlbGV0ZSB0aGlzLmRhdGFbaGFiaXROYW1lXTtcbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmVuYW1lSGFiaXQob2xkTmFtZTogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCB0cmltbWVkTmV3TmFtZSA9IG5ld05hbWUudHJpbSgpO1xuICAgIGlmICghdHJpbW1lZE5ld05hbWUgfHwgIXRoaXMuZGF0YS5oYWJpdHMpIHJldHVybiBmYWxzZTtcblxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kYXRhLmhhYml0cy5pbmRleE9mKG9sZE5hbWUpO1xuICAgIGlmIChpbmRleCA9PT0gLTEpIHJldHVybiBmYWxzZTtcblxuICAgIGlmICh0aGlzLmRhdGEuaGFiaXRzLmluY2x1ZGVzKHRyaW1tZWROZXdOYW1lKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YS5oYWJpdHNbaW5kZXhdID0gdHJpbW1lZE5ld05hbWU7XG5cbiAgICBpZiAodGhpcy5kYXRhW29sZE5hbWVdKSB7XG4gICAgICB0aGlzLmRhdGFbdHJpbW1lZE5ld05hbWVdID0gdGhpcy5kYXRhW29sZE5hbWVdO1xuICAgICAgZGVsZXRlIHRoaXMuZGF0YVtvbGROYW1lXTtcbiAgICB9XG5cbiAgICB0aGlzLnNhdmVDYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgdG9nZ2xlSGFiaXQoaGFiaXROYW1lOiBzdHJpbmcsIGRhdGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5kYXRhW2hhYml0TmFtZV0pIHtcbiAgICAgIHRoaXMuZGF0YVtoYWJpdE5hbWVdID0ge307XG4gICAgfVxuXG4gICAgY29uc3QgaGFiaXREYXRhID0gdGhpcy5kYXRhW2hhYml0TmFtZV0gYXMgeyBbZGF0ZTogc3RyaW5nXTogYm9vbGVhbiB9O1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGhhYml0RGF0YVtkYXRlXSB8fCBmYWxzZTtcbiAgICBoYWJpdERhdGFbZGF0ZV0gPSAhY3VycmVudFZhbHVlO1xuXG4gICAgdGhpcy5zYXZlQ2FsbGJhY2soKTtcblxuICAgIHJldHVybiBoYWJpdERhdGFbZGF0ZV07XG4gIH1cblxuICBpc0hhYml0Q29tcGxldGVkKGhhYml0TmFtZTogc3RyaW5nLCBkYXRlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBoYWJpdERhdGEgPSB0aGlzLmRhdGFbaGFiaXROYW1lXTtcbiAgICBpZiAodHlwZW9mIGhhYml0RGF0YSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkoaGFiaXREYXRhKSkge1xuICAgICAgcmV0dXJuIGhhYml0RGF0YVtkYXRlXSB8fCBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZ2V0SGFiaXRTdHJlYWsoaGFiaXROYW1lOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IGhhYml0RGF0YSA9IHRoaXMuZGF0YVtoYWJpdE5hbWVdO1xuICAgIGlmICghaGFiaXREYXRhIHx8IHR5cGVvZiBoYWJpdERhdGEgIT09ICdvYmplY3QnIHx8IEFycmF5LmlzQXJyYXkoaGFiaXREYXRhKSkgcmV0dXJuIDA7XG5cbiAgICBsZXQgc3RyZWFrID0gMDtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgdG9kYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM2NTsgaSsrKSB7XG4gICAgICBjb25zdCBjaGVja0RhdGUgPSBuZXcgRGF0ZSh0b2RheSk7XG4gICAgICBjaGVja0RhdGUuc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgLSBpKTtcbiAgICAgIGNvbnN0IGRhdGVTdHIgPSB0aGlzLmZvcm1hdERhdGUoY2hlY2tEYXRlKTtcblxuICAgICAgaWYgKChoYWJpdERhdGEgYXMgeyBbZGF0ZTogc3RyaW5nXTogYm9vbGVhbiB9KVtkYXRlU3RyXSkge1xuICAgICAgICBzdHJlYWsrKztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzdHJlYWs7XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdERhdGUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBIYWJpdFRyYWNrZXJTZXR0aW5ncyB7XG4gIGhhYml0c0ZpbGVQYXRoOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGFiaXREYXRhIHtcbiAgaGFiaXRzPzogc3RyaW5nW107XG4gIFtoYWJpdE5hbWU6IHN0cmluZ106IHtcbiAgICBbZGF0ZTogc3RyaW5nXTogYm9vbGVhbjtcbiAgfSB8IHN0cmluZ1tdIHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogSGFiaXRUcmFja2VyU2V0dGluZ3MgPSB7XG4gIGhhYml0c0ZpbGVQYXRoOiAnaGFiaXRzLm1kJ1xufTtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBdUI7OztBQ0F2QixzQkFBd0Q7QUFHakQsSUFBTSwwQkFBMEI7QUFJaEMsSUFBTSxtQkFBTixjQUErQix5QkFBUztBQUFBLEVBTzdDLFlBQVksTUFBcUIsUUFBNEI7QUFDM0QsVUFBTSxJQUFJO0FBTlosU0FBUSxnQkFBK0I7QUFDdkMsU0FBUSxXQUFxQjtBQUM3QixTQUFRLGdCQUFzQixvQkFBSSxLQUFLO0FBQ3ZDLFNBQVEsZ0JBQXVCLG9CQUFJLEtBQUssR0FBRSxZQUFZO0FBSXBELFNBQUssU0FBUztBQUNkLFNBQUssY0FBYyxRQUFRLENBQUM7QUFBQSxFQUM5QjtBQUFBLEVBRUEsY0FBc0I7QUFDcEIsV0FBTztBQUFBLEVBQ1Q7QUFBQSxFQUVBLGlCQUF5QjtBQUN2QixXQUFPO0FBQUEsRUFDVDtBQUFBLEVBRUEsVUFBa0I7QUFDaEIsV0FBTztBQUFBLEVBQ1Q7QUFBQSxFQUVBLE1BQU0sU0FBd0I7QUFDNUIsVUFBTSxLQUFLLE9BQU87QUFBQSxFQUNwQjtBQUFBLEVBRUEsTUFB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S0FBSyxVQUFVLFVBQVU7QUFDL0MsWUFBTSxnQkFBaUIsS0FBYTtBQUtwQyxVQUFJLENBQUMsaUJBQWlCLENBQUMsY0FBYyxTQUFTLGFBQWEsR0FBRztBQUM1RCxjQUFNLEtBQUssT0FBTztBQUFBLE1BQ3BCO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQU0sZUFBOEI7QUFDbEMsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUMzRTtBQUFBLEVBRUEsTUFBTSxlQUE4QjtBQUNsQyxVQUFNLE1BQU0sU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNwQztBQUFBLEVBRUEsTUFBTSxnQkFBK0I7QUFDbkMsVUFBTSxNQUFNLFNBQVMsS0FBSyxVQUFVLFFBQVEsQ0FBQztBQUFBLEVBQy9DO0FBQUEsRUFFQSxXQUFpQjtBQUFBLEVBRWpCO0FBQ0Y7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
